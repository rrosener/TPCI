<html>

<head>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

   <meta name="GENERATOR" content="Mozilla/4.77 [en] (X11; U; Linux 2.4.3-12 i686) [Netscape]">

   <title>Cloudy test suite</title>


</head>
<body><h4>  This HTML file was created by the program doc_tsuite.pl.  doc_tsuite.txt contains a tab delimited list of the files. </h4>
<hr><h2><kbd>agn_blr_albedo.in  </kbd><I>measure rayleigh scattering of Lya
</I></h2><kbd><br>title measure rayleigh scattering of Lya
<br>c model from Korista, K., & Ferland, G. 1998, ApJ, 495, 672
<br>c
<br>c commands controlling continuum =========
<br>agn 6.683 -1.20 -1.20 -0.90
<br>ionization parameter 1.0
<br>c
<br>c commands for density & abundances =========
<br>init file = "ism.ini"
<br>abundances old solar 84 
<br>hden 11.0
<br>c
<br>c commands controlling geometry  =========
<br>stop total column density = 23.75
<br>c
<br>c other commands for details     =========
<br>iterate 
<br>c
<br>c commands controlling output    =========
<br>normalize to "FeKa" 1.78
<br>print line faint -1
<br>print diffuse continua
<br>print lines inward
<br>punch continuum last "agn_blr_albedo.con" units kev
<br>punch dr "agn_blr_albedo.dr" 
<br>punch reflected continuum last "agn_blr_albedo.ref"
<br>punch emitted continuum last "agn_blr_albedo.emt"
<br>c
<br>c must assert the luminosity since change in this 
<br>c line would appear to change the rest of the spectrum
<br>c agn_blr_albedo.in
<br>c class blr 
<br>c ========================================
</kbd><p>
This model computes the albedo of a fairly
standard BLR cloud.  This is the type of
model that was presented in the BLR albedo
paper by Korista & Ferland, 1998, ApJ 495, 672.
<p>
The print diffuse continua command enters continuum
fluxs into the emission line stack.  The asserts then
check that these continua have the expected brightness.
<p>
</p><hr><h2><kbd>agn_lex00_u0.in  </kbd><I>intermediate-ionization x-ray ionized cloud from Lexington 2000
</I></h2><kbd><br>title intermediate-ionization x-ray ionized cloud from Lexington 2000
<br>stop column density 16
<br>print line sort wavelength 
<br>print lines column linear 
<br>normalise to "H  1" 1216
<br>print line faint -1
<br>hden 5
<br>iterate
<br>phi(h) 15.477 range 7.353 to 735.3
<br>interpolate (-8 -3)
<br>continue (-6 1.)
<br>continue (-2 14.5)
<br>continue (0.4771 12.7) 
<br>continue (0.8663 10.6)
<br>continue (3.8663 7.6)
<br>continue (6 1)
<br>continue (9 -3)
<br>element abundance helium  -1
<br>element abundance carbon -3.432
<br>element abundance nitrogen -3.959
<br>element abundance oxygen -3.097
<br>element abundance neon -3.959
<br>element abundance magnesium -4.4318
<br>element abundance silicon -4.456
<br>element abundance sulphur -4.7959
<br>element abundance argon -5.4318
<br>element abundance iron -4.398
<br>element lithium off
<br>element beryllium off
<br>element boron off
<br>element fluorine off
<br>element sodium off
<br>element aluminium off
<br>element phosphrous off
<br>element chlorine off
<br>element potasium off
<br>element calcium off
<br>element scandium off
<br>element titanium off
<br>element vanadium off
<br>element chromium off
<br>element manganese off
<br>element cobalt off
<br>element nickel off
<br>element copper off
<br>element zinc off
<br>c
<br>punch transmitted continuum "agn_lex00_u0.trn" units keV 
<br>c
<br>c agn_lex00_u0.in
</kbd><p>
This is one of the "warm absorber" simulations presented at the Lexington
2000 meeting on nebulae.  Pequignot et al. summarized in 2001ASPC..247..533P.
It is necessary to also include the command
no induced processes
to obtain the results presented there.  This disables UTA ionization,
a process that was not included in the calculations presented in the paper.
<p>
</p><hr><h2><kbd>agn_lex00_u1.in  </kbd><I>high-ionization x-ray ionized cloud from Lexington 2000
</I></h2><kbd><br>title high-ionization x-ray ionized cloud from Lexington 2000
<br>stop column density 16
<br>print lines column linear 
<br>normalise to "H  1" 1216
<br>print line faint -1
<br>hden 5
<br>iterate
<br>phi(h) 16.477 range 7.353 to 735.3
<br>interpolate (-8 -3)
<br>continue (-6 1.)
<br>continue (-2 14.5)
<br>continue (0.4771 12.7) 
<br>continue (0.8663 10.6)
<br>continue (3.8663 7.6)
<br>continue (6 1)
<br>continue (9 -3)
<br>element abundance helium  -1
<br>element abundance carbon -3.432
<br>element abundance nitrogen -3.959
<br>element abundance oxygen -3.097
<br>element abundance neon -3.959
<br>element abundance magnesium -4.4318
<br>element abundance silicon -4.456
<br>element abundance sulphur -4.7959
<br>element abundance argon -5.4318
<br>element abundance iron -4.398
<br>element lithium off
<br>element beryllium off
<br>element boron off
<br>element fluorine off
<br>element sodium off
<br>element aluminium off
<br>element phosphrous off
<br>element chlorine off
<br>element potasium off
<br>element calcium off
<br>element scandium off
<br>element titanium off
<br>element vanadium off
<br>element chromium off
<br>element manganese off
<br>element cobalt off
<br>element nickel off
<br>element copper off
<br>element zinc off
<br>punch transmitted continuum "agn_lex00_u1.trn" units keV 
<br>c
<br>c agn_lex00_u1.in 
</kbd><p>
This is one of the "warm absorber" simulations presented at the Lexington
2000 meeting on nebulae.  Pequignot et al. summarized in 2001ASPC..247..533P.
It is necessary to also include the command
no induced processes
to obtain the results presented there.  This disables UTA ionization,
a process that was not included in the calculations presented in the paper.
<p>
</p><hr><h2><kbd>agn_lex00_um1.in  </kbd><I>low-ionization x-ray ionized cloud from Lexington 2000
</I></h2><kbd><br>title low-ionization x-ray ionized cloud from Lexington 2000
<br>stop column density 16
<br>print lines column linear
<br>print lines sort intensity 
<br>normalise to "H  1" 1216
<br>print line faint -2
<br>hden 5
<br>iterate
<br>phi(h) 14.477 range 7.353 to 735.3
<br>interpolate (-8 -3)
<br>continue (-6 1.)
<br>continue (-2 14.5)
<br>continue (0.4771 12.7) 
<br>continue (0.8663 10.6)
<br>continue (3.8663 7.6)
<br>continue (6 1)
<br>continue (9 -3)
<br>element abundance helium  -1
<br>element abundance carbon -3.432
<br>element abundance nitrogen -3.959
<br>element abundance oxygen -3.097
<br>element abundance neon -3.959
<br>element abundance magnesium -4.4318
<br>element abundance silicon -4.456
<br>element abundance sulphur -4.7959
<br>element abundance argon -5.4318
<br>element abundance iron -4.398
<br>element lithium off
<br>element beryllium off
<br>element boron off
<br>element fluorine off
<br>element sodium off
<br>element aluminium off
<br>element phosphrous off
<br>element chlorine off
<br>element potasium off
<br>element calcium off
<br>element scandium off
<br>element titanium off
<br>element vanadium off
<br>element chromium off
<br>element manganese off
<br>element cobalt off
<br>element nickel off
<br>element copper off
<br>element zinc off
<br>c 
<br>punch transmitted continuum "agn_lex00_um1.trn"  units keV 
<br>c
<br>c agn_lex00_um1.in 
</kbd><p>
This is one of the "warm absorber" simulations presented at the Lexington
2000 meeting on nebulae.  Pequignot et al. summarized in 2001ASPC..247..533P.
It is necessary to also include the command
no induced processes
to obtain the results presented there.  This disables UTA ionization,
a process that was not included in the calculations presented in the paper.
<p>
<p>
</p><hr><h2><kbd>agn_reflector.in  </kbd><I>model of Compton reflector
</I></h2><kbd><br>title model of Compton reflector
<br>c
<br>c commands controlling continuum =========
<br>c this is a powerlaw that extends into the x-rays, but by default
<br>c has exponential cutoff in FIR
<br>power law -1. hi=1000000000
<br>c the ionization parameter for this powerlaw
<br>ionization parameter 1.
<br>c add background so that FIR/radio does not have zero flux
<br>background
<br>iterate 
<br>c
<br>c commands for density & abundances =========
<br>hden 11
<br>c
<br>c commands controlling geometry  =========
<br>stop total column density 24
<br>c
<br>c other commands for details     =========
<br>constant temper 5
<br>atom h-like element hydrogen levels resolved 10
<br>atom h-like element helium levels resolved 10
<br>c
<br>c commands controlling output    =========
<br>print line faint 1
<br>print line inward
<br>print diffuse continuum
<br>c
<br>c this is to produce lines with lots of contrast with the continuum
<br>set PunchLWidth 100 km/sec
<br>c a fig in part 3 of hazy uses data from this model.  the fig shows lines
<br>c with above and below linewidth
<br>c set PunchLWidth   c  
<br>punch continuum last "agn_reflector.con" units kev 
<br>punch continuum reflected last "agn_reflector.alb" units kev 
<br>punch overview last "agn_reflector.ovr"
<br>punch dr last "agn_reflector.dr"
<br>c
<br>table lines "LineList_BLR.dat" 
<br>c agn_reflector.in
<br>c class blr 
<br>c ========================================
<br>c 
</kbd><p>
This is a model of the Compton reflector in AGN.  It is a
constant temperature since models of this region often make that assumption. 
A plot in Part I of Hazy shows the incident and reflected portions of the 
continuum.  The code will complain that the cloud is Compton thick since it 
is not really designed to simulate this situation.
<p>
</p><hr><h2><kbd>agn_S_curve_grid.in  </kbd><I>temperature across Spitzer thermal stability S curve
</I></h2><kbd><br>title temperature across Spitzer thermal stability S curve
<br>c
<br>c commands controlling continuum =========
<br>c this is the generic AGN continuum
<br>table agn
<br>c the ionization parameter will be varied
<br>ionization parameter 0.00 vary
<br>grid from 0 to 3 in 0.25 dex steps
<br>c add background so that FIR/radio does not have zero flux
<br>background
<br>iterate 
<br>c
<br>c commands for density & abundances =========
<br>c intended to make sim run as fast as possible
<br>hden 8
<br>init file "ism.ini"
<br>element sulphur off
<br>element chlorine off
<br>element argon off
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>c
<br>c commands controlling output
<br>c this produces a very large number of lines in the output mostly
<br>c because Hbeta is very weak in hot gas.  Choose Lya as the normalization
<br>c line to make line list smaller
<br>normalize to "totl" 1216
<br>print line faint 10 will be varied
<br>c create file with list of grid parameters
<br>punch grid "agn_S_curve_grid.grd" last
<br>c save average H+ temperature
<br>punch average "agn_S_curve_grid.avr" last
<br>temperature hydrogen 1 
<br>end of temperatures 
<br>c save heating and cooling
<br>punch heating "agn_S_curve_grid.het" last
<br>punch cooling "agn_S_curve_grid.col" last
<br>punch iron element "agn_S_curve_grid.fe" last 
<br>punch xspec atable "agn_S_curve_grid.fit" 
<br>c
<br>c
<br>c agn_S_grid.in
<br>c class BLR
<br>c ========================================
<br>c
</kbd><p>
This computes a series of models that check the temperature
through the S curve in the Fields et al. three-phase model of
ISM stability.
<p>
<p>
</p><hr><h2><kbd>agn_warm_absorber.in  </kbd><I>simple warm absorber model
</I></h2><kbd><br>title simple warm absorber model
<br>c
<br>c commands controlling continuum =========
<br>table power law
<br>ionization parameter 0
<br>c
<br>c commands for density & abundances =========
<br>hden 6
<br>abundances old solar 84 
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 22
<br>c
<br>c other commands for details     =========
<br>iterate to convergence
<br>c
<br>c commands controlling output    =========
<br>print line faint 10 
<br>plot continuum range 1 1000
<br>punch continuum "agn_warm_absorber.con" last units kev
<br>punch continuum "agn_warm_absorber.conA" last units Angstroms
<br>punch fine continuum "agn_warm_absorber.finA" last units Angstroms range 61 120 merge 3
<br>punch dr "agn_warm_absorber.dr" last
<br>c this will be the default units, like the printout
<br>punch line optical depths last "agn_warm_absorber_lab.lin" 
<br>c this will be the same, in rygbergs
<br>punch line optical depths last "agn_warm_absorber_ryg.lin"  units rydberg
<br>c
<br>c warrm_absorber
<br>c class nlr  
<br>c ========================================
<br>c 
</kbd><p>
<p>
this is a simple warm absorber model.  It makes a plot of the
transmitted continuum, and generates a list of lines with
significant optical depths
</p><hr><h2><kbd>aperture_beam_int.in  </kbd><I>test aperture beam command with intensity
</I></h2><kbd><br>title test aperture beam command with intensity
<br>c
<br>c commands for density & abundances =========
<br>hden 0
<br>init file "honly.ini"
<br>c
<br>c other commands for details     =========
<br>constant temper 4
<br>c
<br>c commands controlling continuum =========
<br>laser 2
<br>ionization -2
<br>c
<br>c commands controlling geometry  =========
<br>stop thickness 10
<br>sphere
<br>aperture beam 
<br>c
<br>c commands controlling output    =========
<br>c
<br>c aperture_beam_int.in 
<br>c class geometry 
<br>c ========================================
</kbd><p>
This is a homogeneous sphere that is especially simple.  The model
is a test of the aperture command, a command that simulates observing
part of an extended object.  In this case the aperture is a beam
contered on the center of the nebula, with a line of sight
extending through the object.  
<p>
The code carries along a dummy emission line ("Unit 1") with a constant intensity
of 1e-10 erg cm-3 s-1.  The line goes through all of the code's infrastructure,
and when the calculation is complete, the program confirms that the "luminosity"
of the line is the emitting volume times 1e-10.  The aperture command
is verified by asserting that the emission line has the correct "luminosity".
In this case the inner radius is not specified so the returned value is unity.
<p>
<p>
</p><hr><h2><kbd>aperture_beam_lum.in  </kbd><I>test aperture beam command with luminosity
</I></h2><kbd><br>title test aperture beam command with luminosity
<br>c
<br>c commands controlling continuum =========
<br>laser 2
<br>q(h) 31.5
<br>c
<br>c commands for density & abundances =========
<br>hden 0
<br>init file "honly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop thickness 10
<br>radius 9
<br>sphere
<br>aperture beam 
<br>c
<br>c other commands for details     =========
<br>constant temper 4
<br>c
<br>c commands controlling output    =========
<br>c
<br>c aperture_beam_lum.in
<br>c class geometry 
<br>c ========================================
</kbd><p>
<p>
This is a homogeneous sphere that is especially simple.  The model
is a test of the aperture command, a command that simulates observing
part of an extended object.  In this case the aperture is a beam
contered on the center of the nebula, with a line of sight
extending through the object.  
<p>
The code carries along a dummy emission line ("Unit 1") with a constant intensity
of 1e-10 erg cm-3 s-1.  The line goes through all of the code's infrastructure,
and when the calculation is complete, the program confirms that the "luminosity"
of the line is the emitting volume times 1e-10.  The aperture command
is verified by asserting that this emission line has the correct "luminosity".
<p>
<p>
</p><hr><h2><kbd>aperture_slit.in  </kbd><I>test aperture slit command with luminosity
</I></h2><kbd><br>title test aperture slit command with luminosity
<br>c
<br>c commands controlling continuum =========
<br>laser 2
<br>q(h) 31.5
<br>c
<br>c commands for density & abundances =========
<br>hden 0
<br>init file "honly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>radius 9 10
<br>sphere
<br>aperture slit 
<br>c
<br>c other commands for details     =========
<br>constant temper 4
<br>c
<br>c commands controlling output    =========
<br>c
<br>c aperture_slit.in
<br>c class geometry 
<br>c ========================================
<br>c 
</kbd><p>
This is a homogeneous sphere that is especially simple.  The model
is a test of the aperture command, a command that simulates observing
part of an extended object.  In this case the aperture is a long
slit contered on the center of the nebula, extending beyond the outer
reaches of the matter.  
<p>
The code carries along a dummy emission line ("Unit 1") with a constant intensity
of 1e-10 erg cm-3 s-1.  The line goes through all of the code's infrastructure,
and when the calculation is complete, the program confirms that the "luminosity"
of the line is the emitting volume times 1e-10.  The aperture command
is verified by asserting that the emission line has the correct "luminosity".
<p>
</p><hr><h2><kbd>blr_f92.in  </kbd><I>standard blr cloud in Ferland et al. 1992
</I></h2><kbd><br>title standard blr cloud in Ferland et al. 1992
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>ionization parameter -1
<br>c
<br>c commands for density & abundances =========
<br>hden 11
<br>abundances old solar 84 
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 25
<br>c
<br>c other commands for details     =========
<br>atom h-like element hydrogen levels resolved 10
<br>atom h-like element helium levels resolved 10
<br>iterate to convergence
<br>c
<br>c commands controlling output    =========
<br>print h-like departure hydrogen 
<br>print h-like populations hydrogen 
<br>print h-like departure helium
<br>print h-like populations helium
<br>plot continuum
<br>normalize to "H  1" 1216 = 105.90
<br>print line faint -2
<br>punch overview last "blr_f92.ovr"
<br>punch convergence reason "blr_f92.cvr"
<br>punch element nitrogen last "blr_f92.nit"
<br>punch element calcium last "blr_f92.ca"
<br>punch dr "blr_f92.dr"
<br>punch transmitted continuum "blr_f92.trn" last
<br>c
<br>c blr_f92.ini
<br>c class blr 
<br>c ========================================
</kbd><p>
This is similar to one of the BLR models presented in Ferland et al. (1992)
for the well-studied Seyfert galaxy NGC 5548.  It has a very large column
density and is marginally optically thick to electron scattering.  The spectrum
is given relative to Lya, and the intensity of this line is reset to 
produce a spectrum that is on the same intensity scale as that paper.
<p>
</p><hr><h2><kbd>blr_fp89.in  </kbd><I>final F+P 1989 BLR model table 3
</I></h2><kbd><br>title final F+P 1989 BLR model table 3
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>ionization parameter -0.5
<br>c
<br>c commands for density & abundances =========
<br>hden 9.5
<br>init file="c84.ini"
<br>abundances old solar 84 
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 25.5
<br>c
<br>c other commands for details     =========
<br>iterate to convergence
<br>failures 2
<br>c
<br>c commands controlling output    =========
<br>c set a relatively high faint level since lines relative to Lya=100
<br>print line faint -1
<br>print h-like departure coefficients
<br>plot continuum
<br>normalize to "H  1" 1216 = 85.60
<br>punch heating "blr_fp89.het"
<br>punch convergence reason "blr_fp89.cvr" 
<br>punch cooling "blr_fp89.col"
<br>punch overview last "blr_fp89.ovr"
<br>punch element nitrogen last "blr_fp89.nit"
<br>punch results last "blr_fp89.rlt"
<br>punch dr "blr_fp89.dr"
<br>c
<br>c blr_fp89.in
<br>c class blr 
<br>c ========================================
</kbd><p>
<p>
<p>
Ferland and Persson (1989) presented this calculation of a BLR cloud.
The differences between the present predictions and
those given by FP are largely due to improved treatment
of Balmer line escape and destruction. The spectrum is given relative
to a Lya intensity of 100. The column density is VERY large, to
reproduce intensities of low-ionization lines, especially the Ca II lines.
<p>
</p><hr><h2><kbd>blr_hizqso.in  </kbd><I>high Z quasar cloud
</I></h2><kbd><br>title high Z quasar cloud
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>ionization parameter 1
<br>c
<br>c commands for density & abundances =========
<br>c actual elec den will be about 100x larger 
<br>hden 8
<br>abundances starburst 35
<br>c
<br>c commands controlling geometry  =========
<br>c this is more gramage than it appears because of high Z
<br>stop column density 21
<br>c
<br>c other commands for details     =========
<br>c once elec den fail occurs due to tripping over He+ - He I-front
<br>c code does recover so not a problem.  The default for this is 10,
<br>c and is set low because (hopefully) this would never occur
<br>c hydrogen is a minor constituent in this high metallicity gas
<br>c the electron density is well above the hydrogen density
<br>failures 3
<br>iterate 3 
<br>c
<br>c commands controlling output    =========
<br>normalize "totl" 1909
<br>punch dr "blr_hizqso.dr"
<br>punch convergence reason "blr_hizqso.cvr"
<br>punch overview last "blr_hizqso.ovr"
<br>punch element nitrogen last "blr_hizqso.nit"
<br>punch element chlorine last "blr_hizqso.cl"
<br>punch element iron last "blr_hizqso.fe"
<br>punch element neon last "blr_hizqso.ne"
<br>punch element calcium last "blr_hizqso.ca"
<br>punch element zinc last "blr_hizqso.zn"
<br>punch heating last "blr_hizqso.het"
<br>punch cooling last "blr_hizqso.col"
<br>c
<br>c 
<br>c blr_hizqso.in
<br>c class blr 
<br>c ========================================
</kbd><p>
This is a model of a very high metallicty BLR cloud.  It checks the
intensities of some of the brigher lines, and is a check that the code
can converge a cloud with this high Z.
<p>
Secondary ionization is very important when H is highly ionized,
due to very high He abundance.  Sec ionization becomes important
at the He+ - He ionization front, where H+/H is 1e-5.
<p>
</p><hr><h2><kbd>blr_kk81.in  </kbd><I>old blr
</I></h2><kbd><br>title old blr
<br>c
<br>c commands controlling continuum =========
<br>interpolate (0 -5) (.05 -5) (.1 0) (1 -0.5) (7.353 -2.233)
<br>continue (735 -3.233) (800 -15) (8.e6 -15)
<br>f(nu) -7.32148
<br>constant gas pressure
<br>c
<br>c commands for density & abundances =========
<br>hden 9.60206
<br>init file="c84.ini"
<br>abundances he-1 c-3.699 n-4 o-3.1549 ne-4 na=-8 mg-4.5229
<br>continue al-10 si-4.4229 s-10 ar-10 ca-10 fe-4.5229 ni=-8
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 23
<br>c
<br>c other commands for details     =========
<br>failures 2
<br>iterate to convergence
<br>c
<br>c commands controlling output    =========
<br>print line faint -1
<br>print ages 
<br>normalise "H  1" 1216 100
<br>plot continuum range -3
<br>punch overview last "blr_kk81.ovr"
<br>punch dr last "blr_kk81.dr"
<br>punch continuum last "blr_kk81.con"
<br>punch ionizing continuum "blr_kk81.ion"
<br>c
<br>c
<br>c blr_kk81.in
<br>c class blr 
<br>c ========================================
<br>c 
</kbd><p>
This is the "standard" BLR model presented by Kwan and Krolik (1981).
<p>
>>refer	blr	cloud	Kwan, J.,  & Krolik, J. 1981, ApJ, 250, 478
<p>
Compare line intensities to previous versions of CLOUDY
by entering into table on page Error! Bookmark not defined..
<p>
The code caution that the resulting total pressure was not constant
is to be expected.  The KK calculation assumed constant gas pressure,
but internally generature line radiation pressure is significant.  
Because of this the sum
of gas plus radiation pressure was not constant although 
the gas pressure was. 
<p>
</p><hr><h2><kbd>blr_level2.in  </kbd><I>test dominant level2 lines
</I></h2><kbd><br>title test dominant level2 lines
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>ionization -2
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 19
<br>c
<br>c commands for density & abundances =========
<br>hden 10
<br>element phosphorus abundance 0
<br>c
<br>c other commands for details     =========
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>punch overview "blr_level2.ovr"
<br>punch dr "blr_level2.dr"
<br>c
<br>c blr_level2.in
<br>c class blr 
<br>c ========================================
</kbd><p>
This model checks predictions for the "level2" lines.  These are
lines that are normally very weak, have Opacity Project wavelengths,
and g-bar collision strengths.  Phosphorus is given a large abundance
so that its level2 lines are significant.
<p>
</p><hr><h2><kbd>blr_n09_p18.in  </kbd><I>BLR model, density 1e09 cm-3, flux of H-ion phots 1e18 cm2 s-1
</I></h2><kbd><br>title BLR model, density 1e09 cm-3, flux of H-ion phots 1e18 cm2 s-1
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>phi(h) 18
<br>c
<br>c commands for density & abundances =========
<br>hden 9
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 23
<br>c
<br>c other commands for details     =========
<br>init "c84.ini"
<br>iterate convergence 
<br>c these are to try to speed things up
<br>no level2 lines
<br>c
<br>c commands controlling output    =========
<br>normalize to "totl" 1216 100 
<br>punch overview "blr_n09_p18.ovr" last
<br>punch dr "blr_n09_p18.dr" last 
<br>punch convergence reason "blr_n09_p18.cvr"
<br>c
<br>c blr_n09_p18.in 
<br>c class blr 
<br>c ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><h2><kbd>blr_n09_p18_Z20.in  </kbd><I>BLR model, density 1e09 cm-3, flux of H-ion phots 1e18 cm2 s-1, Z=20
</I></h2><kbd><br>title BLR model, density 1e09 cm-3, flux of H-ion phots 1e18 cm2 s-1, Z=20
<br>c 
<br>c commands controlling continuum =========
<br>table agn
<br>phi(h) 18
<br>c
<br>c commands for density & abundances =========
<br>hden 9
<br>abundances starburst 20 
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 23
<br>c
<br>c other commands for details     =========
<br>iterate to convergence
<br>c these are to try to speed things up
<br>init "c84.ini"
<br>no level2 lines
<br>c
<br>c commands controlling output    =========
<br>normalize to "totl" 1216 100 
<br>print h-like hydrogen departure coefficients
<br>punch overview "blr_n09_p18_Z20.ovr"
<br>punch dr "blr_n09_p18_Z20.dr"
<br>punch convergence reason "blr_n09_p18_Z20.cvr"
<br>punch convergence error "blr_n09_p18_Z20.cve"
<br>c
<br>c blr_n09_p18_Z20.in 
<br>c class blr 
<br>c ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><h2><kbd>blr_n09_p20.in  </kbd><I>BLR model, density 1e09 cm-3, flux of H-ion phots 1e20 cm2 s-1
</I></h2><kbd><br>title BLR model, density 1e09 cm-3, flux of H-ion phots 1e20 cm2 s-1
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>phi(h) 20
<br>c
<br>c commands for density & abundances =========
<br>hden 9
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 23
<br>c
<br>c other commands for details     =========
<br>init "c84.ini"
<br>iterate convergence 
<br>c these are to try to speed things up
<br>no level2 lines
<br>c
<br>c commands controlling output    =========
<br>normalize to "totl" 1216 100 
<br>punch overview "blr_n09_p18.ovr" last
<br>punch dr "blr_n09_p18.dr" last 
<br>punch convergence reason "blr_n09_p18.cvr"
<br>c
<br>c blr_n09_p18.in 
<br>c class blr 
<br>c ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><h2><kbd>blr_n09_p20_Z20.in  </kbd><I>BLR model, density 1e09 cm-3, flux of H-ion phots 1e20 cm2 s-1, Z=20
</I></h2><kbd><br>title BLR model, density 1e09 cm-3, flux of H-ion phots 1e20 cm2 s-1, Z=20
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>phi(h) 20
<br>c
<br>c commands for density & abundances =========
<br>abundances starburst 20 
<br>hden 9
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 23
<br>c
<br>c other commands for details     =========
<br>init "c84.ini"
<br>iterate convergence 
<br>c these are to try to speed things up
<br>no level2 lines
<br>c
<br>c commands controlling output    =========
<br>normalize to "totl" 1216 100 
<br>punch overview "blr_n09_p20_Z20.ovr" last
<br>punch dr "blr_n09_p20_Z20.dr" last 
<br>punch convergence reason "blr_n09_p20_Z20.cvr"
<br>c
<br>c blr_n09_p20_Z20.in 
<br>c class blr 
<br>c ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
<p>
This simulation is optically thin in the Lyman continuum - no H ionization
front is present.  As a result it can be difficult to converge.
</p><hr><h2><kbd>blr_n09_p22.in  </kbd><I>BLR model, density 1e09 cm-3, flux of H-ion phots 1e20 cm2 s-1
</I></h2><kbd><br>title BLR model, density 1e09 cm-3, flux of H-ion phots 1e20 cm2 s-1
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>phi(h) 22
<br>c
<br>c commands for density & abundances =========
<br>hden 9
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 23
<br>c
<br>c other commands for details     =========
<br>init "c84.ini"
<br>iterate convergence 
<br>c these are to try to speed things up
<br>no level2 lines
<br>c
<br>c commands controlling output    =========
<br>normalize to "totl" 1216 100 
<br>punch overview "blr_n09_p22.ovr" last
<br>punch dr "blr_n09_p22.dr" last 
<br>punch convergence reason "blr_n09_p22.cvr"
<br>c
<br>c blr_n09_p22.in 
<br>c class blr 
<br>c ========================================
</kbd><p>
This is one of the models that sample the LOC plane.
</p><hr><h2><kbd>blr_n09_p22_Z20.in  </kbd><I>BLR model, density 1e09 cm-3, flux of H-ion phots 1e22 cm2 s-1, Z=20
</I></h2><kbd><br>title BLR model, density 1e09 cm-3, flux of H-ion phots 1e22 cm2 s-1, Z=20
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>phi(h) 22
<br>c
<br>c commands for density & abundances =========
<br>abundances starburst 20 
<br>hden 9
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 23
<br>c
<br>c other commands for details     =========
<br>init "c84.ini"
<br>iterate convergence 
<br>c these are to try to speed things up
<br>no level2 lines
<br>c
<br>c commands controlling output    =========
<br>normalize to "totl" 1216 100 
<br>punch overview "blr_n09_p22_Z20.ovr" last
<br>punch dr "blr_n09_p22_Z20.dr" last 
<br>punch convergence reason "blr_n09_p22_Z20.cvr"
<br>c
<br>c blr_n09_p22_Z20.in 
<br>c class blr 
<br>c ========================================
</kbd><p>
This is one of the models that sample the LOC plane.
</p><hr><h2><kbd>blr_n11_p20.in  </kbd><I>BLR model, density 1e11 cm-3, flux of H-ion phots 1e20 cm2 s-1
</I></h2><kbd><br>title BLR model, density 1e11 cm-3, flux of H-ion phots 1e20 cm2 s-1
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>phi(h) 20
<br>c
<br>c commands for density & abundances =========
<br>hden 11
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 23
<br>c
<br>c other commands for details     =========
<br>iterate convergence 
<br>c these are to try to speed things up
<br>init "c84.ini"
<br>no level2 lines
<br>c
<br>c commands controlling output    =========
<br>normalize to "totl" 1216 100 
<br>punch convergence reason "blr_n11_p20.cvr"
<br>punch overview "blr_n11_p20.ovr" last
<br>punch dr "blr_n11_p20.dr" last 
<br>c
<br>c blr_n11_p20.in 
<br>c class blr 
<br>c ========================================
<br>c 
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><h2><kbd>blr_n11_p20_Z20.in  </kbd><I>BLR model, density 1e11 cm-3, flux of H-ion phots 1e20 cm2 s-1, Z=20
</I></h2><kbd><br>title BLR model, density 1e11 cm-3, flux of H-ion phots 1e20 cm2 s-1, Z=20
<br>c 
<br>c commands controlling continuum =========
<br>table agn
<br>phi(h) 20
<br>c
<br>c commands for density & abundances =========
<br>hden 11
<br>abundances starburst 20 
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 23
<br>c
<br>c other commands for details     =========
<br>iterate convergence 
<br>c these are to try to speed things up
<br>init "c84.ini"
<br>no level2 lines
<br>c
<br>c commands controlling output    =========
<br>normalize to "totl" 1216 100 
<br>punch cooling "blr_n11_p20_Z20.col" 
<br>punch heating "blr_n11_p20_Z20.het" 
<br>punch element calcium "blr_n11_p20_Z20.cal" 
<br>punch overview "blr_n11_p20_Z20.ovr" 
<br>punch dr "blr_n11_p20_Z20.dr" 
<br>punch temperature history "blr_n11_p20_Z20.tem" 
<br>c
<br>c blr_n11_p20_Z20.in 
<br>c class blr 
<br>c ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><h2><kbd>blr_n12_p19.in  </kbd><I>BLR model, density 1e12 cm-3, flux of H-ion phots 1e19 cm2 s-1
</I></h2><kbd><br>title BLR model, density 1e12 cm-3, flux of H-ion phots 1e19 cm2 s-1
<br>c
<br>c commands for density & abundances =========
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>phi(h) 19
<br>c
<br>c commands controlling geometry  =========
<br>hden 12
<br>stop column density 23
<br>c
<br>c other commands for details     =========
<br>iterate convergence 
<br>c these are to try to speed things up
<br>init "c84.ini"
<br>no level2 lines
<br>c
<br>c commands controlling output    =========
<br>normalize to "totl" 1216 100 
<br>punch overview "blr_n12_p19.ovr" last
<br>punch dr "blr_n12_p19.dr" last 
<br>c
<br>c 
<br>c blr_n12_p19.in 
<br>c class blr 
<br>c ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><h2><kbd>blr_n12_p19_Z20.in  </kbd><I>BLR model, density 1e12 cm-3, flux of H-ion phots 1e19 cm2 s-1, Z=20
</I></h2><kbd><br>title BLR model, density 1e12 cm-3, flux of H-ion phots 1e19 cm2 s-1, Z=20
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>phi(h) 19
<br>c
<br>c commands for density & abundances =========
<br>hden 12
<br>abundances starburst 20 
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 23
<br>c
<br>c other commands for details     =========
<br>failures 5 
<br>iterate convergence 
<br>c these are to try to speed things up
<br>init "c84.ini"
<br>no level2 lines
<br>c
<br>c commands controlling output    =========
<br>normalize to "totl" 1216 100 
<br>punch convergence reason "blr_n12_p19_Z20.cvr" 
<br>punch overview "blr_n12_p19_Z20.ovr" last
<br>punch dr "blr_n12_p19_Z20.dr" last 
<br>c
<br>c blr_n12_p19_Z20.in 
<br>c class blr 
<br>c ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><h2><kbd>blr_n13_p18.in  </kbd><I>BLR model, density 1e13 cm-3, flux of H-ion phots 1e18 cm2 s-1
</I></h2><kbd><br>title BLR model, density 1e13 cm-3, flux of H-ion phots 1e18 cm2 s-1
<br>c
<br>c this is a very low ionization cloud
<br>c the conditions, and some lines, are surprisingly sensitive
<br>c to the treatment of hydrogen molecules
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>phi(h) 18
<br>c
<br>c commands for density & abundances =========
<br>hden 13
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 23
<br>c
<br>c other commands for details     =========
<br>iterate to convergence 
<br>c
<br>c commands controlling output    =========
<br>normalize to "totl" 1216 100 
<br>init "c84.ini"
<br>no level2 lines
<br>punch overview "blr_n13_p18.ovr" last
<br>punch dr "blr_n13_p18.dr" last 
<br>punch convergence reason "blr_n13_p18.cvr" 
<br>c
<br>c blr_n13_p18.in 
<br>c class blr 
<br>c ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><h2><kbd>blr_n13_p18_Z20.in  </kbd><I>BLR model, density 1e13 cm-3, flux of H-ion phots 1e18 cm2 s-1, Z=20
</I></h2><kbd><br>title BLR model, density 1e13 cm-3, flux of H-ion phots 1e18 cm2 s-1, Z=20
<br>c
<br>c this is a very low ionization cloud
<br>c the conditions, and some lines, are surprisingly sensitive
<br>c to the treatment of hydrogen molecules
<br>c
<br>c commands controlling continuum =========
<br>phi(h) 18
<br>table agn
<br>c
<br>c commands for density & abundances =========
<br>hden 13
<br>abundances starburst 20 
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 23
<br>c
<br>c other commands for details     =========
<br>c this sim needs roughly 10 iterations to converge 
<br>iterate convergence
<br>c these are to try to speed things up
<br>init "c84.ini"
<br>no level2 lines
<br>c abort if any failures occur - we want to pass this test
<br>failures 1 
<br>c
<br>c commands controlling output    =========
<br>normalize to "totl" 1216 100 
<br>punch overview "blr_n13_p18_Z20.ovr" last
<br>punch overview "blr_n13_p18_Z20.ovr1"
<br>punch dr "blr_n13_p18_Z20.dr" last 
<br>punch convergence reason "blr_n13_p18_Z20.cvr" 
<br>c
<br>c 
<br>c blr_n13_p18_Z20.in 
<br>c class blr 
<br>c ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><h2><kbd>blr_n13_p22.in  </kbd><I>BLR model, density 1e13 cm-3, flux of H-ion phots 1e22 cm2 s-1
</I></h2><kbd><br>title BLR model, density 1e13 cm-3, flux of H-ion phots 1e22 cm2 s-1
<br>c 
<br>c commands controlling continuum =========
<br>table agn
<br>phi(h) 22
<br>c
<br>c commands for density & abundances =========
<br>hden 13
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 23
<br>c
<br>c other commands for details     =========
<br>iterate convergence 
<br>c these are to try to speed things up
<br>init "c84.ini"
<br>no level2 lines
<br>c
<br>c commands controlling output    =========
<br>print h-like departure hydrogen 
<br>print h-like departure helium 
<br>normalize to "totl" 1216 100 
<br>punch overview "blr_n13_p22.ovr" last
<br>punch dr "blr_n13_p22.dr" last 
<br>c
<br>c blr_n13_p22.in 
<br>c class blr 
<br>c ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><h2><kbd>blr_n13_p22_Z20.in  </kbd><I>BLR model, density 1e13 cm-3, flux of H-ion phots 1e18 cm2 s-1, Z=20
</I></h2><kbd><br>title BLR model, density 1e13 cm-3, flux of H-ion phots 1e18 cm2 s-1, Z=20
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>phi(h) 22
<br>c
<br>c commands for density & abundances =========
<br>hden 13
<br>abundances starburst 20 
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 23
<br>c
<br>c other commands for details     =========
<br>iterate convergence 
<br>c these are to try to speed things up
<br>init "c84.ini"
<br>no level2 lines
<br>c
<br>c commands controlling output    =========
<br>normalize to "totl" 1216 100 
<br>punch overview "blr_n13_p22_Z20.ovr"
<br>punch dr "blr_n13_p22_Z20.dr"
<br>punch heating "blr_n13_p22_Z20.het"
<br>punch cooling "blr_n13_p22_Z20.col"
<br>c
<br>c blr_n13_p22_Z20.in 
<br>c class blr 
<br>c ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><h2><kbd>blr_nf84.in  </kbd><I>early model of blr
</I></h2><kbd><br>title early model of blr
<br>c
<br>c commands controlling continuum =========
<br>ionization parameter -1.92
<br>power law -1 100 0.01
<br>c
<br>c commands for density & abundances =========
<br>hden 9.5
<br>init, file="ism.ini"
<br>abundances cameron
<br>stop lyman optical 6
<br>c
<br>c commands controlling geometry  =========
<br>c
<br>c other commands for details     =========
<br>constant gas pressure
<br>iterate to convergence
<br>c
<br>c commands controlling output    =========
<br>print diffuse continuum
<br>plot continuum
<br>punch overview last "blr_nf84.ovr"
<br>punch dr last "blr_nf84.dr"
<br>punch results last "blr_nf84.rlt"
<br>c
<br>table lines "LineList_strong.dat" 
<br>c blr_nf84.in
<br>c class blr 
<br>c ========================================
<br>c 
</kbd><p>
This is an example of a "conventional" BLR calculation. The parameters are
similar to those of Table 1 of Netzer and Ferland (1984).  Notice that the
ratio of Lyalpha to Hbeta ratio is much larger than observed.
<p>
>>refer	blr	model	Netzer, H., & Ferland, G. J. 1984, PASP, 96, 593  
<p>
</p><hr><h2><kbd>blr_nf84_45deg.in  </kbd><I>early model of BLR, with illumination at 45 degree angle
</I></h2><kbd><br>title early model of BLR, with illumination at 45 degree angle
<br>c
<br>c commands controlling continuum =========
<br>ionization parameter -1.92
<br>power law -1 100 0.01
<br>c this continuum is a beam coming in at 45 degrees 
<br>illuminate 45 degrees
<br>c
<br>c commands for density & abundances =========
<br>hden 9.5
<br>abundances cameron
<br>stop lyman optical 6
<br>c
<br>c commands controlling geometry  =========
<br>c
<br>c other commands for details     =========
<br>init file "ism.ini"
<br>constant gas pressure
<br>iterate to convergence
<br>c
<br>c commands controlling output    =========
<br>print diffuse continuum
<br>plot continuum
<br>punch overview "blr_nf84_45deg.ovr"
<br>punch dr "blr_nf84_45deg.dr"
<br>punch results last "blr_nf84_45deg.rlt"
<br>c
<br>c blr_nf84_45deg.in
<br>c class blr 
<br>c ========================================
<br>c 
</kbd><p>
This is an example of a "conventional" BLR calculation. The parameters are
similar to those of Table 1 of Netzer and Ferland (1984).  Notice that the
ratio of Lyalpha to Hbeta ratio is much larger than observed.
<p>
>>refer	blr	model	Netzer, H., & Ferland, G. J. 1984, PASP, 96, 593  
<p>
</p><hr><h2><kbd>blr_rnfa.in  </kbd><I>table 1 of Rees et al. ApJ 347, 648
</I></h2><kbd><br>title table 1 of Rees et al. ApJ 347, 648
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>hden 10
<br>init file="c84.ini"
<br>abundances he -1 c -3.328 n -4.0088 o -3.0809 ne -4 na -20
<br>continue mg -4.3768 al -5.5686 si -4.36653 s -4.76955 
<br>continue a -5.4202 ca -5.6383 fe -4.4815 ni -20
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 23
<br>c
<br>c other commands for details     =========
<br>iterate to convergence
<br>c
<br>c commands controlling output    =========
<br>normalise "H  1" 1216 = 100
<br>print line faint -1
<br>punch overview last "blr_rnfa.ovr"
<br>punch continuum last "blr_rnfa.con" units microns 
<br>punch transmitted continuum last "blr_rnfa.trn" units rydbergs 
<br>punch element nitrogen last "blr_rnfa.nit"
<br>punch dr last "blr_rnfa.dr"
<br>punch results last "blr_rnfa.rlt"
<br>c
<br>c blr_rnfa.in
<br>c class blr
<br>c ========================================
<br>c 
</kbd><p>
This is the lower density cloud computed in Rees et al. (1989). 
Table 1 of that paper lists the predictions, which were a mean of those
of Hagai Netzer's ION and roughly version 76 of CLOUDY.  The lines
are generally still in good agreement with the predictions of that paper. 
In particular the changes in the line fluxes shown in Figure 1
of that paper are reproduced quite well.
</p><hr><h2><kbd>blr_rnfb.in  </kbd><I>table 1 of Rees et al. ApJ 347, 648
</I></h2><kbd><br>title table 1 of Rees et al. ApJ 347, 648
<br>c 
<br>c blr model from 
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>hden 12
<br>init file="c84.ini"
<br>abundances he -1 c -3.328 n -4.0088 o -3.0809 ne -4 na -20
<br>continue mg -4.3768 al -5.5686 si -4.36653 s -4.76955 
<br>continue a -5.4202 ca -5.6383 fe -4.4815 ni -20
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 23
<br>c
<br>c other commands for details     =========
<br>iterate to convergence
<br>c
<br>c commands controlling output    =========
<br>print line faint -1
<br>punch overview last "blr_rnfb.ovr"
<br>punch element nitrogen last "blr_rnfb.nit"
<br>punch dr last "blr_rnfb.dr"
<br>punch results last "blr_rnfb.rlt"
<br>normalise "H  1" 1216 = 91.8
<br>c
<br>c blr_rnfb.in
<br>c class blr 
<br>c ========================================
<br>c 
</kbd><p>
This is a very dense cloud, and was computed in Rees et al. (1989). 
Table 1 of that paper lists the predictions, which were a mean of those of
Hagai Netzer's ION and roughly version 76 of CLOUDY.  The lines are
generally still in good agreement with the predictions of that paper. 
In particular the changes in the line fluxes shown in Figure 1 of that
paper are reproduced quite well.  The fluxes of Lya and Hb are not
reproduced with great precision by this model because of changes in
collision rates for hydrogen and especially the form of the
escape probability function for subordinate lines.  As Figure 1 of
RNF showed the line intensities are very sensitive to density for
these parameters.
</p><hr><h2><kbd>coll_coronal.in  </kbd><I>model of active region of solar corona
</I></h2><kbd><br>title model of active region of solar corona
<br>c
<br>c commands controlling continuum =========
<br>c temperature of corona
<br>coronal equilibrium, 2.5e6 K
<br>c assume the sun is a blackbody at 5770K
<br>blackbody 5770 K
<br>luminosity solar linear 1 
<br>c
<br>c commands for density & abundances =========
<br>hden log=10 
<br>c
<br>c commands controlling geometry  =========
<br>c its height above photosphere and thickness
<br>radius 11 thickness = 10
<br>c the gas fully covers the center of symmetry
<br>sphere
<br>c
<br>c other commands for details     =========
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>normalize to "o  8" 18.97A 
<br>punch dr "coll_coronal.dr" last
<br>punch continuum "coll_coronal.con" last units angstroms
<br>c
<br>c 
<br>c coll_coronal.in
<br>c class coronal 
<br>c ========================================
<br>c 
</kbd><p>
This is a rough model of the solar corona.
The test checks that the coronal equilibrium commands work.
The gas is predominantly collisionally ionized.
<p>
</p><hr><h2><kbd>coll_heat_only.in  </kbd><I>test code in limit where ONLY mechanical heating is present
</I></h2><kbd><br>title test code in limit where ONLY mechanical heating is present
<br>c
<br>c commands controlling continuum =========
<br>no photoionization
<br>blackbody 5000 STE 
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 15 
<br>c
<br>c commands for density & abundances =========
<br>hden 10
<br>c
<br>c other commands for details     =========
<br>hextra -1.5
<br>iterate 
<br>c
<br>c commands controlling output    =========
<br>c this command must be tested somewhere
<br>print cooling, zone 5
<br>c output files
<br>punch overview "coll_heat_only.ovr"
<br>punch heating "coll_heat_only.het"
<br>punch cooling "coll_heat_only.col"
<br>punch convergence reason "coll_heat_only.cvr"
<br>punch dr "coll_heat_only.dr"
<br>punch continuum "coll_heat_only.con"  units angstroms 
<br>c
<br>c  
<br>c coll_heat_only.in
<br>c class coronal 
<br>c ========================================
</kbd><p>
This test is an optically thin collisionally ionized gas with no
photoionization at all. 
<p>
<p>
</p><hr><h2><kbd>coll_t3.in  </kbd><I>coronal equilibrium at 10^4 K
</I></h2><kbd><br>title coronal equilibrium at 10^4 K
<br>c
<br>c commands controlling continuum =========
<br>coronal 3  
<br>c add component of cosmic rays to drive chemistry 
<br>cosmic ray background
<br>c
<br>c other commands for details     =========
<br>iterate  
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 15 
<br>c
<br>c commands for density & abundances =========
<br>hden 10  
<br>c
<br>c commands controlling output    =========
<br>punch overview "coll_t3.ovr" 
<br>punch continuum "coll_t3.con"  units angstroms 
<br>c
<br>c
<br>c coll_t3.in
<br>c class coronal  
<br>c ========================================
</kbd><p>
This tests conditions of collisional equilibrium at low densities.
This is one of a series of sims coll_t?.in which test ionization
over a range of temperatures.  This one, unlike the others,
includes cosmic rays.  Chemistry is important at this low temperature
and the chemical network will collapse without a source of ionization.
The cosmic rays provide this source of ionization.
</p><hr><h2><kbd>coll_t4.in  </kbd><I>coronal equilibrium at 10^4 K
</I></h2><kbd><br>title coronal equilibrium at 10^4 K
<br>c
<br>c commands controlling continuum =========
<br>coronal 4
<br>c
<br>c other commands for details     =========
<br>iterate
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 15 
<br>c
<br>c commands for density & abundances =========
<br>hden 10
<br>c
<br>c commands controlling output    =========
<br>punch overview "coll_t4.ovr" 
<br>punch continuum "coll_t4.con"  units angstroms 
<br>c
<br>c
<br>c coll_t4.in
<br>c class coronal  
<br>c ========================================
</kbd><p>
this tests conditions of collisional equilibrium at low densities
</p><hr><h2><kbd>coll_t5.in  </kbd><I>coronal equilibrium at 10^5 K
</I></h2><kbd><br>title coronal equilibrium at 10^5 K
<br>c
<br>c commands controlling continuum =========
<br>coronal 5
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 15 
<br>c
<br>c commands for density & abundances =========
<br>hden 10
<br>c
<br>c other commands for details     =========
<br>iterate
<br>c
<br>c
<br>c commands controlling output    =========
<br>c normalize to strong HeII line
<br>normalize to "He 2" 303.8A 
<br>punch overview "coll_t5.ovr"
<br>punch continuum "coll_t5.con" units angstroms 
<br>c
<br>table lines "LineList_He_like.dat"
<br>c coll_t5.in
<br>c class coronal  
<br>c ========================================
</kbd><p>
This is a test collisional ionization equilibrium
at 1e5 K.
</p><hr><h2><kbd>coll_t6.in  </kbd><I>coronal equilibrium at 10^6 K
</I></h2><kbd><br>title coronal equilibrium at 10^6 K
<br>c
<br>c commands controlling continuum =========
<br>coronal 6
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 15 
<br>c
<br>c commands for density & abundances =========
<br>hden 10
<br>c
<br>c other commands for details     =========
<br>iterate 
<br>c
<br>c commands controlling output    =========
<br>normalize to "c  5" 40.27A 
<br>c output files
<br>punch overview "coll_t6.ovr"
<br>punch continuum "coll_t6.con"  units angstroms 
<br>c
<br>c coll_t6.in
<br>c class coronal 
<br>c ========================================
</kbd><p>
This test is an optically thin collisionally ionized gas.
<p>
<p>
</p><hr><h2><kbd>coll_t7.in  </kbd><I>coronal equilibrium at 10^7 K
</I></h2><kbd><br>title coronal equilibrium at 10^7 K
<br>c
<br>c commands controlling continuum =========
<br>coronal 7
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 15 
<br>c
<br>c commands for density & abundances =========
<br>hden 10
<br>c
<br>c other commands for details     =========
<br>c
<br>normalize to "o  8" 18.97A 
<br>c commands controlling output    =========
<br>punch overview "coll_t7.ovr"
<br>punch continuum "coll_t7.con" units angstroms
<br>punch cooling "coll_t7.col"
<br>c
<br>c coll_t7.in 
<br>c class coronal 
<br>c ========================================
</kbd><p>
Test with only collisional ionization at a
high temperature. 
</p><hr><h2><kbd>dynamics_orion_flow.in  </kbd><I>Orion nebula blister with wind
</I></h2><kbd><br>title Orion nebula blister with wind
<br>c
<br>c commands controlling continuum =========
<br>blackbody 40000
<br>phi(h) 13.0
<br>brems 6
<br>phi(h) 10
<br>c
<br>c commands for density & abundances =========
<br>hden 4
<br>abundances hii region no grains
<br>grains orion no qheat single 
<br>c
<br>c commands controlling geometry  =========
<br>wind -7 km/s advection
<br>c this accounts for matter beyond end of the model
<br>double optical depths
<br>sphere 
<br>stop AV 5 
<br>stop temperature linear 5  
<br>c
<br>c other commands for details     =========
<br>iterate 4
<br>magnetic field -4 
<br>cosmic rays background 
<br>c this has no effect on dynamics, but is to desaturate the lines as per flow
<br>turbulence 8 km/sec no pressure
<br>c try to speed up simulation without hurting dynamics
<br>init "fast.ini"
<br>c use Bakes & Tielens heating
<br>set PAH Bakes 
<br>* init "c84.ini"
<br>* failures 5
<br>c
<br>c commands controlling output    =========
<br>c want to print line intensities are surface brightness, per arcsec^2
<br>print lines surface brightness arcsec
<br>print diffuse continuum 
<br>print line faint -1.5
<br>punch overview "dynamics_orion_flow.ovr" no hash
<br>punch hydrogen 21 cm "dynamics_orion_flow.21cm" no hash
<br>punch dr "dynamics_orion_flow.dr" no hash
<br>punch continuum last "dynamics_orion_flow.con" units microns no hash
<br>punch pressure "dynamics_orion_flow.pre" no hash
<br>punch heating "dynamics_orion_flow.het" no hash
<br>punch cooling "dynamics_orion_flow.col" no hash
<br>punch molecules "dynamics_orion_flow.mol" no hash
<br>punch wind "dynamics_orion_flow.wnd" last 
<br>c
<br>c dynamics_orion_flow.in
<br>c class dynamics hii pdr
<br>c ========================================
<br>c 
</kbd><p>
This is a model similar in spirit to the blister geometry H+ region
model computed by Baldwin et al. (1991), but with a D-critical flow.
Many physical processes have been disabled to make this simulationn faster.
Grain physics is not done so the gas temperature is incorrect.  The
main purpose is to do a quick test of the dynamical flow with grain
opacities included.  The slow directory contains a full simulation
of a flow like Orion.
</p><hr><h2><kbd>dynamics_veryfast.in  </kbd><I>very fast wind model
</I></h2><kbd><br>title very fast wind model
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>hden 9
<br>c this is a set of commands to speed up calc
<br>init file "fast.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop thickness 8.4
<br>c this is a subsonic wind with advection 
<br>wind velo -5 advection
<br>c
<br>c other commands for details     =========
<br>c absolutely no convergence problems should occur 
<br>failures 1
<br>c this degrades the continuum resolution by factor of 3, to
<br>c speed up calc 
<br>set continuum resolution 3
<br>iterate 4
<br>c
<br>c commands controlling output    =========
<br>punch pressure last "dynamics_veryfast.pre"
<br>punch total opacity last "dynamics_veryfast.opc"
<br>punch ionizing continuum last "dynamics_veryfast.ion"
<br>punch continuum last "dynamics_veryfast.con"
<br>punch dr "dynamics_veryfast.dr"
<br>c
<br>c 
<br>c dynamics_veryfast.in 
<br>c class dynamics  
<br>c ========================================
<br>c 
</kbd><p>
This is meant to be a very fast calculation to 
use when running extensive debug-enabled runtimes.
<p>
<p>
</p><hr><h2><kbd>dynamics_veryfast_rec.in  </kbd><I>very fast wind model
</I></h2><kbd><br>title very fast wind model
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>hden 9
<br>c this is a set of commands to speed up calc
<br>init file "fast.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop thickness 8.4
<br>c this is a subsonic wind with advection 
<br>wind velo 5 advection
<br>c
<br>c other commands for details     =========
<br>c absolutely no convergence problems should occur 
<br>failures 1
<br>c this degrades the continuum resolution by factor of 3, to
<br>c speed up calc 
<br>set continuum resolution 3
<br>iterate 4
<br>c
<br>c commands controlling output    =========
<br>punch pressure last "dynamics_veryfast_rec.pre"
<br>punch total opacity last "dynamics_veryfast_rec.opc"
<br>punch ionizing continuum last "dynamics_veryfast_rec.ion"
<br>punch continuum last "dynamics_veryfast_rec.con"
<br>punch dr "dynamics_veryfast_rec.dr"
<br>c
<br>c 
<br>c dynamics_veryfast_rec.in 
<br>c class dynamics  
<br>c ========================================
<br>c 
</kbd><p>
This is meant to be a very fast calculation to 
use when running extensive debug-enabled runtimes.
<p>
<p>
</p><hr><h2><kbd>dynamics_wind.in  </kbd><I>test of equations of motion in a very highly ionized wind
</I></h2><kbd><br>title test of equations of motion in a very highly ionized wind
<br>c 
<br>c test motion in electron scattering limit
<br>c radiative acceleration (e- only) is 9.54E-7 cm s^-2
<br>c terminal velocity (e- only) is 7.6 km s^-1 
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>luminosiy (total) 45
<br>c 
<br>c commands for density & abundances =========
<br>hden 4
<br>c this only includes H and He
<br>init file="hheonly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>radius (parsecs) 1
<br>stop thickness (parsecs) -1
<br>c a slow wind velocity, will assert velocity at outer radius
<br>wind velo 0.1 ball
<br>c
<br>c other commands for details     =========
<br>c this will speed things up a bit 
<br>no level2
<br>no radiation pressure
<br>constant temperature 8
<br>c
<br>c commands controlling output    =========
<br>punch pressure "dynamics_wind.pre"
<br>punch wind "dynamics_wind.wnd"
<br>punch dr "dynamics_wind.dr"
<br>c
<br>c dynamics_wind.in
<br>c class limit dynamics 
<br>c ========================================
<br>c 
</kbd><p>
This tests the radiative acceleration and terminal velocity of 
a wind in which only electron scattering is important.  The parameters
were chosen so that electron scattering is the dominant opacity source,
so that the equations can be solved both numerically (in the example)
and analytically (the expected solution given above).  In a realistic wind
the gas would be more neutral and line driving would dominate.  The force
multiplier, given in the punch wind output, is nearly unity as a result.
<p>
<br>Checks:
<br>-	The radiative acceleration is correct (e- 9.543910-7 cm s-2).
<br>-	The terminal velocity should be 7.57 km s-1.
<br>-	Force multiplier near unity (no line driving since so highly ionized).
<br>-	Thickness of cloud correct (R-Ro + dr/2 should be 3.086391017 cm).
<p>
</p><hr><h2><kbd>feii_hin.in  </kbd><I>test feii in high density limit
</I></h2><kbd><br>title test feii in high density limit
<br>c
<br>c commands controlling continuum =========
<br>black 25000 K
<br>ionization -10
<br>c
<br>c commands for density & abundances =========
<br>hden 18
<br>c force a high electron density to insure collisions dominate
<br>eden 18
<br>c
<br>c commands controlling geometry  =========
<br>constant tempera 4
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>atom feii
<br>iterate
<br>c want to test collision only limit 
<br>no induced processes
<br>c
<br>c commands controlling output    =========
<br>c
<br>c
<br>c feii_hin.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This checks that, at high particle densitites, in which
the gas should be in collisional
equilibrium, the level populations of the large model Fe+ ion
go to the proper values, where the departure coefficients
are all equal to unity.
<p>
<p>
</p><hr><h2><kbd>feii_hirad.in  </kbd><I>feii in case of high radiation density limit
</I></h2><kbd><br>title feii in case of high radiation density limit
<br>c
<br>c commands controlling continuum =========
<br>black 8000 K lte 
<br>c
<br>c commands for density & abundances =========
<br>hden 9
<br>element iron abundance 2
<br>c
<br>c commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>atom feii
<br>constant tempera 8000
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>punch feii relative populations range 0 200 "feii_hirad.lv1" last
<br>punch feii relative populations range 201 371 "feii_hirad.lv2" last
<br>c
<br>c
<br>c feii_hirad.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This checks that, at high radiation densitites, in which
the gas is irradiated by a blackbody in strict thermodynamic
equilibrium, the level populations of the large model Fe+ ion
go to the proper values, where the departure coefficients
are all equal to unity.
<p>
</p><hr><h2><kbd>feii_pump.in  </kbd><I>test feii in continuum pumped limit
</I></h2><kbd><br>title test feii in continuum pumped limit
<br>c
<br>c commands controlling continuum =========
<br>black 25000 K
<br>ionization -5
<br>c
<br>c commands for density & abundances =========
<br>hden 10
<br>abundances old solar 84 
<br>c commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>Case B
<br>iterate 
<br>constant tempera 4
<br>atom feii 
<br>c
<br>c commands controlling output    =========
<br>punch feii continuum "feii_pump.con"
<br>c
<br>c feii_pump.in
</kbd><p>
This is a constant temperature low ionization
cloud, with BLR-like densities, which includes the
large FeII atom.  The tests check on the emission
predicted in the Fe II bands.
<p>
This model tests the large FeII model in the optically thin,
continuum pumped limit.  The zone thickness is set to a
small value (1 cm) so that full continuum hits atom.
<p>
</p><hr><h2><kbd>feii_ste.in  </kbd><I>thermal equilibrium of FeII in STE limit
</I></h2><kbd><br>title thermal equilibrium of FeII in STE limit
<br>c
<br>c commands controlling continuum =========
<br>black 8000 K lte 
<br>hden 9
<br>c
<br>c commands for density & abundances =========
<br>element iron abundance 2
<br>c
<br>c commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>atom feii
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>punch feii continuum last "feii_ste.con"
<br>punch feii column density last "feii_ste.col"
<br>punch feii populations all last "feii_ste.pop"
<br>c
<br>c feii_ste.in
<br>c class function 
<br>c ========================================
<br>c 
</kbd><p>
This model has a very high iron abundance, 100x H, and most Fe is
in the form of Fe+. It is irradiated by a blackbody in strict
thermodynamic equilibrium.  We check that the temperature
of the gas is equal to the radiation temperature, to confirm
that the thermal properties of the model FeII atom obey thermodynamics.
 
</p><hr><h2><kbd>feii_t4.in  </kbd><I>FeII emission in typical intermediate density photoionzied cloud
</I></h2><kbd><br>title FeII emission in typical intermediate density photoionzied cloud
<br>c
<br>c commands controlling continuum =========
<br>black 5e5K
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>hden 8
<br>element iron abundance 2
<br>element iron ionization -2 0 -2
<br>c
<br>c commands controlling geometry  =========
<br>stop thickness 5
<br>c
<br>c other commands for details     =========
<br>constant temperature 4
<br>atom feii
<br>iterate 3
<br>c
<br>c commands controlling output    =========
<br>set line precision 6
<br>print lines column 
<br>print line inward
<br>print line sort wavelength
<br>print line faint 0
<br>punch feii continuum last "feii_t4.con" units angstroms
<br>punch feii inward continuum last "feii_t4.cin" units angstroms
<br>punch feii outward continuum last "feii_t4.cout" units angstroms
<br>punch feii column density last "feii_t4.col" 
<br>punch feii populations all last "feii_t4.pop"
<br>punch line emissivity "feii_t4.ems"
<br>Fe2b 2797 
<br>Inwd 2797 
<br>end of lines
<br>c
<br>c feii_t4.in
<br>c class function 
<br>c ========================================
<br>c 
</kbd><p>
This model has a very high iron abundance, 100x H, and most Fe is
in the form of Fe+. it has intermediate density and should produce
and FeII spectrum something like an AGN.
 
The set line precision 6 increases the number of significant figures
in the wavelengths for each line.  This is needed to get the right
FeII inward band.
</p><hr><h2><kbd>func_abund_fluc.in  </kbd><I>check fluctuating heavy-element abundances 
</I></h2><kbd><br>title check fluctuating heavy-element abundances 
<br>c commands controlling continuum =========
<br>blackbody 5
<br>ionization -2
<br>c 
<br>c commands for density & abundances =========
<br>hden 3
<br>c this varies the abundnaces between default and 1e-4 times default,
<br>c over a 1e10 cm period - we will compute half a cycle
<br>fluctuatsion abundances 10.3 0 -4
<br>c 
<br>c commands controlling geometry  =========
<br>c stop at half a cycle so pick off lowest abundances
<br>stop thickness 10
<br>c 
<br>c other commands for details     =========
<br>c speed things up a bit
<br>init "c84.ini"
<br>c
<br>c commands controlling output    =========
<br>print column density
<br>punch overview "func_abund_fluc.ovr"
<br>punch abundances "func_abund_fluc.abn"
<br>c
<br>c commands giving asserts
<br>c
<br>c func_abund_fluc.in
<br>c class function 
<br>c ========================================
<br>c 
</kbd><p>
This checks that the variable abundances option works
<p>
</p><hr><h2><kbd>func_distance.in  </kbd><I>check that distance and "print flux earth" commands work 
</I></h2><kbd><br>title check that distance and "print flux earth" commands work 
<br>c
<br>c commands controlling continuum =========
<br>c luminosity in ionizing radiation, this and distance
<br>c were chosen so that flux at earth assocated with total
<br>c luminoisity of object is 1 erg cm-2 s-1 
<br>luminosity 40
<br>laser 2
<br>c
<br>c commands for density & abundances =========
<br>hden 4
<br>init file "honly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>radius 17
<br>c
<br>c other commands for details     =========
<br>distance 19.450395
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>c give flux at Earth
<br>print lines, flux at Earth
<br>c
<br>c func_distance.in 
<br>c class function 
<br>c ========================================
<br>c 
</kbd><p>
Normally the code predicts the intensity or luminosity of
the emission lines.  This test confirms that it can predict
the flux recieved at the Earth instead.  The model is the simplest
and fastest that can be computed - a H-only constant temperature
single zone.  The total luminosity is set to 1e40 erg/s, and the
ionization source is a laser at 2 ryd.  With these set, the
total luminosity in ionizing radiation, the total luminoisity in
the incident continuum (the emission line labeled "Inci 0") will be 1e40.
<p>
The code will predict the flux at the Earth if both the distance to the
oject is specified with the distance command, and this is requested with
the print flux earth command.  The distance was chosen so that the
total flux at the Earth will be 1 erg/s.  This is asserted at the
end of the calculation.
<p>
</p><hr><h2><kbd>func_dlaw.in  </kbd><I>test model with dlaw table
</I></h2><kbd><br>title test model with dlaw table
<br>c
<br>c commands controlling continuum =========
<br>phi(H) 15
<br>table agn
<br>c
<br>c commands for density & abundances =========
<br>dlaw table radius
<br>continue 16 9
<br>continue 17 7
<br>continue 18 5
<br>continue 19 3
<br>continue 20 1
<br>continue 21 -1
<br>end of dlaw
<br>init "honly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>sphere
<br>filling factor -5
<br>radius 17 20
<br>c
<br>c other commands for details     =========
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>punch dr "func_dlaw.dr"
<br>punch overveiw "func_dlaw.ovr"
<br>c
<br>c
<br>c func_dlaw.in
<br>c class function 
<br>c ========================================
<br>c 
</kbd><p>
this model tests the dlaw density table command 
<p>
<p>
<p>
</p><hr><h2><kbd>func_fulltrace.in  </kbd><I>test full trace output
</I></h2><kbd><br>title test full trace output
<br>c
<br>c commands controlling continuum =========
<br>trace h-like hydrogen full no print
<br>stop zone 1
<br>table agn
<br>ionization parameter -0.5
<br>c
<br>c commands for density & abundances =========
<br>hden 9.5
<br>init file="honly.ini"
<br>c
<br>c other commands for details     =========
<br>atom h-like element hydrogen collapsed levels 1 
<br>c
<br>c commands controlling output    =========
<br>c func_fulltrace.in
<br>c class function 
<br>c ========================================
</kbd><p>
this checks that trace output functions correctly
</p><hr><h2><kbd>func_globule.in  </kbd><I>test of globule command
</I></h2><kbd><br>title test of globule command
<br>c
<br>c commands controlling continuum =========
<br>black 40000 K
<br>ionization parameter -1.5
<br>c
<br>c commands for density & abundances =========
<br>globule initial density=5 scale depth=14 
<br>init file "ism.ini"
<br>abundances hii region no qheat 
<br>c
<br>c commands controlling geometry  =========
<br>c
<br>c other commands for details     =========
<br>failures 2
<br>no diffuse line pumping
<br>c
<br>c commands controlling output    =========
<br>print line faint -1.5
<br>punch overview last "func_globule.ovr"
<br>punch results last "func_globule.rlt"
<br>punch dr "func_globule.dr" last
<br>punch heating "func_globule.het" last
<br>punch cooling "func_globule.col" last
<br>c
<br>c func_globule.in
<br>c class function 
<br>c ========================================
<br>c 
</kbd><p>
<p>
This model uses the globule command, tests that the zoning logic
works for this extreme case, and that the code is able to converge
the globule model.
<p>
</p><hr><h2><kbd>func_grid_line_ratios.in  </kbd><I>test generating line ratios in a grid run
</I></h2><kbd><br>title test generating line ratios in a grid run
<br>c 
<br>c commands controlling continuum =====
<br>blackbody 40,000K
<br>ionization parameter -2
<br>c 
<br>c commands for density & abundances =====
<br>c these are to speed up the calculation, only do H, O, and Ne
<br>init "honly.ini"
<br>element oxygen on  
<br>element neon on  
<br>element sulphur on  
<br>element oxygen ionization 1 1 1 0.01   
<br>element neon ionization 1 1 1 0.01   
<br>element sulphur ionization 1 1 1 0.01   
<br>c vary the hydrogen density
<br>hden 4 vary
<br>grid 2 6.1 1 
<br>c 
<br>c other commands for details =======
<br>c these are constant temperature models, vary T
<br>constant temperature 4 vary
<br>grid 4000 17000 3000
<br>stop zone 1 
<br>c
<br>c commands controlling output =====
<br>punch line list "func_grid_line_ratios.pun" "func_grid_line_ratios.dat" ratio no hash
<br>punch grid "func_grid_line_ratios.grd"
<br>c
<br>c commands giving (lack of) assert ==========
<br>c
<br>c func_grid_line_line_ratios.in
<br>c class function
<br>c ===================================================
</kbd><p>
This uses the grid command to compute line ratios for a wide range of
density and temperature.  The ionization is set to a uniform value and
only a few elements are included.  this makes the calculation faster
and prevents recombination [O III] 4363 from becoming important (there
is no O+3).
<p>
These are the line ratios mentioned as limits in the Johnstone et al.
Spitzer cooling flow filament paper (2007).
</p><hr><h2><kbd>func_hotgas_coolstar.in  </kbd><I>test very soft continuum, very hot gas
</I></h2><kbd><br>title test very soft continuum, very hot gas
<br>c
<br>c commands controlling continuum =========
<br>c put in the cosmic background as the only continuum source 
<br>CMB  
<br>c gas has constant temperature of 1e6 K
<br>constant temperature, t=6
<br>c
<br>c commands for density & abundances =========
<br>hden 10.
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>c specify a thin cell of gas - 1 cm thick
<br>set dr 0 
<br>c
<br>c other commands for details     =========
<br>c iterate since gas is optically thin
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>c
<br>c func_hotgas_coolstar.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This is a test where the CMB is the only continuum source.
It does not extend to energies where the
code needs to work.  There are special cases 
used in this situation, for continuum addressing,
so this checks whether those still function.
</p><hr><h2><kbd>func_ion_increase.in  </kbd><I>test model where ionization increases with depth
</I></h2><kbd><br>title test model where ionization increases with depth
<br>c
<br>c commands controlling continuum =========
<br>ionization parameter -4
<br>table agn
<br>c
<br>c commands for density & abundances =========
<br>hden 7 -4
<br>init "hheonly.ini"
<br>element oxygen on  
<br>element iron on  
<br>c
<br>c commands controlling geometry  =========
<br>sphere
<br>filling factor -5
<br>radius 17 20
<br>c
<br>c other commands for details     =========
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>punch dr "func_ion_increase.dr"
<br>punch overveiw "func_ion_increase.ovr"
<br>punch element oxygen "func_ion_increase.oxy"
<br>punch element iron "func_ion_increase.fe"
<br>c
<br>c
<br>c func_ion_increase.in
<br>c class function 
<br>c ========================================
<br>c 
</kbd><p>
This density falls off faster than 1/r^2 so the ionization increases
with depth.  Most sims have decreasing rather than increasing ionization.
<p>
<p>
<p>
</p><hr><h2><kbd>func_lines.in  </kbd><I>create output file with list of func_lines
</I></h2><kbd><br>title create output file with list of func_lines
<br>atom h2 levels large 
<br>atom feii 
<br>test
<br>c
<br>c commands controlling continuum =========
<br>c commands for density & abundances =========
<br>c commands controlling geometry  =========
<br>c other commands for details     =========
<br>c
<br>c commands controlling output    =========
<br>c this creates the file "func_lines.lab that contains a list
<br>c of all emission labels
<br>punch line labels "func_lines.lab"
<br>c this creates the file "func_lines.lis" that contains a list
<br>c of the emission func_lines that are transported. 
<br>punch line data "func_lines.lis"
<br>c 
<br>c There is nothing extra to assert, since test does include many asserts
<br>c 
<br>c func_lines.in
<br>c class function 
<br>c ========================================
<br>c 
</kbd><p>
This runs the standard "test" case, and then creates
the line data and labels files.	 Test by itself includes
many asserts, so no further asserts are needed here.
<p>
The file func_lines.lab is a useful list of all lines predicted by the code.
Cut and paste this into other places when you need to find a particular
emission line.
<p>
The func_lines lines.dat gives atomic data for all the lines, and their
critical density at 10000 K.
The large H2 and Fe II model atoms are turned on to include their lines. 
<p>
</p><hr><h2><kbd>func_map.in  </kbd><I>map of heating vs cooling
</I></h2><kbd><br>title map of heating vs cooling
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>ionization parameter -2.5
<br>c
<br>c commands for density & abundances =========
<br>hden 0
<br>abundances old solar 84 
<br>c
<br>c commands controlling geometry  =========
<br>set dr 0
<br>stop lyman optical depth -7
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>c
<br>c commands controlling output    =========
<br>c save map information to generate plot for hazy
<br>punch map file="func_map.dta"
<br>set nmaps 100
<br>c
<br>c map.in
<br>c class function 
<br>c ========================================
<br>c 
</kbd><p>
This is a test of the continuity of the code over a very large range
of temperature. It was used to produce one of the thermal maps shown in Hazy.
<p>
<br>Checks:
<br>-	No breaks in the heating and cooling curves where
	various approximations change.
<p>
</p><hr><h2><kbd>func_sdrmin.in  </kbd><I>test set drmin command
</I></h2><kbd><br>title test set drmin command
<br>c
<br>c commands controlling continuum =========
<br>blackbody 8e4
<br>luminosity 37.5
<br>c
<br>c commands for density & abundances =========
<br>hden 4
<br>c
<br>c commands controlling geometry  =========
<br>radius 17
<br>sphere
<br>stop thickness 17.03
<br>stop temperature off
<br>c
<br>c other commands for details     =========
<br>set drmin 15.5
<br>cosmic rays background
<br>c
<br>c commands controlling output    =========
<br>punch dr "func_sdrmin.dr" last
<br>c
</kbd><p>
This simulation tests the SET DRMIN command. It is a toy model of a planetary
nebula that is designed to extend into the PDR. The minimum stepsize is
deliberately set much too large so that we would immediately notice if the
command was broken. It also tests if we still hit the correct outer radius
when SET DRMIN is used. Without the SET DRMIN command this sim would need
410 zones (trunk@2760).
</p><hr><h2><kbd>func_set_ion.in  </kbd><I>test impact of setting ionization 
</I></h2><kbd><br>title test impact of setting ionization 
<br>c
<br>c commands for density & abundances =========
<br>init "ism.ini" 
<br>hden 0 
<br>element hydrogen ionization 0 1 
<br>element helium ionization 0 1 0 
<br>element carbon ionization 0 1 
<br>element oxygen ionization 0 0.1 0.2 0.3 0.2 0.1 0.1  
<br>c
<br>c commands controlling continuum =========
<br>blackbody 5
<br>ionization parameter -2
<br>c
<br>c commands controlling geometry  =========
<br>c force model to be 1 cm thick
<br>set dr 0 
<br>c
<br>c other commands for details     =========
<br>constant temperature 4
<br>stop zone 1
<br>c
<br>c commands controlling output    =========
<br>normalize to "O  3" 5007 
<br>punch dr "func_set_ion.dr" 
<br>c
<br>c 
<br>c func_set_ion.in
</kbd><p>
c class function 
c ========================================
c 
 
this script exercies the option to specify the ionization of a species
</p><hr><h2><kbd>func_stopline1.in  </kbd><I>test stop line command
</I></h2><kbd><br>title test stop line command
<br>c
<br>c commands controlling continuum =========
<br>ionization parameter -2
<br>blackbody 50000
<br>c
<br>c commands for density & abundances =========
<br>hden 2
<br>abundances old solar 84 
<br>init file "ism.ini"
<br>c test option to turn off elements with small abundances
<br>element limit off -5
<br>c
<br>c commands controlling geometry  =========
<br>c stop calc at line ratio, the point of this test 
<br>stop line "C  2" 157.6m reaches 0.0358 
<br>c
<br>c other commands for details     =========
<br>constant temperature 10000 K
<br>c
<br>c commands controlling output    =========
<br>punch dr "func_stopline1.dr" last
<br>c
<br>c func_stopline1.in
<br>c class function 
<br>c ========================================
<br>c 
</kbd><p>
This is an example of a simple calculation that stops when
a line reaches a specified intensity.
The option to turn off elements with trivial abundances is used.
</p><hr><h2><kbd>func_stopline2.in  </kbd><I>test stop line command
</I></h2><kbd><br>title test stop line command
<br>c
<br>c commands controlling continuum =========
<br>ionization parameter -2
<br>blackbody 50000
<br>c
<br>c commands for density & abundances =========
<br>hden 2
<br>abundances old solar 84 
<br>init file "ism.ini"
<br>c
<br>c commands controlling geometry  =========
<br>c stop calc at line ratio, the point of this test 
<br>stop line "C  2" 157.6m reaches 0.002 relative to "o  3" 5007 A
<br>c
<br>c other commands for details     =========
<br>constant temperature 10000 K
<br>c
<br>c commands controlling output    =========
<br>normalise to "o  3" 5007 
<br>punch dr "func_stopline2.dr" last
<br>c
<br>c func_stopline2.in
<br>c class function 
<br>c ========================================
<br>c 
</kbd><p>
this is an example of a simple calculation that stops when
a certain emission line ratio is reached
<p>
</p><hr><h2><kbd>func_t10.in  </kbd><I>test very soft continuum, very hot gas
</I></h2><kbd><br>title test very soft continuum, very hot gas
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>ionization parameters -2
<br>c
<br>c commands for density & abundances =========
<br>hden 1.
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>c specify a thin cell of gas - 1 cm thick
<br>set dr 0 
<br>c
<br>c other commands for details     =========
<br>c set constant temperature to high-T limit
<br>constant temperature, t=10 log 
<br>c iterate since gas is optically thin
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>c
<br>c 
<br>c func_t10.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This is a test of the highest temperature the code can do.
<p>
</p><hr><h2><kbd>func_t3.in  </kbd><I>test low temperature limit of code, 3K
</I></h2><kbd><br>title test low temperature limit of code, 3K
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>ionization parameters -2
<br>c
<br>c commands for density & abundances =========
<br>hden -1
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>c specify a thin cell of gas 1 cm thick
<br>set dr 0 
<br>c
<br>c other commands for details     =========
<br>c set constant temperature to low-T limit
<br>constant temperature, t=3.0 linear 
<br>c iterate since gas is optically thin
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>c
<br>c
<br>c 
<br>c func_t3.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This is a test of the lowest temperature the code can do.
It runs a constant temperature of 3K
<p>
</p><hr><h2><kbd>func_test.in  </kbd><I>run smoke test
</I></h2><kbd><br>title run smoke test
<br>c commands controlling continuum =========
<br>test
<br>c commands for density & abundances =========
<br>c commands controlling geometry  =========
<br>c other commands for details     =========
<br>c include this in one test to make sure it works
<br>set continuum shield ferland
<br>c
<br>c commands controlling output    =========
<br>c increase precision of all printed wavelengths
<br>set line precision 6 
<br>c following will print physical constants used by the code
<br>print constants
<br>c print the past to the data directory
<br>print path 
<br>c the citation for the current version of the code
<br>print citation
<br>c following prints column densities 
<br>print column density
<br>punch overview "func_test.ovr"
<br>c func_test.in
<br>c class function 
<br>c ========================================
<br>c 
</kbd><p>
This runs the smoke test command, which include several asserts.
The tests the behavior of increasing the number of significant figures
in printed wavelengths.  
<p>
</p><hr><h2><kbd>func_testmole.in  </kbd><I>this runs the standard, one command, test, which contains many asserts
</I></h2><kbd><br>title this runs the standard, one command, test, which contains many asserts
<br>c commands controlling continuum =========
<br>test mole 
<br>c 
<br>c commands for density & abundances =========
<br>c commands controlling geometry  =========
<br>c other commands for details     =========
<br>c
<br>c commands controlling output    =========
<br>punch overview "func_testmole.ovr"
<br>c func_testmole.in
<br>c class function 
<br>c ========================================
<br>c 
</kbd><p>
This runs the "test mole" command, which include several asserts.
<p>
</p><hr><h2><kbd>func_trans_punch.in  </kbd><I>first of func_trans_punch/transread pair, punch continuum
</I></h2><kbd><br>title first of func_trans_punch/transread pair, punch continuum
<br>c
<br>c commands controlling continuum =========
<br>ionization parameter -1
<br>table agn
<br>c
<br>c commands for density & abundances =========
<br>hden 10
<br>c
<br>c commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>print incident continuum 
<br>punch ionization last "func_trans_punch.ion"
<br>punch continuum last "func_trans_punch.con"
<br>c this continuum will be used by transread.in 
<br>punch last transmitted continuum "func_trans_punch.trn"
<br>c
<br>c this contains a large number of asserts that both tests use
<br>init file "trans.dat"
<br>c 
<br>c func_trans_punch.in 
<br>c class function 
<br>c ========================================
<br>c 
</kbd><p>
func_trans_punch.in and transread.in are a pair of
tests that check that the code can punch a transmitted
continuum then read it.
<p>
This sim must come before func_trans_read since it
generates the punch file needed by func_trans_read.
Alphabetical order insures this.
</p><hr><h2><kbd>func_trans_read.in  </kbd><I>second of transpunch/transread pair, used transmitted continuum
</I></h2><kbd><br>title second of transpunch/transread pair, used transmitted continuum
<br>c the transmitted continuum produced by func_trans_punch
<br>c
<br>c commands controlling continuum =========
<br>ionization parameter -1
<br>table read "func_trans_punch.trn"
<br>brems 6
<br>ionization parameter -6
<br>c
<br>c commands for density & abundances =========
<br>hden 10
<br>c
<br>c commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>c this contains a large number of asserts used by both commands
<br>init file "trans.dat"
<br>print incident continuum 
<br>punch ionization last "func_trans_read.ion"
<br>c
<br>c 
<br>c func_trans_read.in
<br>c class function 
<br>c ========================================
<br>c 
</kbd><p>
func_trans_punch.in and func_trans_read.in are a pair of
tests that check that the code can punch a transmitted
continuum then read it.
<p>
</p><hr><h2><kbd>grains_conserve_pp.in  </kbd><I>test energy conservation with vastly optically thick dust
</I></h2><kbd><br>title test energy conservation with vastly optically thick dust
<br>c
<br>c commands controlling continuum =========
<br>black 500 STE
<br>c
<br>c commands for density & abundances =========
<br>init "honly.ini"
<br>hden 0
<br>grains ism single graphite 
<br>c
<br>c commands controlling geometry  =========
<br>stop Av 1000
<br>sphere 
<br>stop temperature 100K
<br>c
<br>c other commands for details     =========
<br>iterate
<br>constant temper 500 K
<br>no grain gas collisional energy exchange
<br>no molecules 
<br>cosmic rays background 
<br>c
<br>c commands controlling output    =========
<br>punch grain temperature "grains_conserve_pp.grntem"
<br>punch continuum units microns "grains_conserve_pp.con"
<br>c
<br>c
<br>c grains_conserve_pp.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This tests that multiple absorption / reemission by dust conserves energy
Energy density and grain temperatures should be exactly 500 K
<p>
</p><hr><h2><kbd>grains_conserve_sp.in  </kbd><I>test energy conservation with vastly optically thick dust, sphere geometry
</I></h2><kbd><br>title test energy conservation with vastly optically thick dust, sphere geometry
<br>c
<br>c commands controlling continuum =========
<br>black 500 STE
<br>c
<br>c commands for density & abundances =========
<br>init "honly.ini"
<br>hden 3.25 -2
<br>grains ism single graphite 
<br>c
<br>c commands controlling geometry  =========
<br>radius from 21 to 26
<br>* stop Av 1000
<br>sphere 
<br>stop temperature 100K
<br>c
<br>c other commands for details     =========
<br>iterate
<br>constant temper 500 K
<br>no grain gas collisional energy exchange
<br>no grain electrons 
<br>no molecules 
<br>cosmic rays background  -10
<br>c
<br>c commands controlling output    =========
<br>punch grain temperature "grains_conserve_sp.grntem"
<br>punch continuum units microns "grains_conserve_sp.con"
<br>c
<br>c
<br>c grains_conserve_sp.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This tests that multiple absorption / reemission by dust conserves energy
in a spherical geometry.
Radiation density temperature in last zone should be 500 * sqrt(1e21/1e26) = 1.5811 K
<p>
<p>
</p><hr><h2><kbd>grains_hot.in  </kbd><I>test temperature of gas and dust in high energy density environment
</I></h2><kbd><br>title test temperature of gas and dust in high energy density environment
<br>c
<br>c commands controlling continuum =========
<br>table power law 
<br>c intensity of incident radiation field set by its energy density
<br>energy density temp 550 K
<br>c
<br>c commands for density & abundances =========
<br>hden 5.0
<br>init "ism.ini"
<br>c Orion grains and abundances
<br>abundances orion 
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set drmax 10
<br>c
<br>c other commands for details     =========
<br>c
<br>c commands controlling output    =========
<br>normalize to "O  8" 18.97A
<br>punch overview "grains_hot.ovr" last 
<br>c
<br>c
<br>c grains_hot.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This tests the grains in an extreme condition - irradiation by an AGN
near the illuminated face of the molecular torus.  The gas is 
predominantly heated by the grain electron photo-ejection.
</p><hr><h2><kbd>grains_hot_wd01.in  </kbd><I>test temperature of gas and dust in high energy density environment
</I></h2><kbd><br>title test temperature of gas and dust in high energy density environment
<br>c
<br>c commands controlling continuum =========
<br>table power law 
<br>energy density temp 550
<br>c
<br>c commands for density & abundances =========
<br>hden 5.0
<br>init "ism.ini"
<br>abundances orion no grains 
<br>grains orion no qheat 
<br>c
<br>c revert to WD01 treatment
<br>no grain x-ray treatment
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set drmax 10
<br>c
<br>c other commands for details     =========
<br>c
<br>c commands controlling output    =========
<br>normalize to "O  8" 18.97A
<br>punch overview "grains_hot_wd01.ovr" last 
<br>c
<br>c
<br>c grains_hot_wd01.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This tests the grains in an extreme condition - irradiation by an AGN
near the illuminated face of the molecular torus.  The gas is 
predominantly heated by the grains. The grain treatment has been
reverted to Weingartner & Draine, 2001, which is NOT appropriate
for these conditions. It is however a good test whether the old
treatment is not broken....
</p><hr><h2><kbd>grains_lte.in  </kbd><I>check that grains equilibriate at correct temp in ste limit
</I></h2><kbd><br>title check that grains equilibriate at correct temp in ste limit
<br>c this also tests that the code works when H He ionization is ZERO
<br>c
<br>c commands controlling continuum =========
<br>black 3 lte
<br>c
<br>c commands for density & abundances =========
<br>hden 5
<br>eden 5
<br>init file "hheonly.ini"
<br>c need to normalize to some line, oxygen will provide some 
<br>element oxygen on 
<br>c ism grains with high dust to gas ratio
<br>grain abund 1
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0 
<br>c
<br>c other commands for details     =========
<br>iterate
<br>c the equilibrium temp would not be correct since small H_2 molecule
<br>c does not go to ste, being an equivalent two-level system
<br>constant temperature 3
<br>c
<br>c commands controlling output    =========
<br>normalize to "O  1" 63.17m
<br>punch heating last "grains_lte.het"
<br>punch cooling last "grains_lte.col"
<br>c
<br>c grains_lte.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This test irradiates a set of grains with a true blackbody in
strict thermodynamic equilibrium.  We expect the grains
(and everything else) to equilibriate at the blackbody temperature.
The gas temperature is forced to the radiation temperature because
the current molecule network (based on ISM approximations) does not
go to LTE in the high-radiation density limit.  The calculation
asserts that all grain temperatures are very close to the radiation
temperature.
<p>
<p>
<p>
</p><hr><h2><kbd>grains_qheat.in  </kbd><I>cool atomic ISM with Si grain quantum heating
</I></h2><kbd><br>title cool atomic ISM with Si grain quantum heating
<br>c
<br>c commands controlling continuum =========
<br>table draine
<br>extinguish 20
<br>c
<br>c commands for density & abundances =========
<br>hden 0
<br>c turns on grains with default abundance (log abundance ratio to ism = 0)
<br>c and with quantum heating enabled by default
<br>c (disabled with "no grains qheat" option)
<br>grains 0. "silicate_ism_10.opc"
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>cosmic rays background
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>normalize to "C  2" 157.6m 
<br>print diffuse continuum
<br>print line faint -2
<br>print line column
<br>punch grains temperature last "grains_qheat.qht"
<br>punch continuum  "grains_qheat.con" units microns last
<br>punch two photon continuum "grains_qheat.2nu" units microns
<br>c
<br>c
<br>c grains_qheat.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This sim produces dust emission with a Wein trail that is
dominated by quantum heating emission.
<p>
</p><hr><h2><kbd>grains_temp.in  </kbd><I>test all grain species temperature
</I></h2><kbd><br>title test all grain species temperature
<br>c
<br>c commands controlling continuum =========
<br>black 50000
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>hden 3
<br>grains_temp "graphite_ism_01.opc"
<br>grains_temp "silicate_ism_01.opc"
<br>grains_temp "graphite_orion_01.opc"
<br>grains_temp "silicate_orion_01.opc"
<br>grains_temp "silicate_0m010.opc"
<br>grains_temp "silicate_0m100.opc"
<br>grains_temp "grey_ism_01.opc"
<br>grains_temp "silicate_1m000.opc"
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>iterate
<br>constant temper 4
<br>c
<br>c commands controlling output    =========
<br>c
<br>c
<br>c grains_temp.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This turns on all the grain species that are included in the distribution.
A model of an ionized layer is
done and the monitors confirm the resulting grain temperatures.
<p>
<p>
</p><hr><h2><kbd>grains_temp_all.in  </kbd><I>test all grain species temperature
</I></h2><kbd><br>title test all grain species temperature
<br>c
<br>c commands controlling continuum =========
<br>black 50000
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>hden 3
<br>c this turns on orion-style distributed grains
<br>grains orion
<br>c this turns on ism distributed grains
<br>grains ism
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>constant temper 4
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>punch dr "grains_temp_all.dr" last 
<br>punch grain charge "grains_temp_all.grnchr" last 
<br>punch grain temperature "grains_temp_all.grntem" last 
<br>punch grain drift velocity "grains_temp_all.grndft" last 
<br>c
</kbd><p>
	
c grains_temp_all.in
c class limit 
c ========================================
c 
<p>
This is a relatively quick test of grains.  
The Orion and ISM silicate and graphitic grains
are turned on and their equilibrium temperature
checked. 
</p><hr><h2><kbd>h2_cr.in  </kbd><I>H2 with background cosmic ray ionization
</I></h2><kbd><br>title H2 with background cosmic ray ionization
<br>c
<br>c commands controlling continuum =========
<br>c this is hot star SED
<br>black 30000
<br>intensity  -5. range  0.4412 to 1 Ryd
<br>c this will remove all ionizing radiation
<br>extinguish 24 0
<br>c background CR ionization rate of 2.5e-17 s^-1,
<br>cosmic rays, background
<br>c
<br>c commands for density & abundances =========
<br>hden 5
<br>c
<br>c commands controlling geometry  =========
<br>set dr 0 
<br>stop zone 5 
<br>stop temperature 400 
<br>c
<br>c other commands for details     =========
<br>c failures should not occur
<br>failures 1 
<br>atom h2 
<br>iterate
<br>c want clean test of CR physics so set constant kinetic temperature
<br>constant temperature 500K
<br>c must turn off line photoexcitation and Solomon process
<br>c since we want to test cr heating and ionization
<br>no induced processes
<br>c
<br>c commands controlling output    =========
<br>print column density 
<br>print ages
<br>punch overview "h2_cr.ovr" last
<br>punch h2 lines "h2_cr.lin" last all 
<br>punch h2 rates "h2_cr.rat" last
<br>punch h2 column density "h2_cr.col" last
<br>c
<br>c 
<br>c h2_cr.in
<br>c class limit  
<br>c ========================================
<br>c 
</kbd><p>
This test conditions of cosmic ray ionization.  
Solar abundances with no dust are assumed so this involves
gas-phase chemistry alone.
The Solomon process is disabled with the "no induced processes' command
so H2 is mainly dissociated by cosmic rays.
This forms a pair with h2_cr_grains, which does include grains.
<p>
</p><hr><h2><kbd>h2_cr_grains.in  </kbd><I>background cosmic ray ionization by suprathermal electrons only
</I></h2><kbd><br>title background cosmic ray ionization by suprathermal electrons only
<br>c
<br>c commands controlling continuum =========
<br>c this is hot star continuum
<br>black 30000
<br>intensity  -5. range  0.4412 to 1 Ryd
<br>c this will remove all ionizing radiation
<br>extinguish 24 0
<br>c background CR ionization rate should be 2.5e-17 s^-1,
<br>c Tielens & Hollenbach 1985; McKee AstroPH 9901370
<br>cosmic rays, background
<br>c
<br>c commands for density & abundances =========
<br>abundances ism 
<br>hden 5
<br>c
<br>c commands controlling geometry  =========
<br>set dr 0 
<br>stop zone 5 
<br>stop temperature 400 
<br>c
<br>c other commands for details     =========
<br>set h2 grain formation thermal pump 
<br>atom h2 
<br>iterate
<br>constant temperature 500K
<br>c must turn off line photoexcitation
<br>c since we want to test cr heating and ionization
<br>no induced processes
<br>c
<br>c commands controlling output    =========
<br>normalize to "H2  " 2.121m
<br>print column density 
<br>print ages
<br>punch overview "h2_cr_grains.ovr" last
<br>punch h2 lines "h2_cr_grains.lin" last all 
<br>punch h2 rates "h2_cr_grains.rat" last
<br>punch h2 column density "h2_cr_grains.col" last
<br>punch grains H2rates "h2_cr_grains.h2r" last
<br>c
<br>c h2_cr_grains.in
<br>c class limit  
<br>c ========================================
<br>c 
</kbd><p>
This tests conditions of cosmic ray ionization and grain formation pumping.
Solomon process is turned off with the "no induced processes" command
so cosmic rays are the main dissociation process.
This forms a pair with h2_cr which does not include grains, so relies
only on gas-phase chemistry.
</p><hr><h2><kbd>h2_hminus.in  </kbd><I>H2 populations in H- dominated limit
</I></h2><kbd><br>title H2 populations in H- dominated limit
<br>c this is one of a pair with h2_solomon.in 
<br>c
<br>c commands controlling continuum =========
<br>c this is hot star continuum
<br>black 30000
<br>intensity  -5. range  0.4412 to 1 Ryd
<br>c this will remove all ionizing radiation
<br>extinguish 24 0
<br>c background CR ionization rate should be 2.5e-17 s^-1,
<br>c Tielens & Hollenbach 1985; McKee AstroPH 9901370
<br>cosmic rays, background
<br>c
<br>c commands for density & abundances =========
<br>c no grains in this sim so H2 forms by H- route
<br>abundances ism no grains 
<br>hden 5
<br>c
<br>c commands controlling geometry  =========
<br>set dr 0 
<br>stop zone 5 
<br>stop temperature 400 
<br>c
<br>c other commands for details     =========
<br>c default is Takahashi 2001 - test thermal distribution here
<br>set h2 grain formation thermal pump 
<br>atom h2 
<br>iterate
<br>constant temperature 500K
<br>c
<br>c commands controlling output    =========
<br>print column density 
<br>print ages
<br>punch overview "h2_hminus.ovr" last
<br>punch h2 lines "h2_hminus.lin" last all 
<br>punch h2 rates "h2_hminus.rat" last
<br>punch h2 column density "h2_hminus.col" last
<br>c
<br>c h2_hminus.in
<br>c class limit  
<br>c ========================================
<br>c 
</kbd><p>
This tests large H2 model in limit of H- formation and Solomon destruction.
<p>
</p><hr><h2><kbd>h2_pdr_leiden_f1.in  </kbd><I>low density and flux model 1 
</I></h2><kbd><br>title low density and flux model 1 
<br>atom H2 He collisions new 
<br>c
<br>c commands controlling continuum =========
<br>c Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br>c the requested value, so the actual value
<br>c they want for the model is actually twice the value below
<br>table draine 5
<br>c this is to insure that no H-ionizing radiation strikes the cloud
<br>extinguish 24 
<br>c
<br>c commands for density & abundances =========
<br>c  hydrogen density 
<br>hden 3.
<br>grains ism 1.16 no qheat
<br>c
<br>c commands controlling geometry  =========
<br>c
<br>c other commands for details     =========
<br>c turn on the large H2 model
<br>atom h2 
<br>c turn down the number of convergence failures - there should be none
<br>failures 3
<br>c use leiden initialization file
<br>init file="pdr_leiden.ini"
<br>c This command defines the grain temperature to be a constant 20 Kelvin
<br>constant grain temperature 20 
<br>c This sets the gas kinetic temperature to a constant 50 Kelvin
<br>constant temperature 50 linear
<br>c
<br>c commands controlling output    =========
<br>c default normalization line is Hbeta, which is not produced by this gas
<br>normalize to "C  2" 157.6m
<br>print line faint -4 
<br>punch overview "h2_pdr_leiden_f1.ovr"
<br>punch line emissivity "h2_pdr_leiden_f1.ems" 
<br>H2   2.121m
<br>12CO 647.2m
<br>C  2 157.6m
<br>O  1 63.17m
<br>Si 2 34.81m
<br>end of lines
<br>punch leiden lines "h2_pdr_leiden_f1.lin"
<br>punch leiden "h2_pdr_leiden_f1.lei"
<br>punch dr "h2_pdr_leiden_f1.dr" 
<br>punch molecules "h2_pdr_leiden_f1.mol"
<br>punch grain physical conditions "h2_pdr_leiden_f1.grn"
<br>punch overview "h2_pdr_leiden_f1.ovr"
<br>punch H2 lines "h2_pdr_leiden_f1.h2lin" all
<br>punch H2 column density "h2_pdr_leiden_f1.h2col"
<br>punch H2 populations matrix zone "h2_pdr_leiden_f1.pop"
<br>punch H2 rates "h2_pdr_leiden_f1.rat"
<br>c
<br>c
<br>c h2_pdr_leiden_f1.in
<br>c class pdr  
<br>c ========================================
<br>c 
</kbd><p>
This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
</p><hr><h2><kbd>h2_solomon.in  </kbd><I>H2 populations in solomon dominated limit
</I></h2><kbd><br>title H2 populations in solomon dominated limit
<br>c this is a pair with h2_hminus 
<br>c
<br>c commands controlling continuum =========
<br>c this is hot star continuum
<br>black 30000
<br>intensity  -5. range  0.4412 to 1 Ryd
<br>c this will remove all ionizing radiation
<br>extinguish 24 0
<br>c background CR ionization rate should be 2.5e-17 s^-1,
<br>c Tielens & Hollenbach 1985; McKee AstroPH 9901370
<br>cosmic rays, background
<br>c
<br>c commands for density & abundances =========
<br>abundances ism 
<br>hden 5
<br>c
<br>c commands controlling geometry  =========
<br>set dr 0 
<br>stop zone 5 
<br>stop temperature 400 
<br>c
<br>c other commands for details     =========
<br>c default is Takahashi 2001 - test thermal distribution here
<br>set h2 grain formation thermal pump 
<br>atom h2 
<br>iterate
<br>constant temperature 500K
<br>c
<br>c commands controlling output    =========
<br>c don't print so many lines
<br>print line faint 10 
<br>print line column
<br>print line sort wavelength
<br>print column density 
<br>print ages
<br>punch overview "h2_solomon.ovr" last
<br>punch h2 lines "h2_solomon.lin" last all 
<br>punch h2 rates "h2_solomon.rat" last
<br>punch h2 column density "h2_solomon.col" last
<br>c
<br>c h2_solomon.in
<br>c class limit  
<br>c ========================================
<br>c 
</kbd><p>
This test H2 in case of grain formation and solomon destruction
<p>
</p><hr><h2><kbd>h2_t2000.in  </kbd><I>test large H2 molecule in shock-like conditions
</I></h2><kbd><br>title test large H2 molecule in shock-like conditions
<br>c
<br>c commands controlling continuum =========
<br>c there is a continuum but it is unimportant
<br>c first continuum is FIR hot grain continuum produced in 
<br>c unmodeled HII Region
<br>black 30000
<br>intensity  -5 range  0.4412 to 1 Ryd
<br>c this will remove all ionizing radiation
<br>extinguish 24 0
<br>c must provide source of ionization for chemistry 
<br>cosmic rays, background
<br>c
<br>c commands for density & abundances =========
<br>hden 6
<br>grains ism, abundance log 0.16 single
<br>init file="ism.ini"
<br>abundances he -1.01 c -3.52 n-8 o-3.30 ne-8 mg-5.89
<br>continue si -6.10 s -5.10 cl=-7 ar-8 fe -6.60
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 10
<br>c force zone thickess to 1 cm 
<br>set dr 0 
<br>c need to lower stop temperature since gas is cooler than 4000K
<br>stop temperature 3
<br>c
<br>c other commands for details     =========
<br>failures 2 
<br>atom h2  
<br>constant temperature 2000 
<br>iterate
<br>c this stop Lymnan line excitation of H, which is then photoionized
<br>c by Balmer continuum
<br>case b
<br>c
<br>c commands controlling output    =========
<br>normalize to "H2  " 2.121m 
<br>c 
<br>punch pdr "h2_t2000.pdr"
<br>punch h2 rates "h2_t2000.rat"
<br>punch h2 column density "h2_t2000.col"
<br>punch h2 lines "h2_t2000.lin" all last
<br>punch h2 populations "h2_t2000.pop" all last
<br>punch raw continuum "h2_t2000.raw"
<br>punch continuum "h2_t2000.con"
<br>punch overview "h2_t2000.ovr"
<br>c
<br>c h2_t2000.in 
<br>c class limit  
<br>c ========================================
</kbd><p>
This is a collisionally dominated H2 simulation.  The temperature
has been fixed at 2000K and the large molecule turned on.  The calculation
checks the returned value of the ortho to para densities.
Cosmic rays and the incident continuum have little effect, the density is high,
so the populations should be close to LTE.
<p>
</p><hr><h2><kbd>h2_t500.in  </kbd><I>test large H2 molecule in PDR-like conditions
</I></h2><kbd><br>title test large H2 molecule in PDR-like conditions
<br>c
<br>c commands controlling continuum =========
<br>c first continuum is FIR hot grain continuum produced in 
<br>c unmodeled HII Region
<br>blackbody, t = 75 K
<br>intensity -2.7 (total)
<br>c this is hot star continuum
<br>black 30000
<br>intensity  -5 range  0.4412 to 1 Ryd
<br>c this will remove all ionizing radiation
<br>extinguish 24 0
<br>c
<br>c commands for density & abundances =========
<br>hden 6
<br>grains ism, abundance log 0.16 single, no qheat 
<br>init file="ism.ini"
<br>abundances he -1.01 c -3.52 n-8 o-3.30 ne-8 mg-5.89
<br>continue si -6.10 s -5.10 cl=-7 ar-8 fe -6.60
<br>turbulence 2.7 km/sec
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 10
<br>c force zone thickess to 1 cm 
<br>sphere
<br>set dr 0 
<br>c stop when gas is fully neutral
<br>stop efrac -10
<br>c stop when gas is cold
<br>stop temperature 10 linear
<br>c
<br>c other commands for details     =========
<br>failures 2 
<br>atom h2  
<br>constant temperature 500 
<br>iterate
<br>case b
<br>cosmic rays background
<br>c
<br>c commands controlling output    =========
<br>normalize to "12CO" 863.0m 
<br>c uv lines are strongly pumped by stellar continuum, break out contribution
<br>print line pump
<br>print line optical depths
<br>print line faint -2
<br>print ages
<br>c 
<br>punch pdr "h2_t500.pdr"
<br>punch H2 rates "h2_t500.rat"
<br>punch H2 lines "h2_t500.lin" all 
<br>punch H2 column density "h2_t500.col"
<br>punch H2 populations "h2_t500.pop"
<br>punch H2 levels "h2_t500.lev"
<br>punch raw continuum "h2_t500.raw"
<br>punch continuum "h2_t500.con"
<br>punch overview "h2_t500.ovr"
<br>c
<br>table lines "LineList_PDR_H2.dat"
<br>c h2_t500.in 
<br>c class limit  
<br>c ========================================
</kbd><p>
This is a dense molecular gas with background cosmic rays and the incident
radiation field set to a small value.  The lower levels are in LTE.
<p>
</p><hr><h2><kbd>h_otsopen.in  </kbd><I>test ots, inward fractions for pure hydrogen, open geo, filling factor
</I></h2><kbd><br>title test ots, inward fractions for pure hydrogen, open geo, filling factor
<br>c
<br>c commands controlling continuum =========
<br>ionization -2
<br>blackbody 40000
<br>c
<br>c commands for density & abundances =========
<br>hden 5
<br>init file "honly.ini"  
<br>c
<br>c commands controlling geometry  =========
<br>stop efrac 0.05 %stop when 5 percent ionized 
<br>constant temper 7500
<br>filling factor 0.01
<br>c
<br>c other commands for details     =========
<br>c must iterate to get inward line fractions, that are asserted below
<br>iterate 
<br>diffuse ots
<br>c not iterating does not affect the solution
<br>no level2
<br>no induced processes (OK) 
<br>c
<br>c commands controlling output    =========
<br>print diffuse continuum
<br>print line inward
<br>punch overview  "h_otsopen.ovr" last
<br>punch dr  "h_otsopen.dr" last
<br>punch continuum "h_otsopen.con" last units angstrom
<br>normalize to "Ca B" 4861 = 1 % normalize to exact result 
<br>c
<br>c this is an open geometry, so do not expect H atom to exactly be case B
<br>c due to Lyman line leakage.  we iterated, so have a good estimate of
<br>c inward and outward fractions, which we test 
<br>c h_otsopen.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This tests the total emission from a hydrogen Stromgren sphere
using the OTS approximation.  The conservation of the total number
of ionizing photons, and the emitted spectrum, are all checked.
<p>
</p><hr><h2><kbd>h_otspp.in  </kbd><I>plane parallel conservation and hydrogenic emission for pure hydrogen
</I></h2><kbd><br>title plane parallel conservation and hydrogenic emission for pure hydrogen
<br>c
<br>c commands controlling continuum =========
<br>ionization -2
<br>blackbody 40000
<br>c
<br>c commands for density & abundances =========
<br>hden 5
<br>init file "honly.ini"  
<br>c
<br>c commands controlling geometry  =========
<br>sphere static (OK)
<br>stop efrac 0.05 %stop when 5 percent ionized 
<br>c
<br>c other commands for details     =========
<br>constant temper 7500
<br>no level2
<br>no induced processes (OK) 
<br>c needed to prevent 2s / Bal from becoming optically thick 
<br>turbulence 20 km/s
<br>diffuse ots
<br>atom h-like levels resolved 10 
<br>c
<br>c commands controlling output    =========
<br>print diffuse continuum
<br>normalize to "Ca B" 4861 = 1 % normalize to exact result for comp ion struc
<br>punch overview "h_otspp.ovr" 
<br>punch dr "h_otspp.dr" 
<br>c
<br>c h_otspp.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
<p>
This tests the total emission from a plane parallel pure hydrogen
Stromgren sphere using the OTS approximation.  The conservation
of the total number of ionizing photons, and the emitted spectrum,
are all checked.
<p>
</p><hr><h2><kbd>h_otssp.in  </kbd><I>spherical conservation and hydrogenic emission for pure hydrogen
</I></h2><kbd><br>title spherical conservation and hydrogenic emission for pure hydrogen
<br>c
<br>c commands controlling continuum =========
<br>ionization -2
<br>blackbody 40000
<br>c
<br>c commands for density & abundances =========
<br>hden 5
<br>init file "honly.ini"  
<br>c
<br>c commands controlling geometry  =========
<br>radius 13
<br>c not iterating does not affect the solution
<br>sphere static (OK)
<br>stop efrac 0.05 %stop when 5 percent ionized
<br>c
<br>c other commands for details     =========
<br>constant temper 7500
<br>diffuse ots
<br>no level2
<br>no induced processes (OK) 
<br>c
<br>c commands controlling output    =========
<br>print diffuse continuum
<br>normalize to "Ca B" 4861 = 1 % normalize to exact result 
<br>punch overview "h_otssp.ovr" 
<br>punch dr "h_otssp.dr" 
<br>c
<br>c h_otssp.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This tests the total emission from a spherical pure hydrogen Stromgren sphere
using the OTS approximation.  The conservation of the total number
of ionizing photons, and the emitted spectrum, are all checked.
<p>
<p>
</p><hr><h2><kbd>h_outopen.in  </kbd><I>test open geometry 
</I></h2><kbd><br>title test open geometry 
<br>c
<br>c commands controlling continuum =========
<br>ionization -2
<br>blackbody 40000
<br>c
<br>c commands for density & abundances =========
<br>hden 0
<br>init file "honly.ini"  
<br>c
<br>c commands controlling geometry  =========
<br>stop efrac 0.05 %stop when 5 percent ionized 
<br>filling 0.01
<br>c
<br>c other commands for details     =========
<br>diffuse outward
<br>iterate
<br>atom h-like levels resolved 15
<br>no level2
<br>no induced processes (OK) 
<br>constant temper 4
<br>c
<br>c commands controlling output    =========
<br>print diffuse continuum
<br>c normally will not print out inward parts of lines
<br>print line inward
<br>normalize to "Ca B" 4861 = 1 % normalize to exact result 
<br>punch overview  "h_outopen.ovr" last
<br>punch dr  "h_outopen.dr" last
<br>c
<br>c this is an open geometry, so do not expect H atom to exactly be case B
<br>c due to Lyman line leakage.  we iterated, so have a good estimate of
<br>c inward and outward fractions, which we test 
<br>c h_outopen.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
<p>
This tests the total emission from an open geometry, 
hydrogen Stromgren sphere,
using the outward only approximation.  The conservation of the total number
of ionizing photons, and the emitted spectrum, are all checked.
<p>
<p>
</p><hr><h2><kbd>h_outpp.in  </kbd><I>plane parallel H-only, close, test hydrogenic emission
</I></h2><kbd><br>title plane parallel H-only, close, test hydrogenic emission
<br>c
<br>c commands controlling continuum =========
<br>ionization -2
<br>blackbody 40000
<br>c
<br>c commands for density & abundances =========
<br>c the hydrogen density
<br>hden 5
<br>c an ini file that will include H-only
<br>init file "honly.ini"  
<br>c
<br>c commands controlling geometry  =========
<br>stop efrac 0.05 %stop when 5 percent ionized 
<br>c need this to prevent lyman lines from escaping
<br>sphere static (OK)
<br>c
<br>c other commands for details     =========
<br>c prevent continuum pumping of lyman lines
<br>no induced processes (OK)
<br>c must include this to keep Ha optically thin 
<br>turbulence 20 km/s
<br>c this is the approximation we are testing
<br>diffuse outward
<br>c force a constant temperature, then give stopping criteria
<br>c if stop were not present model would go to limiting number of zones
<br>constant temper 7500
<br>c increase number of levels to get full emission
<br>atom h-like levels resolved 20 
<br>c
<br>c commands controlling output    =========
<br>c need to turn this on so that continua at various energies will
<br>c be included in the emission line list 
<br>print diffuse continuum
<br>c normalize results to perfect case b - our predictions should
<br>c be close to this
<br>normalize to line "Ca B" 4861 
<br>c the output and asserts
<br>punch overview "h_outpp.ovr" 
<br>punch dr "h_outpp.dr"
<br>c
<br>c lots of continuum emission points turned on with print diffuse continuum
<br>c energies dominated by two photon emission not included since very
<br>c sensitive to Lya transport
<br>c h_outpp.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
<p>
This tests the total emission from a plane parallel pure hydrogen Stromgren sphere
using the outward only approximation.  The conservation of the total number
of ionizing photons, and the emitted spectrum, are all checked.
<p>
<p>
</p><hr><h2><kbd>h_outsp.in  </kbd><I>spherical conservation and hydrogenic emission for pure hydrogen
</I></h2><kbd><br>title spherical conservation and hydrogenic emission for pure hydrogen
<br>c
<br>c commands controlling continuum =========
<br>ionization -2
<br>blackbody 40000
<br>c
<br>c commands for density & abundances =========
<br>hden 5
<br>init file "honly.ini"  
<br>c
<br>c commands controlling geometry  =========
<br>radius 13
<br>c not iterating does not affect the solution
<br>sphere static (OK)
<br>stop efrac 0.05 %stop when 5 percent ionized
<br>c
<br>c other commands for details     =========
<br>constant temper 7500
<br>no level2
<br>atom h-like levels resolved 20 
<br>no induced processes (OK) 
<br>diffuse outward
<br>c
<br>c commands controlling output    =========
<br>print diffuse continuum
<br>normalize to "Ca B" 4861 = 1 % normalize to exact result 
<br>punch overview "h_outsp.ovr" 
<br>punch dr "h_outsp.dr" 
<br>c
<br>c lots of continuum emission points turned on with print diffuse continuum
<br>c energies dominated by two photon emission not included since very
<br>c sensitive to Lya transport
<br>c h_outsp.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This tests the total emission from a spherical pure hydrogen Stromgren sphere
using the outward only approximation.  The conservation of the total number
of ionizing photons, and the emitted spectrum, are all checked.
<p>
</p><hr><h2><kbd>h_t4_conemis.in  </kbd><I>continuous emission from H atom
</I></h2><kbd><br>title continuous emission from H atom
<br>c
<br>c commands controlling continuum =========
<br>c use laser so that stellar continuum is not in predicted continuum
<br>laser 2
<br>ionization -1
<br>c
<br>c commands for density & abundances =========
<br>c high density to suppress two-photon emission
<br>hden 8
<br>init "honly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>c this thisckness is the inverse square of the density, so the
<br>c total emission from the computed slab will in effect have the
<br>c square of the density removed, so predictions will be j pi j / n_e n_p
<br>stop thickness -16
<br>c
<br>c other commands for details     =========
<br>c include a large number of levels to capture IR emission
<br>c increase default resolution stored in continuum_mesh.ini 
<br>set continuum resolution 0.1
<br>iterate
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>print diffuse continuum
<br>print lines column 
<br>punch continuum "h_t4_conemis.con" last no title units microns 
<br>punch spectrum "h_t4_conemis.ncon" last no title units microns 
<br>c
<br>c h_t4_conemis.in 
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This tests the continuous emission from the model H atom.  The
gas temperature is 10,000 K and the continuous emissivity
is asserted for a range of wavelengths.
<p>
This was used to generate the plot in Hazy 2 comparing the emission
from a pure hydrogen plasma with those of Ferland 1980.
<p>
//>>refer	HI	emission	Ferland, G. J. 1980, PASP, 92, 596
</p><hr><h2><kbd>h_t4_conemis_lon.in  </kbd><I>low-den continuous HI emission with 2-nu important
</I></h2><kbd><br>title low-den continuous HI emission with 2-nu important
<br>c
<br>c commands controlling continuum =========
<br>laser 2
<br>ionization -1
<br>c
<br>c commands for density & abundances =========
<br>hden 0
<br>init "honly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop thickness 0
<br>c
<br>c other commands for details     =========
<br>c increase default resolution stored in continuum_mesh.ini 
<br>set continuum resolution 0.1
<br>case b 
<br>iterate
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>print diffuse continuum
<br>print lines column 
<br>punch continuum "h_t4_conemis_lon.con" last units microns 
<br>punch two photon continuum "h_t4_conemis_lon.2nu" last rydbergs
<br>punch spectrum "h_t4_conemis_lon.ncon" last units microns 
<br>c
<br>c h_t4_conemis_lon.in 
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This is a mate to hatomt10.in except that the density is low enough
for two-photon emission to be very imporant in the optical and uv.
</p><hr><h2><kbd>h_t4_conemis_thick.in  </kbd><I>H I continuous emissivity, used for plot in hazy
</I></h2><kbd><br>title H I continuous emissivity, used for plot in hazy
<br>c
<br>c commands controlling continuum =========
<br>black 5
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>c high density to suppress two-photon emission
<br>hden 7
<br>c turn off all elements, except for hydrogen, so that
<br>c we really test hydrogen emission 
<br>init file= "honly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>c this is necessary to stop model at H ionization front
<br>c constant temperature models will go on to infinity without this 
<br>stop efrac -0.8
<br>c
<br>c other commands for details     =========
<br>turbulence 200 km/s ; needed to keep balmer lines thin
<br>c increase continuum resolution by factor of ten
<br>set continuum resolution 0.1
<br>c line fluorescense would be very important with above turbulence,
<br>c turn it off 
<br>no induced processes
<br>c need large atom to get the many Rydgerg levels in the infrared
<br>c atom h-like levels resolved 10
<br>c what full outward flux so use spherical geometry
<br>sphere 
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>c results will be relative to interplated Hummer&Storey Hbeta 
<br>c this tests hydrogen atom too 
<br>normalize "Ca B" 4861
<br>c by default, the continuum flux at many wavelengths is not printed,
<br>c this turns that information on 
<br>print diffuse continuum
<br>c output the predicted continuum
<br>punch emitted continuum last iteration "h_t4_conemis_thick.con" units micron
<br>punch dr last "h_t4_conemis_thick.dr"
<br>c
<br>c h_t4_conemis_thick.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This checks that the predicted hydrogen continuum is in good agreement
with exact results in the optically thin nebular limit.
<p>
<br>Checks:
<br>-	This output was used to generate figure h_t4_conemis_thick in Part I of HAZY. 
<br>-	Continuum relative to Hbeta should agree with Ferland (1980)
	filter averaged results.
<br>-	Hbeta should agree with Case B predictions, and Q(H) 4861.
<p>
</p><hr><h2><kbd>heatomt10.in  </kbd><I>continuous emission from HeI 
</I></h2><kbd><br>title continuous emission from HeI 
<br>c
<br>c commands controlling continuum =========
<br>laser 1.9 ryd
<br>ionization -1
<br>c
<br>c commands for density & abundances =========
<br>c need high density to supress two-photon emission
<br>hden 10
<br>c force high density for electrons, He+ density will be the same
<br>set eden 12
<br>c set He/H ratio to 100, He and elec will have same density
<br>element abundance helium 2
<br>init "hheonly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>c this thickness will get unit emission when combined with above densities
<br>stop thickness -24
<br>c
<br>c other commands for details     =========
<br>iterate
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>print continuum
<br>c
<br>set continuum resolution 0.1
<br>set nFnu diffuse outward, diffuse inward
<br>print continuum 
<br>print line faint 1
<br>print line column
<br>punch spectrum  "heatomt10.spc" last no title units microns 
<br>punch continuum "heatomt10.con" last no title units microns 
<br>punch diffuse continuum "heatomt10.dif" last no title units microns
<br>c
<br>c heatomt10.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This tests continuous emission from the He I atom.
The laser is used so that the incident continuum
is not included in the total emission.
<p>
</p><hr><h2><kbd>heatomt10lon.in  </kbd><I>test low-den continuous emission from H atom, 2-nu is important
</I></h2><kbd><br>title test low-den continuous emission from H atom, 2-nu is important
<br>c
<br>c commands controlling continuum =========
<br>laser 2
<br>ionization -1
<br>c
<br>c commands for density & abundances =========
<br>hden -8
<br>element helium abundance log 3
<br>set eden -5
<br>init "hheonly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop thickness log 10
<br>c
<br>c other commands for details     =========
<br>no scattering opacity
<br>c force all helium to be in He+ 
<br>element helium ionization -4 0 -4 
<br>case b 
<br>c increase default resolution stored in continuum_mesh.ini 
<br>set continuum resolution 0.1
<br>iterate
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>normalize to "he 1" 4471 
<br>print lines column  
<br>print diffuse continuum
<br>print lines column 
<br>punch continuum "heatomt10lon.con" last units microns 
<br>punch diffuse continuum "heatomt10lon.dif" last units microns 
<br>punch two photon continuum "heatomt10lon.2nu" last
<br>punch spectrum "heatomt10lon.ncon" last units microns 
<br>c
<br>c heatomt10lon.in 
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This is a mate to hatomt10.in except that everything is He at low density
</p><hr><h2><kbd>heiont10.in  </kbd><I>continuous emission from HeII
</I></h2><kbd><br>title continuous emission from HeII
<br>c
<br>c commands controlling continuum =========
<br>laser 5 ryd
<br>ionization 1
<br>c
<br>c commands for density & abundances =========
<br>hden 8
<br>set eden 10
<br>element abundance helium 2
<br>init "hheonly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop thickness -20
<br>c
<br>c other commands for details     =========
<br>constant temperature 4
<br>iterate
<br>c increase continuum resolution by factor of ten
<br>set continuum resolution 0.1
<br>set nFnu diffuse outward, diffuse inward
<br>c
<br>c commands controlling output    =========
<br>print continuum 
<br>print line faint 1
<br>print line column
<br>punch continuum "heiont10.con" last no title units microns 
<br>punch spectrum  "heiont10.spc" last no title units microns
<br>c
<br>c heiont10.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This tests the He II continuous emission.  The helium abundance
is very large so that He II overwhelms other emission sources.
The resolution of the continuum mesh is increased so that we get
a better representation of the continuous emission.
<p>
</p><hr><h2><kbd>helike_ar.in  </kbd><I>He-like argon emission
</I></h2><kbd><br>title He-like argon emission
<br>c
<br>c commands controlling continuum =========
<br>laser 600
<br>ionization -1
<br>c
<br>c commands for density & abundances =========
<br>hden 7
<br>c include lots of the element we are testing and set the ionization 
<br>c to be dominated by the correct ion stage
<br>element argon abundance -2
<br>element argon ionization -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 0 -5
<br>init file "ism.ini"
<br>element helium off
<br>element nitrogen off
<br>element carbon off
<br>element neon off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element oxygen off
<br>element iron off
<br>c
<br>c commands controlling geometry  =========
<br>set dr -12
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>atom he-like levels 10
<br>atom he-like collapsed levels 20
<br>constant temper 5
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>print he-like departure argon
<br>print line faint -2
<br>c This is Lyman alpha
<br>normalize to "Ar17" 3.949A
<br>c
<br>c 3.994A is 2^3S to ground
<br>c Totl is 2^3P to ground
<br>c 3.365A is 3^1P to ground
<br>c 21.54A is 3^3P to 2^3S
<br>c 22.24A is 3^3D to 2^3P
<br>c 
<br>c helike_ar.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
test He-like emission for argon
<p>
<p>
</p><hr><h2><kbd>helike_c.in  </kbd><I>he-like carbon emission
</I></h2><kbd><br>title he-like carbon emission
<br>c
<br>c commands controlling continuum =========
<br>laser 50
<br>ionization -1
<br>c
<br>c commands for density & abundances =========
<br>hden 7
<br>c include lots of the element we are testing and set the ionization 
<br>c to be dominated by the correct ion stage
<br>element carbon abundance -2
<br>element carbon ionization -5 -5 -5 -5 -5 0 -5
<br>init file "ism.ini"
<br>element helium off
<br>element nitrogen off
<br>element oxygen off
<br>element neon off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element argon off
<br>element iron off
<br>c
<br>c commands controlling geometry  =========
<br>set dr -12
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>atom he-like levels 10
<br>atom he-like collapsed levels 20
<br>constant temper 5
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>print he-like departure carbon
<br>print line faint -2
<br>c This is Lyman alpha
<br>normalize to "C  5" 40.27A
<br>c
<br>c
<br>c helike_c.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
test he-like carbon emission
<p>
</p><hr><h2><kbd>helike_co.in  </kbd><I>He-like cobalt emission
</I></h2><kbd><br>title He-like cobalt emission
<br>atom he-like levels 10
<br>atom he-like collapsed levels 20
<br>print he-like departure cobalt 
<br>constant temper 5
<br>iterate
<br>hden 7
<br>set dr -12
<br>init file "ism.ini"
<br>c must turn on since ism.ini turned it off
<br>element cobalt on  
<br>c then set abundance and ionization after turning it on
<br>element cobalt abundance -2
<br>element cobalt ionization -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 0 -5
<br>c now turn lots of elements off to save time
<br>element helium off
<br>element nitrogen off
<br>element carbon off
<br>element neon off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element oxygen off
<br>element argon off
<br>element iron off
<br>laser 1300
<br>ionization -1
<br>stop zone 1
<br>print line faint -2
<br>c
<br>c helike_co.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
test emission of He-like Co
<p>
</p><hr><h2><kbd>helike_cu.in  </kbd><I>He-like copper emission
</I></h2><kbd><br>title He-like copper emission
<br>atom he-like levels 10
<br>atom he-like collapsed levels 20
<br>print he-like departure copper 
<br>constant temper 5
<br>iterate
<br>hden 7
<br>set dr -12
<br>init file "ism.ini"
<br>c must turn on since ism.ini turned it off
<br>element copper on  
<br>c then set abundance and ionization after turning it on
<br>element copper abundance -2
<br>element copper ionization -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 0 -5
<br>c now turn lots of elements off to save time
<br>element helium off
<br>element nitrogen off
<br>element carbon off
<br>element neon off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element oxygen off
<br>element argon off
<br>element iron off
<br>laser 1300
<br>ionization -1
<br>stop zone 1
<br>print line faint -2
<br>c
<br>c helike_cu.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
test emission of He-like Cu
</p><hr><h2><kbd>helike_fe.in  </kbd><I>he-like iron emission
</I></h2><kbd><br>title he-like iron emission
<br>c
<br>c commands controlling continuum =========
<br>laser 1300
<br>ionization -1
<br>c
<br>c commands for density & abundances =========
<br>hden 7
<br>set dr -12
<br>c include lots of the element we are testing and set the ionization 
<br>c to be dominated by the correct ion stage
<br>element iron abundance -2
<br>element iron ionization -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 0 -5
<br>init file "ism.ini"
<br>element helium off
<br>element nitrogen off
<br>element carbon off
<br>element neon off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element oxygen off
<br>element argon off
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>atom he-like levels 10
<br>atom he-like collapsed levels 20
<br>constant temper 5
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>print line faint -2
<br>print he-like departure iron
<br>c This is Lyman alpha
<br>normalize to "Fe25" 1.850A
<br>c
<br>c 
<br>c helike_fe.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
check He-like emission for iron
<p>
<p>
</p><hr><h2><kbd>helike_mg.in  </kbd><I>he-like magnesium emission
</I></h2><kbd><br>title he-like magnesium emission
<br>c
<br>c commands controlling continuum =========
<br>laser 250
<br>ionization -1
<br>c
<br>c commands for density & abundances =========
<br>hden 7
<br>set dr -12
<br>element magnesium abundance -2
<br>element magnesium ionization -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 0 -5
<br>init file "ism.ini"
<br>element helium off
<br>element nitrogen off
<br>element carbon off
<br>element neon off
<br>element silicon off
<br>element oxygen off
<br>element sulphur off
<br>element argon off
<br>element iron off
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>atom he-like levels 10
<br>atom he-like collapsed levels 20
<br>constant temper 5
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>print he-like departure magnesium
<br>print line faint -2
<br>c This is Lyman alpha
<br>normalize to "Mg11" 9.169A
<br>c
<br>c 
<br>c helike_mg.in 
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
test He-like Mg emission
<p>
<p>
</p><hr><h2><kbd>helike_n.in  </kbd><I>He-like nitrogen emission
</I></h2><kbd><br>title He-like nitrogen emission
<br>c
<br>c commands controlling continuum =========
<br>laser 75
<br>ionization -1
<br>c
<br>c commands for density & abundances =========
<br>hden 7
<br>element nitrogen abundance -2
<br>element nitrogen ionization -5 -5 -5 -5 -5 -5 0 -5
<br>init file "ism.ini"
<br>element helium off
<br>element carbon off
<br>element oxygen off
<br>element neon off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element argon off
<br>element iron off
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set dr -12
<br>c
<br>c other commands for details     =========
<br>atom he-like levels 10
<br>atom he-like collapsed levels 20
<br>constant temper 5
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>print he-like departure nitrogen
<br>print line faint -2
<br>c This is Lyman alpha
<br>normalize to "N  6" 28.79A
<br>c
<br>c helike_n.in
<br>c class limit  
<br>c ========================================
<br>c 
</kbd><p>
test He-like emission for N
<p>
</p><hr><h2><kbd>helike_ne.in  </kbd><I>he-like neon emission
</I></h2><kbd><br>title he-like neon emission
<br>c
<br>c commands controlling continuum =========
<br>laser 170
<br>ionization -1
<br>c
<br>c commands for density & abundances =========
<br>hden 7
<br>c include lots of the element we are testing and set the ionization 
<br>c to be dominated by the correct ion stage
<br>element neon abundance -2
<br>element neon ionization -5 -5 -5 -5 -5 -5 -5 -5 -5 0 -5
<br>init file "ism.ini"
<br>element helium off
<br>element nitrogen off
<br>element carbon off
<br>element oxygen off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element argon off
<br>element iron off
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set dr -12
<br>c
<br>c other commands for details     =========
<br>atom he-like levels 10
<br>atom he-like collapsed levels 20
<br>constant temper 5
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>print he-like departure neon
<br>print line faint -2
<br>c This is Lyman alpha
<br>normalize to "Ne 9" 13.45A
<br>c
<br>c 
<br>c helike_ne.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
test He-like emission for oxygen
<p>
<p>
</p><hr><h2><kbd>helike_ni.in  </kbd><I>he-like nickel emission
</I></h2><kbd><br>title he-like nickel emission
<br>atom he-like levels 10
<br>atom he-like collapsed levels 20
<br>print he-like departure nickel
<br>constant temper 5
<br>iterate
<br>hden 7
<br>set dr -12
<br>init file "ism.ini"
<br>c must turn on since ism.ini turned it off
<br>element nickel on  
<br>c then set abundance and ionization after turning it on
<br>element nickel abundance -2
<br>element nickel ionization -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 0 -5
<br>c now turn lots of elements off to save time
<br>element helium off
<br>element nitrogen off
<br>element carbon off
<br>element neon off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element oxygen off
<br>element argon off
<br>element iron off
<br>laser 1300
<br>ionization -1
<br>stop zone 1
<br>print line faint -2
<br>c
<br>c helike_ni.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
Test He-like Ni emission.
</p><hr><h2><kbd>helike_o.in  </kbd><I>he-like oxygen ion vs. Bautista & Kallman 2000 Table 1, column 3
</I></h2><kbd><br>title he-like oxygen ion vs. Bautista & Kallman 2000 Table 1, column 3
<br>c
<br>c commands controlling continuum =========
<br>laser 100
<br>ionization -1
<br>c
<br>c commands for density & abundances =========
<br>hden 7
<br>c include lots of the element we are testing and set the ionization 
<br>c to be dominated by the correct ion stage
<br>element oxygen abundance -2
<br>element oxygen ionization -5 -5 -5 -5 -5 -5 -5 0 -5
<br>init file "ism.ini"
<br>element helium off
<br>element nitrogen off
<br>element carbon off
<br>element neon off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element argon off
<br>element iron off
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set dr -12
<br>c
<br>c other commands for details     =========
<br>atom he-like levels 10
<br>atom he-like collapsed levels 20
<br>constant temper 5
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>print he-like departure oxygen
<br>print line sort wavelength 
<br>print line faint -5
<br>normalize to "o  7" 21.60A
<br>c
<br>c helike_o.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
test He-like emission for oxygen
<p>
<p>
</p><hr><h2><kbd>helike_si.in  </kbd><I>He-like silicon emission
</I></h2><kbd><br>title He-like silicon emission
<br>c
<br>c commands controlling continuum =========
<br>laser 350
<br>ionization -1
<br>c
<br>c commands for density & abundances =========
<br>hden 7
<br>c include lots of the element we are testing and set the ionization 
<br>c to be dominated by the correct ion stage
<br>element silicon abundance -2
<br>element silicon ionization -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 0 -5
<br>init file "ism.ini"
<br>element helium off
<br>element nitrogen off
<br>element carbon off
<br>element neon off
<br>element magnesium off
<br>element oxygen off
<br>element sulphur off
<br>element argon off
<br>element iron off
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set dr -12
<br>c
<br>c other commands for details     =========
<br>atom he-like levels 10
<br>atom he-like collapsed levels 20
<br>constant temper 5
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>print he-like departure silicon
<br>print line faint -2
<br>c This is Lyman alpha
<br>normalize to "Si13" 6.648A
<br>c
<br>c
<br>c helike_si.in
<br>c class limit
<br>c 
</kbd><p>
test He-like emission for silicon
<p>
<p>
</p><hr><h2><kbd>helike_zn.in  </kbd><I>He-like zinc emission
</I></h2><kbd><br>title He-like zinc emission
<br>atom he-like levels 10
<br>atom he-like collapsed levels 20
<br>print he-like departure zinc 
<br>constant temper 5
<br>iterate
<br>hden 7
<br>set dr -12
<br>init file "ism.ini"
<br>c must turn on since ism.ini turned it off
<br>element zinc on  
<br>c then set abundance and ionization after turning it on
<br>element zinc abundance -2
<br>element zinc ionization -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 0 -5
<br>c now turn lots of elements off to save time
<br>element helium off
<br>element nitrogen off
<br>element carbon off
<br>element neon off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element oxygen off
<br>element argon off
<br>element iron off
<br>laser 1300
<br>ionization -1
<br>stop zone 1
<br>print line faint -2
<br>c
<br>c helike_zn.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
test emission for He-like Zn
</p><hr><h2><kbd>hhe_otspp.in  </kbd><I>plane parallel conservation and H-like emission for H, He
</I></h2><kbd><br>title plane parallel conservation and H-like emission for H, He
<br>c
<br>c commands controlling continuum =========
<br>ionization -2
<br>blackbody 40000
<br>c
<br>c commands for density & abundances =========
<br>hden 5
<br>init file "hheonly.ini"  
<br>c
<br>c commands controlling geometry  =========
<br>c expanding sphere to stop Lya from destroying HeI 23S
<br>sphere
<br>stop efrac 0.05 %stop when 5 percent ionized, so just beyond H I-front
<br>c
<br>c other commands for details     =========
<br>diffuse ots 
<br>atom h-like element hydrogen levels resolved 10 
<br>c need to iterate since we will assert helium triplet lines 
<br>c that depend on having stable solution
<br>iterate 
<br>constant temper 7500
<br>no induced processes (OK)
<br>c
<br>c commands controlling output    =========
<br>normalize to "Ca B" 4861 = 1 % normalize to exact result 
<br>punch overview "hhe_otspp.ovr"  last
<br>punch dr "hhe_otspp.dr"  last
<br>c
<br>c helium lines
<br>c hhe_otspp.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
<p>
This tests the total emission from a spherical pure H + He Stromgren sphere
using the outward only approximation.  The conservation of the total number
of ionizing photons, and the emitted spectrum, are all checked.
<p>
<p>
<p>
</p><hr><h2><kbd>hhe_otssp.in  </kbd><I>spherical conservation and H-like emission for H and He
</I></h2><kbd><br>title spherical conservation and H-like emission for H and He
<br>c
<br>c commands controlling continuum =========
<br>blackbody 40000
<br>ionization -2
<br>c
<br>c commands for density & abundances =========
<br>hden 5
<br>init file "hheonly.ini"  
<br>c
<br>c commands controlling geometry  =========
<br>diffuse ots
<br>atom h-like levels resolved 10 
<br>radius 13
<br>stop efrac 0.05 %stop when 5 percent ionized
<br>sphere static
<br>c
<br>c other commands for details     =========
<br>constant temper 7500
<br>iterate
<br>no level2
<br>no induced processes (OK)
<br>c
<br>c commands controlling output    =========
<br>normalize to "Ca B" 4861 = 1 % normalize to exact result 
<br>punch overview "hhe_otssp.ovr"  last
<br>punch dr "hhe_otssp.dr"  last
<br>c
<br>c helium lines
<br>c hhe_otssp.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
<p>
This tests the total emission from a spherical pure H + He-like Stromgren sphere
using the outward only approximation.  The conservation of the total number
of ionizing photons, and the emitted spectrum, are all checked.	The geometry is plane paralel.
<p>
</p><hr><h2><kbd>hhe_outpp.in  </kbd><I>plane parallel conservation emission for H, He gas
</I></h2><kbd><br>title plane parallel conservation emission for H, He gas
<br>c
<br>c commands controlling continuum =========
<br>blackbody 40000
<br>ionization -2
<br>c
<br>c commands for density & abundances =========
<br>hden 5
<br>init file "hheonly.ini"  
<br>c
<br>c commands controlling geometry  =========
<br>c open sphere to stop Lya from destroying HeI 23S
<br>sphere
<br>stop efrac 0.05 %stop when 5 percent ionized 
<br>c
<br>c other commands for details     =========
<br>c need this since will assert  helium triplet lines that depend on stable soln
<br>iterate 
<br>constant temper 7500
<br>atom h-like element hydrogen levels resolved 10 
<br>no level2
<br>no induced processes (OK)
<br>c
<br>c commands controlling output    =========
<br>normalize to "Ca B" 4861 = 1 % normalize to exact result 
<br>punch overview "hhe_outpp.ovr"  last
<br>punch dr "hhe_outpp.dr"  last
<br>c
<br>c hhe_outpp.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This tests the total emission from a spherical pure hydrogen Stromgren sphere
using the outward only approximation.  The conservation of the total number
of ionizing photons, and the emitted spectrum, are all checked.
<p>
<p>
</p><hr><h2><kbd>hhe_outppff.in  </kbd><I>plane parallel filling factor pure H, He gas
</I></h2><kbd><br>title plane parallel filling factor pure H, He gas
<br>c
<br>c commands controlling continuum =========
<br>ionization -2
<br>blackbody 40000
<br>c
<br>c commands for density & abundances =========
<br>hden 5
<br>init file "hheonly.ini"  
<br>c
<br>c commands controlling geometry  =========
<br>filling factor -1
<br>stop efrac 0.05 %stop when 5 percent ionized 
<br>sphere
<br>c
<br>c other commands for details     =========
<br>c need this since will assert  helium triplet lines that depend on stable soln
<br>iterate 
<br>constant temper 7500
<br>no level2
<br>no induced processes (OK)
<br>atom h-like element hydrogen levels resolved 10
<br>c
<br>c commands controlling output    =========
<br>normalize to "Ca B" 4861 = 1 % normalize to exact result 
<br>punch overview "hhe_outppff.ovr"  last
<br>punch dr "hhe_outppff.dr"  last
<br>c
<br>c helium lines
<br>c hhe_outppff.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This is a plane-parallel constant temperature cloud with only
hydrogen and helium.  The gas has a filling factor of 0.1.  
Induced processes are turned off and a large H atom is used
so that the hydrogen recombination
spectrum will be close to Case B. The calculation stops beyond the
hydrogen ionization front, because of the stop efrac command (it needs
this since this is a constant temperature calculation, so the usual
lower-temperature stopping criterion does not apply).   The asserts
confirm that energy is conserved and that the hydrogen spectrum is correct.
 
</p><hr><h2><kbd>hhe_outsp.in  </kbd><I>spherical conservation and H-like emission for H, He
</I></h2><kbd><br>title spherical conservation and H-like emission for H, He
<br>c
<br>c commands controlling continuum =========
<br>ionization -2
<br>blackbody 40000
<br>c
<br>c commands for density & abundances =========
<br>hden 5
<br>init file "hheonly.ini"  
<br>c
<br>c commands controlling geometry  =========
<br>radius 13
<br>stop efrac 0.05 %stop when 5 percent ionized
<br>sphere static
<br>c
<br>c other commands for details     =========
<br>iterate
<br>diffuse outward only
<br>constant temper 7500
<br>no level2
<br>no induced processes (OK)
<br>atom h-like element hydrogen levels resolved 10
<br>c
<br>c commands controlling output    =========
<br>normalize to "Ca B" 4861 = 1 % normalize to exact result 
<br>punch overview "hhe_outsp.ovr"  last
<br>punch dr "hhe_outsp.dr"  last
<br>c
<br>c helium lines
<br>c 
<br>c hhe_outsp.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
<p>
This tests a spherical cloud with only hydrogen and helium.
Diffuse fields are transferred with the outward only approximation.
The asserts check that the ionizing radiation is conserved.
<p>
<p>
</p><hr><h2><kbd>hii_blister.in  </kbd><I>Lexington 1995 dust-free hii blister region
</I></h2><kbd><br>title Lexington 1995 dust-free hii blister region
<br>c
<br>c commands controlling continuum =========
<br>c a simple blackbody
<br>blackbody 40000
<br>c the flux of H-ionizing photons
<br>phi(h) 13.0
<br>c add the CMB after hot star shape & luminosity specified
<br>CMB 
<br>c
<br>c commands for density & abundances =========
<br>hden 4
<br>init file="ism.ini"
<br>c HII region abundance but no dust
<br>abundances hii region no grains
<br>abundances he1 c1 n1 o1 ne1 mg=.0001 si.01 s1 cl1 ar1
<br>continue fe.001
<br>c
<br>c commands controlling geometry  =========
<br>sphere
<br>c
<br>c other commands for details     =========
<br>c this is to desaturate Lya to prevent excited state photoionization
<br>c from being important - the other codes did not include this important
<br>c physical process
<br>turbulence 10 km/s
<br>c must iterate since optically thick
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>normalize to "Ca B" 4861
<br>print line faint .01
<br>print line sum
<br>He 1 5876
<br>totl 2326
<br>C  2 1335
<br>TOTL 1909
<br>N  2 6584
<br>N  2 6548
<br>N  3  57.21m
<br>TOTL 7325
<br>TOTL 3727
<br>O  3  51.80m
<br>O  3 5007
<br>O  3 4959
<br>Ne 2  12.81m
<br>Ne 3  15.55m
<br>Ne 3 3869
<br>Ne 3 3968
<br>S  3  18.67m
<br>S  3 9532
<br>S  3 9069
<br>S  4  10.51m
<br>end of lines
<br>punch overview last "hii_blister.ovr"
<br>punch dr last "hii_blister.dr"
<br>punch results last "hii_blister.rlt"
<br>print line optical depths
<br>c
<br>c 
<br>c hii_blister.in
<br>c class hii
<br>c ========================================
</kbd><p>
<p>
This is one of the test cases from the Lexington Meeting suite of
nebulae (Ferland et al. 1995).  It is a grain-free hii_blister HII region,
similar to inner regions of the Orion Nebula, except for the
absence of grains.
The set of lines entered with the print line sum command lists
the most powerful coolants in this model.  This is one of the
tabulated quantities in the Lexington Meeting, and is a
fundamental test of energy conservation in the code. 
The ratio of the sum of these lines to Hb is equivalent to the
Stoy ratio, used for determining stellar temperatures.
<p>
The "dielec kludge 0" command is to turn off my estimates of the
DR rates for those elements that had none.  This was only to allow
comparison with other calculations that did not make similar estimates.
For an actual calculation I would not include this command, since the
guesses are better than nothing.
<p>
the turbulence is to stop the balmer lines from becoming optically
thick since few other codes include an actual H atom, but use
case b instead.  The Orion HII region does have an observed turbulence
of about 8 km/s.  
<p>
This calculation stops near the H+ - H0 ionization front, where
the temperature falls below the default lowest temperature of 4000 K.
This model would have continued into the PDR had a lower temperature
been specified with the STOP LOWEST TEMP command. 
<p>
</p><hr><h2><kbd>hii_coolstar.in  </kbd><I>dust free cool HII region model, Lexington 1995
</I></h2><kbd><br>title dust free cool HII region model, Lexington 1995
<br>c
<br>c commands controlling continuum =========
<br>black body, T = 20000 K 
<br>q(h) 49
<br>c add the CMB after hot star shape & luminosity specified
<br>CMB 
<br>c
<br>c commands for density & abundances =========
<br>hden = 2
<br>init file="ism.ini"
<br>abund He-1 C-3.6576 N-4.39794 O-3.481146 ne-4.30103 mg-8
<br>continue si-8 s-5.04576 cl-7 ar-8 fe-8
<br>c
<br>c commands controlling geometry  =========
<br>radius = 18.477121
<br>sphere
<br>c this is to go deep to pick up all H recombs
<br>stop efract -2
<br>stop temperature 1,000
<br>c
<br>c other commands for details     =========
<br>c must iterate since fine structure lines are optically thick
<br>iterate
<br>c assume there is neutral gas beyond what we compute
<br>double
<br>c
<br>c commands controlling output    =========
<br>plot continuum range .1
<br>print line faint .01
<br>c this is the sum of lines in table 2 of the Lexington meeting
<br>print line sum 
<br>N  2 6584
<br>N  2 6548
<br>TOTL 3727
<br>Ne 2  12.81m
<br>S  2 6720
<br>S  3  18.67m
<br>S  3  33.47m
<br>S  3 9532
<br>S  3 9069
<br>end of lines
<br>punch overview last "hii_coolstar.ovr"
<br>punch dr last "hii_coolstar.dr"
<br>punch results last "hii_coolstar.rlt"
<br>punch continuum last units microns "hii_coolstar.con"
<br>punch lines, cumulative, "hii_coolstar.cum"
<br>totl 4861
<br>o  3 5007
<br>totl 3727
<br>o  1 6300
<br>end of lines
<br>c
<br>c Hbeta 4.93E36, L(total)4.30xHbeta
<br>c hii_coolstar.in
<br>c class hii 
<br>c ========================================
<br>c 
</kbd><p>
<p>
This is one of the test cases from the Lexington Meeting suite of nebulae. 
It is a grain-free HII region ionized by a very cool star.  Hydrogen is
ionized but not helium so this tests the transport of the H Lyman continuum. 
The set of lines is entered with the print line sum command to test
energy conservation.
</p><hr><h2><kbd>hii_icf.in  </kbd><I>HII region with negative He/H ICF
</I></h2><kbd><br>title HII region with negative He/H ICF
<br>c
<br>c commands controlling continuum =========
<br>c this is the result of this command
<br>c table star mihalas 46000
<br>c and makes it possible to run these orion sims without
<br>c installing the stellar atmosphere files 
<br>table read "star_mihalas_46000.dat" 
<br>ionization parameter -2.
<br>c add the CMB after hot star shape & luminosity specified
<br>CMB 
<br>c
<br>c commands for density & abundances =========
<br>hden 3
<br>init file "ism.ini"
<br>abundances ism no grains
<br>grains no qheat single 
<br>metals and grains 0.320
<br>c
<br>c commands controlling geometry  =========
<br>stop efrac -3
<br>stop temperature 15
<br>sphere
<br>c
<br>c other commands for details     =========
<br>failures 1
<br>c
<br>c commands controlling output    =========
<br>punch overview "hii_icf.ovr" last
<br>punch dr "icr.dr" last
<br>c
<br>c hii_icf.in
<br>c class hii 
<br>c ========================================
</kbd><p>
<p>
This is an example of an H II region irradiated
by a hard stellar continuum - one of the Mihalas NLTE stars.
The hard continuum produces a negative He/H ionization
correction factor, as discussed in Ballantyne, Ferland & Martin (2000).
>>refer	HeI	icf by Ballantyne,D.R.,  Ferland, G.J., & Martin, P.G., 2000, ApJ 536, 773-777
<p>
</p><hr><h2><kbd>hii_paris.in  </kbd><I>"New" Paris meeting HII region
</I></h2><kbd><br>title "New" Paris meeting HII region
<br>c "standard" HII region model of the Pequignot Meudon Conferance
<br>c
<br>c commands controlling continuum =========
<br>black body, T = 40000 K radius = 12.113943
<br>c add the CMB after hot star shape & luminosity specified
<br>CMB 
<br>c
<br>c commands for density & abundances =========
<br>hden = 2
<br>init file="ism.ini"
<br>abund he -1 C-3.6576 N-4.39794 O-3.481146 ne-4.30103 mg-8
<br>continue si-8 s-5.04576 cl=-7 ar-8 fe-8
<br>c
<br>c commands controlling geometry  =========
<br>radius = 18.477121
<br>sphere
<br>c next two to make sure we pick up all possible H recombination
<br>* stop temperature 600
<br>set temperature floor 1000
<br>c make sure sim goes very deep into cold gas
<br>stop temperature 100K 
<br>stop efrac -2 
<br>c
<br>c other commands for details     =========
<br>c must iterate since fine structure lines are opticall thick
<br>atom h-like element hydrogen levels resolved 10
<br>iterate   
<br>c
<br>c commands controlling output    =========
<br>normalize to "Ca B" 4861
<br>print column densities 
<br>print line optical depths 
<br>plot continuum range .1
<br>print line faint 0.01
<br>print line sum
<br>He 1 5876
<br>totl 2326
<br>TOTL 1909
<br>N  2  121.7m
<br>N  2 6584
<br>N  2 6548
<br>N  3  57.21m
<br>TOTL 3727
<br>O  3 5007
<br>O  3 4959
<br>O  3  51.80m
<br>O  3  88.33m
<br>Ne 2  12.81m
<br>Ne 3  15.55m
<br>Ne 3 3869
<br>Ne 3 3968
<br>S  2 6720
<br>S  3  18.67m
<br>S  3  33.47m
<br>S  3 9532
<br>S  3 9069
<br>S  4  10.51m
<br>end of lines
<br>punch overview last "hii_paris.ovr"
<br>punch hydrogen 21 cm last "hii_paris.21cm"
<br>punch results last "hii_paris.rlt"
<br>punch dr last "hii_paris.dr"
<br>c this is to confirm that this commnand works
<br>punch lines emissivity "hii_paris.str" last 
<br>TOTL  4861
<br>end lines
<br>c
<br>table lines "LineList_HII.dat"
<br>c hii_paris.in
<br>c class hii 
<br>c ========================================
<br>c 
</kbd><p>
This is one of the "standard" models computed at the Paris and Lexington
meetings on photoionization and shock calculations.  a bable in hazy
compares the predictions of the current version of CLOUDY with predictions
of a few of the other codes.  It is necessary to iterate since some
fine structure lines are optically thick.   The set of lines entered
with the print line sum command is used to obtain the total luminosity
in detected lines, a measure of the Stoy temperature.
<p>
<br>Checks:
<br>-	Hb close to case B, Q(H) 4861, intensities.
<br>-	Enter answers in Table Error! Reference source not found..
<p>
</p><hr><h2><kbd>hlike_c.in  </kbd><I>H-like C VI case B
</I></h2><kbd><br>title H-like C VI case B
<br>c
<br>c commands controlling continuum =========
<br>table agn 
<br>ionization parameter 3
<br>c
<br>c commands for density & abundances =========
<br>hden = 8
<br>init file="ism.ini"
<br>element carbon abundance 1
<br>set eden 9
<br>c
<br>c commands controlling geometry  =========
<br>set dr -18
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>case b hummer no photoionization
<br>no induced processes (OK)
<br>constant temperature = 1.e5
<br>c
<br>c commands controlling output    =========
<br>punch results "hlike_c.rlt"
<br>c
<br>c hlike_c.in
<br>c class limit 
<br>c ========================================
<br>c 
<br> 
<br>This test case compares the predictions of the multi-level H-like CVI atom
<br>with the Storey and Hummer (1995) results.  The set dr command sets the
<br>zone thickness to 1 cm.  The case b command sets Lyman line optical depths
<br>to very large values. 
<br>Checks:
<br>-	Neutral fractions
<br>-	H* emissivity
<br>-	Relative line intensities
</kbd><p>
</p><hr><h2><kbd>hlike_o.in  </kbd><I>H-like O VIII case B
</I></h2><kbd><br>title H-like O VIII case B
<br>c
<br>c commands controlling continuum =========
<br>table agn 
<br>ionization parameter 4
<br>c
<br>c commands for density & abundances =========
<br>hden = 8
<br>init file="ism.ini"
<br>element oxygen abundance 1
<br>set eden 9
<br>c
<br>c commands controlling geometry  =========
<br>c set following so the n^2 dr is unity
<br>set dr -18
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>case b hummer no photoionization
<br>no induced processes (OK)
<br>constant temperature = 1.e5
<br>c
<br>c commands controlling output    =========
<br>punch results "hlike_o.rlt"
<br>c
<br>c caseb_o.in
<br>c class limit 
<br>c ========================================
<br>c 
<br> 
<br>This test case compares the predictions of the multi-level H-like O VIII atom
<br>with the Storey and Hummer (1995) results.  The set dr command sets the
<br>zone thickness to 1 cm.  The case b command sets Lyman line optical depths
<br>to very large values. 
<br>Checks:
<br>-	Neutral fractions
<br>-	H* emissivity
<br>-	Relative line intensities
</kbd><p>
</p><hr><h2><kbd>igm_lalpha.in  </kbd><I>Ly alpha forest cloud
</I></h2><kbd><br>title Ly alpha forest cloud
<br>c
<br>c commands controlling continuum =========
<br>c ionized by cosmic background
<br>c plus quasar/starburst continuum 
<br>cmb z=2
<br>table hm05 z = 2
<br>c
<br>c commands for density & abundances =========
<br>hden -2
<br>metals -1.5  ;reduce all heavy elements by 1.5 dex
<br>c
<br>c commands controlling geometry  =========
<br>stop neutral column density 15
<br>double  ; mimic two-siced photoionization
<br>c
<br>c other commands for details     =========
<br>iterate to convergence; must iterate since optically thin
<br>c
<br>c commands controlling output    =========
<br>print line faint -1
<br>punch overview last "igm_lalpha.ovr"
<br>punch dr last "igm_lalpha.dr"
<br>punch results last "igm_lalpha.rlt"
<br>c
<br>c on 05 aug 29 changed from old background command to
<br>c cmb 2 plus hm05 z=2 background - all results changed substantially
<br>c igm_lalpha.in
<br>c class igm 
<br>c ========================================
<br>c 
<br>  
<br>This example demonstrates the behavior of the code in the low-density limit. 
<br>The ionizing source is the cosmic background at a redshift of z = 2. 
<br>The cloud is assumed to be optically thin to ionizing radiation,
<br>in keeping with the Gunn-Peterson test, so the double command is included,
<br>and an iteration is performed to converge the optical depth scale. 
<br>Continuum fluorescent excitation of lines is important because the cloud
<br>is otically thin.
</kbd><p>
</p><hr><h2><kbd>igm_primal.in  </kbd><I>cloud with primordial abundances exposed to background at Z=10
</I></h2><kbd><br>title cloud with primordial abundances exposed to background at Z=10
<br>c
<br>c commands controlling continuum =========
<br>background, redshift= 10
<br>c background due to agn from Haardt & Madau 1996 ApJ, 461, 20
<br>c this sets both continuum shape and intensity, actually for z=2
<br>table HM96 old
<br>c
<br>c other commands for details     =========
<br>c put in a velocity field to stop Lya from causing stability problems
<br>turbulence 20 km/s
<br>c do a second iteration to establish that it is optically thick downstream
<br>iterate
<br>c this sim should run cleanly - do not accept problems
<br>failures 2 
<br>c
<br>c commands for density & abundances =========
<br>c this log of the hydrogen density
<br>hden 5
<br>c stored set of primordial abundances 
<br>abundances primordial
<br>c
<br>c commands controlling geometry  =========
<br>c we want to shielded face to not be exposed to empty space, but rather
<br>c be just very deep in a dense cloud - this prevents lines from freely
<br>c radiating from the shielded face
<br>double optical depths 
<br>c set a lower temperature stopping criterion - default is 4000K
<br>stop temperature 30
<br>c
<br>c commands controlling output    =========
<br>c don't want to print lots of faint hydrogen lines
<br>print line faint -3
<br>c some output files with info we want to save 
<br>punch temperature history "igm_primal_tem.his"
<br>punch ionizing continuum "igm_primal.ion"
<br>punch hydrogen conditions "igm_primal.mol"
<br>punch heating "igm_primal.het"
<br>punch dr "igm_primal.dr"
<br>punch cooling "igm_primal.col"
<br>punch overview "igm_primal.ovr"
<br>punch results last "igm_primal.rlt"
<br>c
<br>c igm_primal.in
<br>c class hii pdr igm
<br>c ========================================
<br> 
<br>This is a high redshift cloud irradiated by the cosmic background and AGN light.
<br>H- absorption of the z=10 cosmic background is a MAJOR heating agent
<br>This model is very sensitive to treatment of Lya destruction, since resulting
<br>J-bar is major destruction process for H-, which is the H2 formation route.
<br>Lya ots oscillations could develop and are damped by not reevaluating H-
<br>photo rate after first n times, as in hmole.c 
</kbd><p>
</p><hr><h2><kbd>igm_z3.in  </kbd><I>redshift 1000 recombination epoch
</I></h2><kbd><br>title redshift 1000 recombination epoch
<br>c
<br>c commands controlling continuum =========
<br>c a true blackbody radiation field, in strick thermo equilibrium
<br>blackbody 3000 STE
<br>c
<br>c commands for density & abundances =========
<br>hden 0
<br>abundances primordial
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>case b 
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>normalize lines to "Ca B" 4861
<br>print ages
<br>print departure coef
<br>print line faint -5
<br>c
<br>c igm_z3.in
<br>c class limit igm
<br>c ========================================
<br>c 
</kbd><p>
This is a model of the universe near the recombination epoch, at
a redshift of a thousand.  The gas is exposed to a true blackbody at
3000 K, and the abundances are primordial.  
<p>
<p>
</p><hr><h2><kbd>ism.in  </kbd><I>cloud irradiated by ism background
</I></h2><kbd><br>title cloud irradiated by ism background
<br>c
<br>c commands controlling continuum =========
<br>c this uses the Black continuum with no H-ionizing radiation,
<br>c and with background cosmic rays
<br>table ism
<br>extinguish by a column of 22
<br>c need cosmic rays to provide ionization to the chemistry
<br>cosmic rays, background
<br>c
<br>c commands for density & abundances =========
<br>hden 0
<br>init file="ism.ini"
<br>abundances ism 
<br>c
<br>c commands controlling geometry  =========
<br>c set sphere since matter in all directions
<br>sphere 
<br>stop temperature linear 10
<br>stop thickness 0.1 linear parsecs
<br>c
<br>c other commands for details     =========
<br>c this prevents continuum pumping from exciting H0
<br>case b
<br>c this is to converge optical depths
<br>iterate
<br>c this should have no effect since T is larger than 100 K
<br>set temperature floor 100K
<br>c
<br>c commands controlling output    =========
<br>c this model has no heavy element molecules, because H2 does not
<br>c really fully form, since Lyman bands are not self-shielded
<br>normalize to 157.6m "C  2"
<br>print line pump
<br>punch overview "ism.ovr" last
<br>punch dr "ism.dr" 
<br>punch heating "ism.het" 
<br>punch coolign "ism.col" 
<br>c
<br>c ism.in
<br>c class ism 
<br>c ========================================
</kbd><p>
TODO - look at temperature struture - it has jitter at about the
level of convergence, up and down.  Temp jitter caused by eden jitter.
This model is nearly isothermal, jitter measures noise in solver,
and is great chance to pin this down.
<p>
This is a test of the behavior of the code in the extreme of
photoionization by a relatively hard continuum, at low densities.
The continuum is the galactic background, attenuated by a column density
of 10^22 cm-2.  Ionization by galactic background cosmic rays is included. 
Case b appears since this region is deep in the ISM, and the Lyman lines
are quite thick.  This example checks whether the ionization balance,
thermal balance, and electron density sum, are performed correctly in
this limit.
<p>
<br>Checks:
<br>-	Numerical stability of solution
<br>-	Thickness exact 
<p>
</p><hr><h2><kbd>ism_cosmicray.in  </kbd><I>background cosmic ray ionization by suprathermal electrons only
</I></h2><kbd><br>title background cosmic ray ionization by suprathermal electrons only
<br>c
<br>c commands controlling continuum =========
<br>c background CR H0 ionization rate should be 2.5e-17 s^-1,
<br>c Williams et al. ApJ, 503, 689
<br>cosmic rays, background
<br>c this will be VERY faint black 50000
<br>ionization parameter -25
<br>black 50000 
<br>c
<br>c commands for density & abundances =========
<br>hden 5
<br>c
<br>c commands controlling geometry  =========
<br>set dr 0 
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>iterate
<br>set temperature floor 1000 K
<br>c turn off molecules to test only ions 
<br>no molecules 
<br>c must turn off charge transfer and its heating, which would dominate,
<br>c since we want to test cr heating and ionization
<br>no charge transfer
<br>no ctheat
<br>c must turn of  photoionization by recombining species,
<br>c since we want to test cr heating and ionization
<br>no photoionization
<br>c any time photoionization is turned off, it is best to also
<br>c turn off induced processes, which include pumping in the lyman lines
<br>no induced processes
<br>c
<br>c commands controlling output    =========
<br>print ages
<br>c
<br>c ism_cosmicray.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This test conditions of cosmic ray ionization.  Molecules and charge transfer
are disabled so that analytical estimates can be made.  
<p>
</p><hr><h2><kbd>ism_grid.in  </kbd><I>interstellar cloud irradiated by ism background
</I></h2><kbd><br>title interstellar cloud irradiated by ism background
<br>c
<br>c commands controlling continuum =========
<br>c this uses the Black continuum with no H-ionizing radiation,
<br>c and with background cosmic rays
<br>table ism
<br>extinguish by a column of 22
<br>cosmic rays, background
<br>c
<br>c commands for density & abundances =========
<br>hden 0 vary
<br>grid from -3 to 2 in 0.5 dex steps
<br>init file="ism.ini"
<br>c this turns on ism abundances and grains
<br>abundances ism
<br>c
<br>c commands controlling geometry  =========
<br>c set sphere since matter in all directions
<br>sphere 
<br>stop temperature linear 10
<br>stop thickness 0.1 linear parsecs
<br>stop zone 1 
<br>c
<br>c other commands for details     =========
<br>c this prevents continuum pumping from exciting H0
<br>case b
<br>c
<br>c commands controlling output    =========
<br>c this model has no heavy element molecules, because H2 does not
<br>c really fully form, since Lyman bands are not self-shielded
<br>normalize to 157.6m "C  2"
<br>punch grid "ism_grid.grd" last
<br>punch averages "ism_grid.avr" last
<br>temperature hydrogen 1 
<br>end of averages
<br>punch overview "ism_grid.ovr" last
<br>punch dr "ism_grid.dr"
<br>punch heating "ism_grid.het" 
<br>punch coolign "ism_grid.col" 
<br>punch xspec mtable "ism_grid.fit" range 0.1 3 keV
<br>punch temperature "ism_grid.tem" 
<br>c
<br>c this is a special version of the assert that does a series of models 
<br>c sert tempe hydro 1 9942 .05 grid 8575 6468 3606 776 304 169 103 66.2 44.1 31.3
<br>c
<br>c ism_grid.in
<br>c class ism 
<br>c ========================================
</kbd><p>
this shows an S-curve calculation - make plot showing density as X-axis
and gas pressure (nT) as y-axis
<p>
the gas is ionized by the galactic background.  the density varies between
1e-3 and 100 cm-3.  this is the full range found in the diffuse ism.
The components that are produced are 
CNM - cold neutral medium, density ~ 40 cm-3
WNM - n ~ 0.5 cm-3, 
WIM - warm ionized medium, n ~ 0.25 cm-3
HIM - hot ionized medium, n ~ 1e-3 cm-3, calculation DOES NOT 
      reproduce observed temperature of HIM - we get ~1e4K but
      observed is ~1e6 K.  HIM is shock, not photo, ionized
<p>
<p>
</p><hr><h2><kbd>ism_hot_brems.in  </kbd><I>generate continuum due to hot ism in high Z,z starburst
</I></h2><kbd><br>title generate continuum due to hot ism in high Z,z starburst
<br>c 
<br>c commands controlling continuum =========
<br>c this sets up coronal equilibrium for temperature and continuum
<br>c cloud is predominantly collisionally ionized
<br>coronal equilibrium, t = 1.e6 K
<br>c
<br>c commands for density & abundances =========
<br>c log of hydrogen density (cm-3), by default a constant density model
<br>hden 1
<br>c chemical composition for a well-evolved star cluster with high Z
<br>c the starburst command generates scale factors that will be used to
<br>c multiply the old solar composition, used in ver 84.  this is maintain
<br>c record of physical changes
<br>abundances old solar 84 
<br>abundances starburst Z=10 Zsun
<br>c
<br>c commands controlling geometry  =========
<br>c the log of the total hydrogen column density, cm-2
<br>stop column density 21
<br>c
<br>c other commands for details     =========
<br>c  continuum is plotted in Hzay, we me must iterate to predict this
<br>iterate
<br>c 
<br>c commands controlling output    =========
<br>c normalize to O 7 Lya
<br>normalize to "O  7" 21.60 
<br>c this shortens the printout somewhat
<br>print line faint 1
<br>c output options
<br>punch continuum last "ism_hot_brems.con" no title, units keV
<br>punch sulphur ionization "ism_hot_brems.sul"
<br>punch overview last "ism_hot_brems.ovr"
<br>c this is only to document the problem described above
<br>punch dr last "ism_hot_brems.dr"
<br>c
<br>c ism_hot_brems.in
<br>c class ism 
<br>c ========================================
<br>c 
</kbd><p>
This model generates a large column constant density cloud
similar to the hot phase of the interstellar medium. 
The continuum is punched to generate one of the figures in Part 2 of Hazy.
<p>
There is a strange feature between 1.7e-3A and 2.2e-3A that is the N emission
(head starting at 1.7e-3A with O absorption at 2.2e-3A.  This model is
strongly enriched in heavies so many metal edges, esp O, are optically thick.
<p>
>>TODO	1	the guess of the thickness of the first zone is badly too small,
because this model is collisionally ionized, and it used Stromgren
length - better to use collisional balance and dr - as result of this
the model takes far too many zones
</p><hr><h2><kbd>ism_jura.in  </kbd><I>check rate H2 forms on grain surfaces 
</I></h2><kbd><br>title check rate H2 forms on grain surfaces 
<br>c
<br>c commands controlling continuum =========
<br>c first continuum is FIR hot grain continuum produced in 
<br>c unmodeled HII Region
<br>blackbody, t = 75 K
<br>intensity 2.7 (total)
<br>c this is hot star continuum
<br>black 30000
<br>intensity  1.90 range  0.4412 to 1 Ryd
<br>c this will remove all ionizing radiation
<br>extinguish 24 0
<br>cosmic rays, background
<br>c
<br>c commands for density & abundances =========
<br>hden 0
<br>grains ism, abundance log 0.16 no qheat 
<br>init file="ism.ini"
<br>abundances he -1.01 c -3.52 n-8 o-3.30 ne-8 mg-5.89
<br>continue si -6.10 s -5.10 cl=-7 ar-8 fe -6.60
<br>c
<br>c commands controlling geometry  =========
<br>sphere
<br>c stop when gas is fully neutral
<br>stop efrac -10
<br>c stop when gas is cold
<br>stop temperature 10 linear
<br>stop zone 1 
<br>c
<br>c other commands for details     =========
<br>c set the gas temperature
<br>constant temperature 100 K
<br>case b
<br>c
<br>c commands controlling output    =========
<br>normalize to "C  2" 157.6m 
<br>c uv lines are strongly pumped by stellar continuum, break out contribution
<br>print line pump
<br>print line optical depths
<br>print ages
<br>punch hydrogen 21 cm last "ism_jura.21cm"
<br>c
<br>c ism_jura.in
<br>c class limit  
<br>c ========================================
<br>c 
</kbd><p>
This model started out life as the Tielens & Hollenbach 1985 pdr.  The
density was set to unity and the incident radiation field adjusted so
that the two default grains have temperatures near 100K.  The model
asserts that the H2 formation rate on grain surfaces is close to the
//>>refer	H2	grain physics	Jura, M., 1975, ApJ, 197, 575
rate.
</p><hr><h2><kbd>ism_opacity.in  </kbd><I>generate standard ISM opacity curve
</I></h2><kbd><br>title generate standard ISM opacity curve
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>ionization parameter -3
<br>c
<br>c commands for density & abundances =========
<br>grains no qheat
<br>c
<br>c commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>punch total opacity last "ism_opacity.opc" units kev
<br>c
<br>c ism_opacity.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This example creates the file ism_opacity.opc which tabulates
the total opacity of the gas as a function of energy.  These
plots are used in ISM studies to understand the transmission
characteristics along a line of sight.  The opacity depends on 
the dust to gas ratio, the gas phase abundances, and the level
of ionization, all of which can be changed by altering parameters
given above.
<p>
The model is of a 1 cm think parcel of gas which is optically thin 
in the Lyman continuum and Lyman lines.  As a result the hydrogen
emission line spectrum is close to case C.  The model iterates
so that the predicted ionization and emission know about this.
</p><hr><h2><kbd>ism_set_cr_rate.in  </kbd><I>background cosmic ray ionization by suprathermal electrons only
</I></h2><kbd><br>title background cosmic ray ionization by suprathermal electrons only
<br>c
<br>c commands controlling continuum =========
<br>cosmic ray rate -16
<br>c this will be VERY faint black 50000
<br>ionization parameter -25
<br>black 50000 
<br>c
<br>c commands for density & abundances =========
<br>hden 5
<br>element hydrogen ionization 1 0.00000001
<br>c
<br>c commands controlling geometry  =========
<br>set dr 0 
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>constant temperature 1000 K
<br>c turn off molecules to test only ions 
<br>no molecules 
<br>c must turn off charge transfer and its heating, which would dominate,
<br>c since we want to test cr heating and ionization
<br>no charge transfer
<br>no ctheat
<br>c must turn of  photoionization by recombining species,
<br>c since we want to test cr heating and ionization
<br>no photoionization
<br>c any time photoionization is turned off, it is best to also
<br>c turn off induced processes, which include pumping in the lyman lines
<br>no induced processes
<br>c
<br>c commands controlling output    =========
<br>print ages
<br>c
<br>c ism_set_cr_rate.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This test conditions of cosmic ray ionization.  Molecules and charge transfer
are disabled so that analytical estimates can be made.  
<p>
</p><hr><h2><kbd>limit_casea_h_den13.in  </kbd><I>case A
</I></h2><kbd><br>title case A
<br>c 
<br>c Seaton, M.J, 1959 MN 119, 90, 
<br>c 4pi j(beta) 5.56E-26
<br>c for this model total H-beta=4.745
<br>c b(2)=3.73E-3 (3)=3.69E-2 (4)=0.091 (5)=0.145 (6)=0.193
<br>c n.b. very different results if not l-mixed
<br>c
<br>c commands controlling continuum =========
<br>black body, T = 50000 K
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>hden = 13;
<br>init file="honly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop lyman optical depth -6
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>no induced processes (OK) ;N.B. case A is a fiction; no incuded transitions
<br>atom h-like collisions off ; must turn off all collisions 
<br>constant temperature = 10000 K
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>c this should make the predicted totl Hbeta near unity for case a
<br>normalize to "CaBo" 4861 = 2.23
<br>print populations h-like 
<br>print departure coefficients
<br>c
<br>c limit_casea_h_den13.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
Case A is a mathematical fiction; when the Lyman lines are
optically thin continuum pumping must be important if the gas
is ionized.  Fluorescence is turned off with the
no induced processes command.  The density is set to a
very high value (1015 cm-3) so that the 2s-2p states are well l-mixed,
in keeping with standard case A assumptions.  As a result,
collisional excitation would dominate the level populations,
and hydrogen collisions must be turned off with the hydrogen collisions off
command.  The Ly* optical depth is set to a small value.
The set dr command sets the zone thickness to 1 cm.
The abundances are set to a very small value so that the
electron density is equal to the hydrogen density. 
<br>Checks:
<br>-	Departure coefficients for H, He levels
<br>-	Neutral fractions
<br>-	H* emissivity
<p>
</p><hr><h2><kbd>limit_casea_h_den_temp.in  </kbd><I>Test model H in Case A limit
</I></h2><kbd><br>title Test model H in Case A limit
<br>c grid over nebular range of density and temperature to check Case A H
<br>c
<br>c commands controlling continuum =========
<br>c create H+ 
<br>laser 2 Ryd
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>init "honly.ini"
<br>hden 2. vary
<br>grid 2 6 2
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>no scattering escape
<br>case A hummer no Pdest no photoionization
<br>no induced processes
<br>constant temperature 4. vary
<br>grid 5,000K to 20,000K in 5,000K steps
<br>c
<br>c commands controlling output    =========
<br>atom H-like print levels
<br>c 
<br>c fixit the wavelength range is adjusted to avoid the Lyman lines
<br>c the Lyman a / 2 photon ratio is wrong at high Tempetaure -
<br>c is there a temperature dependent branching ratio to n=2 out
<br>c of the collapsed level?
<br>c 
<br>c limit_casea_h_den_temp.in 
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
this tests the predicted H I and He I spectra in the Case B limit.
The grid is over both density and temperature.
<p>
</p><hr><h2><kbd>limit_caseb_h_hs87.in  </kbd><I>"Case B from Hummer and Storey"
</I></h2><kbd><br>title "Case B from Hummer and Storey"
<br>init "honly.ini"
<br>laser 1.1
<br>ionization parameter -1
<br>constant temperature 4
<br>case b hummer no photoionization no pdest
<br>atom h-like element hydrogen levels resolved 30
<br>no induced processes
<br>no level2
<br>no scattering escape
<br>set dr -20
<br>hden 4  
<br>stop zone 1
<br>iterate
<br>print populaions h-like
<br>print departure h-like
<br>c 
<br>c
<br>c limit_caseb_h_hs87.in
<br>c class limit
</kbd><p>
</p><hr><h2><kbd>limit_caseb_h_lot.in  </kbd><I>log density case B, T=500 log n=2
</I></h2><kbd><br>title log density case B, T=500 log n=2
<br>c
<br>c commands controlling continuum =========
<br>black body, T = 2.e5 K
<br>ionization parameter -1
<br>c
<br>c commands for density & abundances =========
<br>hden = 2
<br>init file="honly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>constant temperature = 500
<br>c want H and he fully stripped so we can check H He spectra
<br>case b hummer no photoionization no pdest
<br>no induced processes (OK) 
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>print diffuse continua
<br>normalize to "Ca B" 4861
<br>c
<br>c does not agree with Hummer & Storey, as explained by Ferguson & Ferland
<br>c until 03 jun 02, used small atom, which had smaller differences
<br>c turn on large atom to get best answer
<br>atom h-like levels resolved 20
<br>c
<br>punch results "limit_caseb_h_lot.rlt" last
<br>c
</kbd><p>
c limit_caseb_h_lot.in
c class limit 
c ========================================
c 
<p>
This tests the ionization and emission line spectrum for 
H case B at a low density and temperature.
</p><hr><h2><kbd>limit_caseb_h_n8.in  </kbd><I>h_caseb_n8 high density case B
</I></h2><kbd><br>title h_caseb_n8 high density case B
<br>c
<br>c commands controlling continuum =========
<br>black body, T = 2.e5 K
<br>ionization parameter -1
<br>c
<br>c commands for density & abundances =========
<br>hden = 8
<br>init file="honly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>c this will not affect the main model, but will test CR heating rate
<br>cosmic ray background
<br>case b hummer no photoionization no Pdest 
<br>no scattering escape
<br>no induced processes (OK)
<br>constant temperature = 20000
<br>iterate 
<br>c
<br>c commands controlling output    =========
<br>normalize to "Ca B" 4861
<br>punch results "limit_caseb_h_n8.rlt"
<br>punch ionizing continuum "limit_caseb_h_n8.cion"
<br>c
<br>c
<br>c limit_caseb_h_n8.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This test case compares the predictions of the multi-level hydrogen atom
with the Storey and Hummer (1995) results.  The set dr command sets the
zone thickness to 1 cm.  The case b command sets Lyman line optical depths
to very large values. 
<br>Checks:
<br>-	Neutral fractions
<br>-	H* emissivity
<br>-	Relative line intensities
<p>
high density causes disagreemeent with HS - collisions
</p><hr><h2><kbd>limit_caseb_he2_den8.in  </kbd><I>limit_caseb_he2_den8 He II case B
</I></h2><kbd><br>title limit_caseb_he2_den8 He II case B
<br>c
<br>c commands controlling continuum =========
<br>table agn 
<br>ionization parameter 0
<br>c
<br>c commands for density & abundances =========
<br>hden = 8
<br>element helium abundance 1
<br>init file="ism.ini"
<br>c
<br>c commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>atom h-like element helium levels resolved 15 
<br>case b hummer no photoionization no Pdest 
<br>no induced processes (OK)
<br>constant temperature = 50,000K
<br>c
<br>c commands controlling output    =========
<br>punch results "limit_caseb_he2_den8.rlt"
<br>c
<br>c
<br>c limit_caseb_he2_den8.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This test case compares the predictions of the multi-level hydrogen atom
with the Storey and Hummer (1995) results.  The set dr command sets the
zone thickness to 1 cm.  The case b command sets Lyman line optical depths
to very large values. 
<br>Checks:
<br>-	Neutral fractions
<br>-	H* emissivity
<br>-	Relative line intensities
<p>
</p><hr><h2><kbd>limit_caseb_he_den.in  </kbd><I>Test model H and He atoms in Case B limit
</I></h2><kbd><br>title Test model H and He atoms in Case B limit
<br>c grid over nebular range of density and temperature to check Case B H & He
<br>c
<br>c commands controlling continuum =========
<br>laser 5 Ryd
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>init "hheonly.ini"
<br>hden 2. vary
<br>grid 2 6 2
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>normalize to "He 2" 4686
<br>case b hummer no Pdest no photoionization
<br>no scattering escape 
<br>c prevent H I excited levels from being predicted
<br>atom H-like element hydrogen levels 3
<br>constant temperature 4.
<br>c
<br>c commands controlling output    =========
<br>atom H-like print levels 
<br>c 
<br>c 
<br>c limit_caseb_he_den.in 
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
this tests the predicted He II spectra in the Case B limit.
<p>
this effectively turns off hydrogen to avoid the problem with every
other heII line lying beneath an HI line.  this is done by reducing
the number of levels for H I.
<p>
this asserts the values are within 9% for the standard T = 1e4K and
a range of densities.  Actually they are all nearly within a few
percent except at the lowest temperature of 5,000K.
</p><hr><h2><kbd>limit_caseb_he_den4_temp4.in  </kbd><I>the best we can do to predict the HeI emission spectrum 
</I></h2><kbd><br>title the best we can do to predict the HeI emission spectrum 
<br>c
<br>c commands controlling continuum =========
<br>laser 2
<br>ionization -1
<br>c
<br>c commands for density & abundances =========
<br>hden 9000 linear 
<br>set eden 4
<br>element helium abundance -1
<br>init file "hheonly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set dr -6.95424
<br>c
<br>c other commands for details     =========
<br>atom he-like levels 30
<br>atom he-like collapsed levels 70
<br>atom he-like gbar vriens
<br>constant temper 4
<br>case b no photoionzation no pdest 
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>normalise to "He 1" 4471
<br>print departure he-like helium
<br>print line faint 0.01
<br>c punch fits last "limit_caseb_he_den4_temp4.fit"
<br>punch diffuse continuum "limit_caseb_he_den4_temp4.dif" last no title units microns
<br>punch continuum "limit_caseb_he_den4_temp4.con" last no title units microns
<br>c
<br>c
<br>c limit_caseb_he_den4_temp4.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This is close to the best and most complete model of He I
that the code can do.  it is not hacked to try to reproduce HS?
<p>
</p><hr><h2><kbd>limit_caseb_he_den_temp.in  </kbd><I>Test model He atoms in Case B limit
</I></h2><kbd><br>title Test model He atoms in Case B limit
<br>c grid over nebular range of density and temperature to check Case B H & He
<br>c
<br>c commands controlling continuum =========
<br>laser 5 Ryd
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>init "hheonly.ini"
<br>hden 2. vary
<br>grid 2 6 2
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>normalize to "He 2" 4686
<br>case b hummer no Pdest no photoionization
<br>no scattering escape 
<br>c prevent H I excited levels from being predicted
<br>atom H-like element hydrogen levels 3
<br>constant temperature 4. vary
<br>grid 5,000K to 20,000K in 5,000K steps
<br>c
<br>c commands controlling output    =========
<br>atom H-like print levels 
<br>c 
<br>c 
<br>c limit_caseb_he_den_temp.in 
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
this tests the predicted He II spectra in the Case B limit.
<p>
this effectively turns off hydrogen to avoid the problem with every
other heII line lying beneath an HI line.  this is done by reducing
the number of levels for H I.
<p>
this asserts the values are within 15% for a range of density and temperature.
Actually they are all nearly within a few percent except at the lowest
temperature.  The error greater than 10% occurs at the lowest temperature
of 5,000K.
</p><hr><h2><kbd>limit_caseb_hhe_den.in  </kbd><I>Test model H and He atoms in Case B limit
</I></h2><kbd><br>title Test model H and He atoms in Case B limit
<br>c grid over nebular range of density and temperature to check Case B H & He
<br>c
<br>c commands controlling continuum =========
<br>c create H+ and He+
<br>laser 2.0 Ryd
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>init "hheonly.ini"
<br>hden 2. vary
<br>grid 2 6 2
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>no scattering escape
<br>case b hummer no Pdest no photoionization
<br>constant temperature 4.
<br>c
<br>c commands controlling output    =========
<br>atom H-like print levels
<br>c 
<br>c 
<br>c limit_caseb_hhe_den.in 
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
this tests the predicted H I and He I spectra in the Case B limit.
<p>
the grid is over density at the standard temperature of 1e4 K.
</p><hr><h2><kbd>limit_caseb_hhe_den_temp.in  </kbd><I>Test model H and He atoms in Case B limit
</I></h2><kbd><br>title Test model H and He atoms in Case B limit
<br>c grid over nebular range of density and temperature to check Case B H & He
<br>c
<br>c commands controlling continuum =========
<br>c create H+ and He+
<br>laser 2 Ryd
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>init "hheonly.ini"
<br>hden 2. vary
<br>grid 2 6 2
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>no scattering escape
<br>case b hummer no Pdest no photoionization
<br>constant temperature 4. vary
<br>grid 5,000K to 20,000K in 5,000K steps
<br>c
<br>c commands controlling output    =========
<br>atom H-like print levels
<br>c 
<br>c 
<br>c limit_caseb_hhe_den_temp.in 
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
this tests the predicted H I and He I spectra in the Case B limit.
The grid is over both density and temperature.
<p>
</p><hr><h2><kbd>limit_casec_h_den2.in  </kbd><I>H only optically thin in Lyman continuum
</I></h2><kbd><br>title H only optically thin in Lyman continuum
<br>c
<br>c commands controlling continuum =========
<br>blackbody 40000
<br>ionization -2
<br>c
<br>c commands controlling geometry  =========
<br>stop thickness 16 
<br>c
<br>c commands for density & abundances =========
<br>hden 2
<br>init file "honly.ini"  
<br>c
<br>c other commands for details     =========
<br>iterate
<br>constant temper 10000
<br>no level2
<br>c
<br>c commands controlling output    =========
<br>print diffuse continuum
<br>print line inward
<br>normalize to "Ca B" 4861 = 1 % normalize to exact result 
<br>punch overview "limit_casec_h-den2.ovr"  last
<br>punch fine optical depths last "limit_casec_h-den2.fin" range 0.9 1.02 every 1
<br>punch optical depths last "limit_casec_h-den2.opt" 
<br>punch continuum "limit_casec_h-den2.con"  last units microns
<br>punch dr "limit_casec_h-den2.dr"  last
<br>c
<br>c limit_casec_h-den2.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This is a pure hydrogen cloud that is optically thin in the Lyman continuum.
The asserts check the emission in several H I lines and continua.
This should be close to what really happens in a low column density
cloud exposed to a continuum source that does not have strong Lyman lines.
(The continuum source used is a pure blackbody, and so has no lines).
So this is an example of "Case C" emission 
>>refer	H	case C	Ferland, G.J. 1999, PASP, 111, 1524
<p>
</p><hr><h2><kbd>limit_casec_h_den5.in  </kbd><I>case C
</I></h2><kbd><br>title case C
<br>c
<br>c commands controlling continuum =========
<br>black body, T = 50000 K
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>hden = 5
<br>init file="hheonly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>set dr -10
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>iterate
<br>stop lyman optical depth -6
<br>constant temperature = 10000 K
<br>c
<br>c commands controlling output    =========
<br>normalize to "Ca B" 4861
<br>print h-like populations 
<br>print departure coefficients
<br>c
<br>c limit_casec_h_den5.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
<p>
This is Case C, what really happens when optically thin gas is
irradiated by a continuum with Lyman line continuum fluorescence allowed.
<br>Checks:
<br>-	Departure coefficients for H, He levels
<br>-	Neutral fractions
<br>-	H* emissivity
Case C is described in
<p>
>>refer	H	case C	Ferland, G.J. 1999, PASP, 111, 1524
<p>
</p><hr><h2><kbd>limit_compton_hi_t.in  </kbd><I>test high-T Compton energy exchange
</I></h2><kbd><br>title test high-T Compton energy exchange
<br>c
<br>c commands controlling continuum =========
<br>c as hot as STE bb can be on IEEE 32-bit cpu
<br>c equilibrium temperature should also be 2.51e7
<br>c since gas radiated by true blackbody will equilibriate
<br>c at its temperature 
<br>blackbody 7.4 STE 
<br>c
<br>c commands for density & abundances =========
<br>hden 10
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>atom h-like element oxygen levels 5
<br>atom h-like element oxygen levels collapsed 30
<br>set temperature convergence 0.0001
<br>iterate
<br>print h-like departure element oxygen
<br>c
<br>c commands controlling output    =========
<br>c
<br>c limit_compton_hi_t.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This is the highest Compton temperature that can be computed in
LTE on an IEEE 32-bit processor.  This tests the code in the
high-temperature Compton limit. Temperatures as high as 10^10 K
can be computed successfully on CPUs with longer word lengths,
such as a Cray or the new 64 bit processors. 
<p>
<br>Checks:
<br>-	The equilibrium temperature should be exactly 107.4 K (2.51239107 K).
<p>
</p><hr><h2><kbd>limit_compton_lo_t.in  </kbd><I>test low-T Compton energy exchange
</I></h2><kbd><br>title test low-T Compton energy exchange
<br>c
<br>c commands controlling continuum =========
<br>black linear 3 lte
<br>brems 5
<br>ionizat -5
<br>c
<br>c commands for density & abundances =========
<br>hden -10
<br>init file "hheonly.ini"
<br>eden 0
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>set temperature convergence 0.0001
<br>iterate 3
<br>c
<br>c commands controlling output    =========
<br>c
<br>c limit_compton_lo_t.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This tests the code in the low temperature Compton limit.  The gas is
illuminated by a 3 K blackbody in thermodynamic equilibrium. 
The equilibrium temperature should be exactly 3 K. 
It is necessary to add an extra component of free electrons to
test the code in this limit with the eden command.  
<p>
</p><hr><h2><kbd>limit_compton_mid_t.in  </kbd><I>mid-T Compton energy exchange
</I></h2><kbd><br>title mid-T Compton energy exchange
<br>c test of thermal equil in limit_compton_mid_t limit; temp should EXACTLY equal 2E5K
<br>c check continuum partition;
<br>c energy range, photon densities, luminosities, follow
<br>c 0.25-1.  Q=26.6470 L=15.8190     c 1-1.807  Q=26.8867 L=16.3766
<br>c 1.807-4  Q=27.3042 L=17.0948     c 4-20     Q=27.2041 L=17.3179
<br>c 20 --    Q=22.9038 L=22.9038     c total lumin 17.5597
<br>c nufnu(912A) = 1.8029E+16
<br>c
<br>c commands controlling continuum =========
<br>black body t = 2.e5 K lte
<br>c
<br>c commands for density & abundances =========
<br>hden = 6
<br>init file "hheonly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>stop lyman continuum optical depth = -6
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>set temperature convergence .0001  % decrease error on heat-cool match
<br>c
<br>c commands controlling output    =========
<br>print line faint .1
<br>print departure coef
<br>c
<br>c limit_compton_mid_t.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This tests the behavior of the code in the Compton limit.
The incident continuum is a blackbody in strict thermodynamic equilibrium.
Strict thermodynamic equilibrium is expected for all constituents of the gas.
The input stream also lists the expected photon fluxes for the incident
continuum; this tests the normalization of the continuum,
and its distribution. Grains are included to confirm their behavior
in the LTE limit. The set dr command sets the zone thickness to 1 cm. 
<p>
<br>Checks:
<br>-	Luminosity, photon flux, over various energy intervals, 4*J at 912143.
<br>-	Electron temperature exactly 2*105 K.
<br>-	Grain temperature forced to 2*105 K by radiative processes.
<p>
</p><hr><h2><kbd>limit_conserve.in  </kbd><I>test that energy is limit_conserved
</I></h2><kbd><br>title test that energy is limit_conserved
<br>* trace temperature convergence 0 2 
<br>c
<br>c commands controlling continuum =========
<br>c primary continuum is a hot blackbody
<br>black body, temp=5.5
<br>intensity total -4
<br>c add cosmic background 
<br>backbround
<br>c
<br>c commands controlling geometry  =========
<br>c don't stop the calculation until all energy used up
<br>c in order to check energy conservation 
<br>stop temperature 3 linear
<br>c cloud will go very deep with temperature near 3K without this
<br>stop thickness 20 
<br>c
<br>c commands for density & abundances =========
<br>no molecules
<br>metals -0.5
<br>hden 1.0
<br>constant pressure
<br>c
<br>c other commands for details     =========
<br>iterate 
<br>c want a clean calculation
<br>failures 3
<br>c this allows for more molecular gas beyond what we model
<br>double optical depths
<br>c must increase number of levels since so optically thick
<br>atom co levels 30 
<br>c
<br>c commands controlling output    =========
<br>punch pressure "limit_conserve.pre"
<br>punch pressure history "limit_conserve.his"
<br>punch cooling "limit_conserve.col"
<br>punch heating "limit_conserve.het" 
<br>punch dr "limit_conserve.dr"
<br>punch overview "limit_conserve.ovr1"
<br>punch overview last "limit_conserve.ovr"
<br>punch results "limit_conserve.rlt"
<br>punch element carbon "limit_conserve.car"
<br>punch element neon "limit_conserve.ne" 
<br>punch element magnesium "limit_conserve.mag"
<br>punch element silicon "limit_conserve.sil"
<br>punch molecules "limit_conserve.mol"
<br>c
<br>c limit_conserve.in
<br>c class hii pdr  
<br>c ========================================
</kbd><p>
This checks that energy is limit_conserved. The code always checks
that it did not radiate more energy than was absorbed.  This
calculation extends well past the photo-dissociation zone into
fully molecular gas, so that all of the incident radiation is absorbed.  
Grains, CMB, & CRs are not present so that only the incident radiation field
powers the gas.
<p>
Small changes can affect this model to surprising extents because 
of the presence of a major thermal front at the H0 - H+ transition region.
</p><hr><h2><kbd>limit_eden.in  </kbd><I>Martin Gaskell's funny model
</I></h2><kbd><br>title Martin Gaskell's funny model
<br>c used to test that electron density convergence is ok
<br>c hydrogen line spectrum strongly pumped by continuum
<br>c all elements > H have HIGH abundances 
<br>c ionization of elements Fe, Mg, Si strongly affected
<br>c by charge transfer
<br>c
<br>c commands controlling continuum =========
<br>black 4000
<br>lumin 27.2
<br>c
<br>c commands for density & abundances =========
<br>hden 5.138
<br>abundances all 1000
<br>c
<br>c commands controlling geometry  =========
<br>radius 15
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>constant temper 5500
<br>c
<br>c commands controlling output    =========
<br>print line faint -3
<br>c
<br>c limit_eden.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This is mainly a test of the ability of the code to converge a model
with a very strange electron density. The electrons are mainly contributed
by heavy elements, and the gas is only slightly ionized. 
<p>
Ionization of elements Fe, Mg, Si strongly affected by charge transfer
with other heavy elements.
<p>
<br>Checks:
<br>-	Electron density is correct.
<br>-	Hydrogen line spectrum strongly pumped by continuum.
<p>
</p><hr><h2><kbd>limit_h_induc.in  </kbd><I>constant temper black body limit from Ferland and Rees 1988
</I></h2><kbd><br>title constant temper black body limit from Ferland and Rees 1988
<br>c tests whether departure coef are forced to unity by induced processes
<br>c
<br>c commands controlling continuum =========
<br>black body, t = 50000 lte
<br>c
<br>c commands for density & abundances =========
<br>hden 10
<br>init file="hheonly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop lyman continuum optical depth -6
<br>set dr -10
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>iterate 
<br>constant temper 50000
<br>c
<br>c commands controlling output    =========
<br>print populations h-like
<br>print heating
<br>print departure coef
<br>print line faint -1
<br>c
<br>c limit_h_induc.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This example tests whether induced processes force level populations
of hydrogen to LTE when they are irradiated by a
blackbody in strict thermodynamic equilibrium.  The density is
low enough value for radiation to dominate the rate equations
coupling levels with each other and the continuum.  The expectation
is for all departure coefficients to equal unity.
<p>
<br>Checks:
<br>-	Departure coefficients exactly unity.
<br>-	Grain temperatures are exactly 5*104 K.
<p>
</p><hr><h2><kbd>limit_hi_ion.in  </kbd><I>very high ionization parameter limit
</I></h2><kbd><br>title very high ionization parameter limit
<br>c commands controlling continuum =========
<br>table agn 
<br>ionization parameter 15
<br>c commands controlling geometry  =========
<br>hden 0
<br>stop zone 1
<br>c other commands for details     =========
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>punch heating "limit_hi_ion.het"
<br>punch cooling "limit_hi_ion.col"
<br>c 
<br>c 
<br>c func_hi_ion.in 
<br>c class function 
<br>c ========================================
<br>c 
</kbd><p>
This tests a limit of very high ionization
<p>
 
</p><hr><h2><kbd>limit_laser_1.in  </kbd><I>test of H ionization in optically thin limit
</I></h2><kbd><br>title test of H ionization in optically thin limit
<br>c
<br>c commands controlling continuum =========
<br>laser 1.5 Ryd 
<br>phi(h) 10
<br>c
<br>c commands for density & abundances =========
<br>hden 1
<br>init file="hheonly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>constant temperature = 4
<br>iterate to convergence
<br>c
<br>c commands controlling output    =========
<br>c
<br>c limit_laser_1.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This checks the calculation of the hydrogen photoionization equilibrium.
The continuum is a laser peaked at 1.5 Ryd, where the hydrogen
photoionization cross section is 2.09*10-18 cm-2. 
<p>
<br>Checks:
<br>-	The hydrogen neutral fraction is nearly 2.00*10-4 (not exact
	since laser has finite width).
<br>-	Hb emissivity close to high density case A.  The predicted
	TOTL 4861 intensity should be nearly 2.2 times the expected
	case B intensity.
<p>
H cross section is 2.09E-18 cm^2, rec coef is 4.18E-14
answer is neutral fraction 2.00E-4
also checks that only 3 iterations needed
</p><hr><h2><kbd>limit_laser_2.in  </kbd><I>test of H and HeI ionization in optically thin limit
</I></h2><kbd><br>title test of H and HeI ionization in optically thin limit
<br>c
<br>c commands controlling continuum =========
<br>laser 2.0 Ryd
<br>intensity -0.3604
<br>c
<br>c commands for density & abundances =========
<br>hden 1
<br>init file="hheonly.ini"
<br>abundances all -10
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>constant temperature = 4
<br>iterate to convergence
<br>c
<br>c commands controlling output    =========
<br>c
<br>c limit_laser_2.in
<br>c class limit  
<br>c ========================================
<br>c 
</kbd><p>
This checks the calculation of the hydrogen and helium photoionization
equilibrium. The continuum is a laser peaked at 2.0 Ryd, and so can
only ionize hydrogen and atomic helium. 
<p>
<br>Checks:
<br>-	The hydrogen neutral fraction is nearly Ho/H+=4.51*10-4
	(not exact since laser has finite width).
<br>-	Hb emissivity close to high density case A.  The predicted TOTL 4861
	intensity should be nearly 2.2 times the expected case B intensity.
<br>-	Helium ionization should be Heo/He+ = 6.61*10-4.
<p>
H cross section is 0.927E-18 cm^2, rec coef is 4.18E-13
answer is Ho/H+ = 4.51e-4
HeI cross section is 6.54E-18 cm^2, rec coef is 4.32E-13
answer is Heo/He+ = 6.61e-5
</p><hr><h2><kbd>limit_laser_200.in  </kbd><I>ionization in Auger-dominated limit
</I></h2><kbd><br>title ionization in Auger-dominated limit
<br>c
<br>c commands controlling continuum =========
<br>laser 200 Ryd
<br>phi(h) 10
<br>c
<br>c commands for density & abundances =========
<br>hden 1
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>iterate  to convergence 
<br>constant temperature = 5
<br>c
<br>c commands controlling output    =========
<br>c
<br>c limit_laser_200.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This checks the calculation of ionization
equilibrium.  The continuum is a laser peaked at 200 Ryd.
It asserts ionization of C, O, and Fe.  their ionization is dominated
by the Auger effect.
<p>
<br>Checks:
Auger OK
</p><hr><h2><kbd>limit_laser_200_low.in  </kbd><I>test ionization in Auger-dominated limit
</I></h2><kbd><br>title test ionization in Auger-dominated limit
<br>c
<br>c commands controlling continuum =========
<br>laser 200 Ryd
<br>phi(h) 5
<br>c
<br>c commands for density & abundances =========
<br>hden 1
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>iterate  to convergence 
<br>constant temperature = 4
<br>c
<br>c commands controlling output    =========
<br>c
<br>c 
<br>c 
<br>c 
<br>c 
<br>c limit_laser_200_low.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This checks the calculation of ionization
equilibrium.  The continuum is a laser peaked at 200 Ryd.
It asserts ionization of C, O, and Fe.  their ionization is dominated
by the Auger effect.
<p>
<br>Checks:
Auger OK
</p><hr><h2><kbd>limit_laser_3.in  </kbd><I>test H and He ionization in optically thin limit
</I></h2><kbd><br>title test H and He ionization in optically thin limit
<br>c
<br>c commands controlling continuum =========
<br>laser 4.3 Ryd
<br>phi(h) 10
<br>c
<br>c commands for density & abundances =========
<br>hden 1
<br>abundances all -10
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>iterate  to convergence 
<br>constant temperature = 4
<br>c
<br>c commands controlling output    =========
<br>c
<br>c limit_laser_3.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This checks the calculation of the hydrogen and helium photoionization
equilibrium.  The continuum is a laser peaked at 4.3 Ryd, where it
can fully ionize both hydrogen and helium. 
<p>
<br>Checks:
<br>-	The hydrogen neutral fraction is nearly 4.18*10-4
	(not exact since laser has finite width).
<br>-	Helium ion: The ratio He+/He++ should be 1.69*10-3 and
	the ratio Heo/He+ should be 2.86*10-4.
<br>-	Hb emissivity should be close to high-density case A.  The predicted
	TOTL 4861 intensity should be nearly 2.2 times the expected
	case B intensity.
<p>
H cross section is 1.0E-18 cm^2, rec coef is 4.18E-13
answer is n(Ho)/n(H+)=4.18e-3
HeI cross section is 1.51E-18 cm^2, rec coef is 4.32e-13
answer is n(Heo)/n(He+)=2.86e-4, so Heo/He = 4.83e-7
HeII cross section is 1.30E-18 cm^2, rec coef is 2.20e-12
answer is n(He+)/n(He2+)=1.69e-3
</p><hr><h2><kbd>limit_lowd0.in  </kbd><I>test low density limit
</I></h2><kbd><br>title test low density limit
<br>c this and limit_lowdm6 should get same results
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>hden 0
<br>abundances old solar 84 
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>normalize to "H  1" 4861 0.86
<br>print line sort wavelength range 100 1m
<br>punch cooling last "limit_lowd0.col"
<br>punch continuum last "limit_lowd0.con"
<br>c
<br>c all asserts for both sims are in this file
<br>init file="lowd.dat"
<br>c
<br>c limit_lowd0.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
this test case is paired with lowdm6.in
both tests read in the same set of asserts, those contained in
the file lowd.dat, and they should get exactly the same answer
<p>
this is also the test of the print lines intensity command 
</p><hr><h2><kbd>limit_lowden.in  </kbd><I>test optically thin model that extends to very low densities
</I></h2><kbd><br>title test optically thin model that extends to very low densities
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>ionization parameter 0
<br>c
<br>c commands for density & abundances =========
<br>hden -2 to the -2 power
<br>init file="ism.ini"
<br>c
<br>c commands controlling geometry  =========
<br>sphere
<br>c this will take density down to 1e-8, below stated limit
<br>radius 10 13 
<br>c
<br>c other commands for details     =========
<br>c
<br>c commands controlling output    =========
<br>punch overview "limit_lowden.ovr" last
<br>c
<br>c limit_lowden.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This model is optically thin, with density falling off as inverse square law,
so ionization and temperature should be nearly constant.
if outer radius increased by 2 dex problem with level3 will appear,
several li seq lines (OVI, NeVIII) will fluctuate when density about
1e-9
<p>
We do not assert H lines since the cloud is optically thin and takes
at least three iterations to converge optical depth scale, 
That is not the purpose of this sim
</p><hr><h2><kbd>limit_lowdm6.in  </kbd><I>test low density limit
</I></h2><kbd><br>title test low density limit
<br>c this and limit_lowd0 should get same results
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>hden -6
<br>abundances old solar 84 
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>normalize to "H  1" 4861 0.86
<br>print line sort wavelength range 100 1m
<br>punch cooling last "limit_lowdm6.col"
<br>punch continuum last "limit_lowdm6.con"
<br>c
<br>c all asserts are in this file
<br>init file="lowd.dat"
<br>c
<br>c limit_lowdm6.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
this test case is paired with lowd0.in
both tests read in the same set of asserts, those contained in
the file lowd.dat, and they should get exactly the same answer
<p>
this also tests the print line sort range command
</p><hr><h2><kbd>limit_lowion_low.in  </kbd><I>test conditions of very low ionization matrix/simple solver
</I></h2><kbd><br>title test conditions of very low ionization matrix/simple solver
<br>c
<br>c commands controlling continuum =========
<br>blackbody 50000
<br>ionization parameter -30
<br>c
<br>c commands for density & abundances =========
<br>hden 2
<br>init file "hheonly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>atom h-like matrix lowt 
<br>atom he-like matrix lowt 
<br>no molecules
<br>constant temperature 100
<br>c
<br>c commands controlling output    =========
<br>c
<br>c limit_lowion_low.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
The lowion_pops.in and limit_lowion_low.in models form a pair
that have identical boundary conditions but use the two 
different hydrogenic level populations solvers.  The results
should agree.  lowion_pops.in uses the full solution with
the associate matrix inversion.  This can fail under conditions
of extreme low ionization due to numerical instabilities and
roundoff.  The solver used in limit_lowion_low.in is much simpler
and will work for any conditions.
<p>
The model is almost totally molecular.
<p>
</p><hr><h2><kbd>limit_lowion_pops.in  </kbd><I>test conditions of very low ionization matrix/simple solver
</I></h2><kbd><br>title test conditions of very low ionization matrix/simple solver
<br>c
<br>c commands controlling continuum =========
<br>blackbody 50000
<br>ionization parameter -30
<br>c
<br>c commands for density & abundances =========
<br>hden 2
<br>init file "hheonly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>atom h-like matrix pops  
<br>atom he-like matrix pops  
<br>no molecules
<br>constant temperature 100
<br>c
<br>c commands controlling output    =========
<br>c
<br>c 
<br>c limit_lowion_pops.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
The limit_lowion_pops.in and lowion_low.in models form a pair
that have identical boundary conditions but use the two 
different hydrogenic level populations solvers.  The results
should agree.  limit_lowion_pops.in uses the full solution with
the associate matrix inversion.  This can fail under conditions
of extreme low ionization due to numerical instabilities and
roundoff.  The solver used in lowion_low.in is much simpler
and will work for any conditions.
<p>
The model is almost totally molecular.
<p>
</p><hr><h2><kbd>limit_lte_h_t50_cion.in  </kbd><I>collisionally ionized H in LTE limit
</I></h2><kbd><br>title collisionally ionized H in LTE limit
<br>c
<br>c commands controlling continuum =========
<br>black body, T = 50000 K
<br>ionization parameter -8
<br>c
<br>c commands for density & abundances =========
<br>hden = 20
<br>set eden 20
<br>init file="hheonly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop lyman optical depth -6
<br>set dr -10
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>constant temperature = 50000 K
<br>c want pure collisional model
<br>no induced processes  (OK) 
<br>atom h-like collisional excitation off 
<br>atom h-like collisions l-mixing off 
<br>atom he-like collisional excitation off 
<br>atom he-like collisions l-mixing off 
<br>atom he-like collapsed levels 20
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>print h-like departure coefficients
<br>print he-like departure coefficients
<br>print populations h-like 
<br>print departure coefficients
<br>c
<br>c limit_lte_h_t50_cion.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This is the limiting case pure hydrogen collisional ionization,
There are no excitation or l-mixing collisions, so this tests whether 
collisional ionization - three body recombination
works in detailed balance.
<p>
</p><hr><h2><kbd>limit_lte_h_t50_coll.in  </kbd><I>collisionally excited H in LTE limit
</I></h2><kbd><br>title collisionally excited H in LTE limit
<br>c
<br>c commands controlling continuum =========
<br>black body, T = 50000 K
<br>ionization parameter -8
<br>c
<br>c commands for density & abundances =========
<br>hden = 20
<br>init file="hheonly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop lyman optical depth -6
<br>stop zone 1
<br>set dr 0
<br>set eden 20 
<br>c
<br>c other commands for details     =========
<br>no induced processes  (OK) 
<br>atom h-like collisions l-mixing off 
<br>atom he-like collapsed levels 20
<br>atom he-like collisions l-mixing off 
<br>constant temperature = 50000 K
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>print h-like departure coefficients
<br>print h-like populations
<br>print he-like departure coefficients
<br>print populations h-like 
<br>c
<br>c limit_lte_h_t50_coll.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This checks that the model H atom goes to LTE at high densities. 
<p>
chng 06 aug 24, had not included collisional ionization, and so he-like
departure coefficients were very large, around 202.  comments said there
were problems.  turned on collisional ionization, no problems noted
<p>
chng 06 jul 22
with RP changes in high-n n-changing collisions the rates are now much
smaller - needed to change density to be far higher and several 
quantities changed.  at lower density (1e18 cm-3) the populations are very
unphysical and runaway maser now occurs.  this is only a homework problem
and intended to only test n-changing collisions.  with higher density
this test is done.
<p>
</p><hr><h2><kbd>limit_lte_he1_coll.in  </kbd><I>He atom at high densities 
</I></h2><kbd><br>title He atom at high densities 
<br>c
<br>c commands controlling continuum =========
<br>laser 2
<br>ionization -3
<br>c
<br>c commands for density & abundances =========
<br>hden 18
<br>set eden 18
<br>element helium abundance -1
<br>init file "hheonly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set dr -10 
<br>c
<br>c other commands for details     =========
<br>atom he-like levels 10
<br>atom he-like collapsed levels 20
<br>constant temper 20000 K
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>print he-like departure helium 
<br>normalise to "He 1" 4471
<br>print line faint -2
<br>c
<br>c limit_lte_he1_coll.in 
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
test whether he-like ion populations go to lte in high density limit.
The level populations should be in LTE, and the departure coefficients
should be unity.
<p>
</p><hr><h2><kbd>limit_lte_he1_ste.in  </kbd><I>He atom in LTE at high densities 
</I></h2><kbd><br>title He atom in LTE at high densities 
<br>c
<br>c commands controlling continuum =========
<br>blackbody 50000 STE
<br>c
<br>c commands for density & abundances =========
<br>hden 18
<br>* set eden 18
<br>c a high he abundance so that it dominates 
<br>element helium abundance 1
<br>init file "hheonly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>atom he-like levels 7
<br>atom he-like collapsed levels 30
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>print he-like departure helium 
<br>print h-like departure hydrogen 
<br>normalise to "He 1" 4471
<br>print line faint -2
<br>punch heating "limit_lte_he1_ste.het" 
<br>punch cooling "limit_lte_he1_ste.col" 
<br>punch dr "limit_lte_he1_ste.dr" 
<br>c
<br>c limit_lte_he1_ste.in 
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
test whether a gas dominated by He goes to LTE in high-density limit.
The level populations should be in LTE, the departure coefficients
should be unity, and the temperature equal to the BB temp.
<p>
</p><hr><h2><kbd>limit_lte_hhe_coll_t50.in  </kbd><I>H, He in LTE at high densities 
</I></h2><kbd><br>title H, He in LTE at high densities 
<br>c test from Ferland and Rees 88, collisions drive H to LTE
<br>c collisions should drive all departure coef to unity
<br>c
<br>c commands controlling continuum =========
<br>black body t = 50000
<br>ionization parameter -5
<br>c
<br>c commands for density & abundances =========
<br>hden = 19
<br>init file="hheonly.ini"
<br>set eden 20
<br>c
<br>c commands controlling geometry  =========
<br>set dr -10
<br>stop zone 1
<br>stop lyman optical depth -6
<br>c
<br>c other commands for details     =========
<br>constant temperature = 50000
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>print departure coefficients h-like
<br>print populations h-like 
<br>print departure coefficients h-like helium
<br>print populations h-like helium
<br>print departure coefficients he-like
<br>print populations he-like 
<br>punch dr "limit_lte_hhe_coll_t50.dr" last
<br>c
<br>c limit_lte_hhe_coll_t50.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This model is a test of the behavior of hydrogen and helium
in the high density, collision dominated, limit.
The temperature is preset, the hydrogen density is set
to a very high value, and the ionization parameter is very low.
The resulting model is collision dominated, so this case
checks that the collision physics occurs in detailed balance.
The predicted departure coefficients should all equal unity.
The set dr command sets the zone thickness to 1 cm.  
<p>
<br>Checks:
<br>-	Hydrogen departure coefficients exactly unity.
<br>-	Helium departure coefficients near unity.  
	(Density not high enough to bring helium departure coefficients
	exactly to unity.)
<br>-	H-, H2, H2+ H3+, and HeH+ departure coefficients exactly unity.
`
</p><hr><h2><kbd>limit_lte_hhe_induc.in  </kbd><I>radiation dominated H, He gas goes to STE
</I></h2><kbd><br>title radiation dominated H, He gas goes to STE
<br>c
<br>c commands controlling continuum =========
<br>black body, t = 50000 STE
<br>c
<br>c commands for density & abundances =========
<br>hden 4
<br>init file="hheonly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop lyman continuum optical depth -6
<br>set dr -10
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>iterate
<br>set temperature convergence 0.002
<br>c
<br>c commands controlling output    =========
<br>print populations h-like
<br>print heating
<br>print departure coef
<br>print line faint -1
<br>c
<br>c limit_lte_hhe_induc.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This is a H, He-only gas that is optically thin in the Lyman continuum.  It is
irradiated by a blackbody in strict thermodynamic equilibrium.  The tests confirm
that the gas temperature equilibriates close to the black body temperature.
<p>
<p>
</p><hr><h2><kbd>limit_lte_hhe_ste.in  </kbd><I>H, He in STE
</I></h2><kbd><br>title H, He in STE
<br>c from Ferland and Rees 1988
<br>c this tests whether thermal processes go to STE
<br>c
<br>c commands controlling continuum =========
<br>black body, t = 50000 STE
<br>c
<br>c commands for density & abundances =========
<br>hden 10
<br>init file="hheonly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop lyman optical depth -6
<br>set dr -10
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>print heating
<br>print populations h-like
<br>print departure coef h-like
<br>print departure coef he-like
<br>c
<br>c limit_lte_hhe_ste.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This is the ultimate test of the behavior of the code in the
strict thermodynamic equilibrium limit. The temperature is not
held constant, so the resulting equilibrium temperature determines
whether cooling processes are treated properly in the detailed balance limit.
The equilibrium temperature should be exactly 5*104 K, and all
departure coefficients should equal unity. A small amount of
grains are included to check that the grain thermal balance is
handled properly in this limit. 
<p>
<br>Checks:
<br>-	Electron temperature exactly 5*104 K.
<br>-	Departure coefficients unity.
<p>
</p><hr><h2><kbd>limit_lte_hminus.in  </kbd><I>H- goes to LTE
</I></h2><kbd><br>title H- goes to LTE
<br>c
<br>c commands controlling continuum =========
<br>c this is a second way to get STE and tests the energy density option
<br>blackbody 5000 energy density 5000K
<br>c
<br>c commands for density & abundances =========
<br>hden 10
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>iterate
<br>constant temperature 5000
<br>c
<br>c commands controlling output    =========
<br>print populations h-like hydrogen
<br>print departure coef
<br>c
<br>c limit_lte_hminusin
<br>c 
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This checks that the negative hydrogen ion goes
to thermodynamic equilibrium when irradiated by
a blackbody in thermodynamic equlibrium.  It was
originally presented in
 
>>refer	H-	test	Ferland, G. J., & Persson, S. E. 1989, ApJ, 347, 656
</p><hr><h2><kbd>limit_lte_metal.in  </kbd><I>STE with metals
</I></h2><kbd><br>title STE with metals
<br>c this tests whether thermal processes go to STE
<br>c
<br>c commands controlling continuum =========
<br>c a dilution factor of 1 is one way to get STE
<br>black body, t = 20000 dilution 1
<br>c
<br>c commands for density & abundances =========
<br>hden 10
<br>abundances starburst 5
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>stop lyman optical depth -6
<br>set dr -10
<br>c
<br>c other commands for details     =========
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>print departure coef
<br>print populations h-like
<br>punch heating "limit_lte_metal.het" last
<br>punch cooling "limit_lte_metal.col" last
<br>c
<br>c limit_lte_metal.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This checks that the code goes to strict thermodynamic equilibrium
for the case of a metal rich gas exposed to a true black body. 
The many heavy element lines should dominate cooling, so this is
a test that the multilevel atoms go to LTE in the radiation-dominated limit.
<p>
<br>Checks:
<br>-	Temperature should equilibrate at 20000 K.  
<br>-	Departure coefficients should equal unity.
<p>
</p><hr><h2><kbd>limit_recoil_ion.in  </kbd><I>test compton recoil ionization of hydrogen 
</I></h2><kbd><br>title test compton recoil ionization of hydrogen 
<br>c
<br>c commands controlling continuum =========
<br>laser 2000 ryd
<br>ionization parameter -5
<br>c
<br>c commands for density & abundances =========
<br>hden 0
<br>init "honly.ini"
<br>c
<br>c commands controlling geometry  =========
<br>set dr 14
<br>stop zone 10
<br>c
<br>c other commands for details     =========
<br>iterate
<br>no secondary ionization 
<br>constant temperature 1000
<br>c
<br>c commands controlling output    =========
<br>c
<br>c 
<br>c limit_recoil_ion.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
H ionization is totally due to recoil ionization in this model.
The assert checks the final hydrogen ionization. 
</p><hr><h2><kbd>limit_strom.in  </kbd><I>pure-H Stromgren sphere
</I></h2><kbd><br>title pure-H Stromgren sphere
<br>c the answer is R(Stromgren) = 4.16E17 cm
<br>c
<br>c commands controlling continuum =========
<br>blackbody 50000 K
<br>q(h) 49
<br>c
<br>c commands for density & abundances =========
<br>hden 4
<br>init file "honly.ini"
<br>abundances all -10
<br>c
<br>c commands controlling geometry  =========
<br>sphere static
<br>radius 16
<br>stop efrac -0.5
<br>c
<br>c other commands for details     =========
<br>no level2
<br>turbulence 20 km/s
<br>constant temper 7500
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>punch overview last "limit_strom.ovr"
<br>punch results last "limit_strom.rlt"
<br>punch dr last "limit_strom.dr"
<br>c
<br>c limit_strom.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This case checks that the code computes the geometry and emissivity
correctly for a pure hydrogen spherical shell.  The low temperature
is chosen to avoid collisional ionization.  The model stops at the
Ho-H+ ionization front.  The turbulence is to prevent the Balmer lines
from becoming optically thick.
 
<br>Checks
<br>-	Outer radius should be 4.16391017 cm.
<br>-	Predicted Hb, case B Hb, and Q(H) Hb, all agree.
<p>
</p><hr><h2><kbd>limit_supra.in  </kbd><I>secondary ionization dominated gas
</I></h2><kbd><br>title secondary ionization dominated gas
<br>c like SN envelope
<br>c
<br>c commands controlling continuum =========
<br>c this continuum will be VERY faint
<br>table agn
<br>ionization parameter -25
<br>c secondary ioinzations will dominate
<br>set csupra -5
<br>c
<br>c commands for density & abundances =========
<br>hden 5
<br>abundances old solar 84 
<br>c
<br>c commands controlling geometry  =========
<br>stop temperature 20
<br>stop zone 1
<br>set dr 0 
<br>c
<br>c other commands for details     =========
<br>constant temperature 1000 K
<br>iterate convergence
<br>c
<br>c commands controlling output    =========
<br>print ages
<br>c check that no uninitialized DR rates are printed (r2757) 
<br>print arrays carbon only
<br>punch heating "limit_supra.het"
<br>punch ionizing continuum "limit_supra.ion" last 
<br>punch molecules "limit_supra.mol"
<br>c
<br>c 
<br>c limit_supra.in
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This model computes the ionization within cool gas that is totally ionized
by suprathermal secondary electrons.  
<p>
Charge transfer heating is VERY important in this simulation.
<p>
</p><hr><h2><kbd>limit_vbhum.in  </kbd><I>compare with Van Blerkom and Hummer exact RT results
</I></h2><kbd><br>title compare with Van Blerkom and Hummer exact RT results
<br>c
<br>c commands controlling continuum =========
<br>blackbody 50000 K
<br>phi(h) 12.30103
<br>c commands for density & abundances =========
<br>hden 4
<br>init "honly.ini"
<br>abundances all -10
<br>c
<br>c commands controlling geometry  =========
<br>stop efrac -0.5
<br>c
<br>c other commands for details     =========
<br>diffuse ots
<br>no level2 lines
<br>constant temper 4
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>punch overview last "limit_vbhum.ovr"
<br>punch dr last "limit_vbhum.dr"
<br>c
<br>c 
<br>c limit_vbhum.in
<br>c 
<br>c class limit 
<br>c ========================================
<br>c 
</kbd><p>
This is a test of the treatment of the diffuse fields, their transfer,
and their effects on the ionization structure of a nebula. The comparison
is made against the exact calculation published by Van Blerkom and
Hummer (1967). The geometry is open, that is, similar to that assumed
in most BLR calculations. 
<p>
>>refer	H	ionization	Van Blerkom, D., & Hummer, D. G. 1967, MNRAS, 137, 353
<p>
The diffuse ots command is entered in order to reproduce the
Van Blerkom and Hummer results.  The default assumption, outward only,
does not agree as well.  I changed the default from OTS to outward only
to be in better agreement with predictions by Harrington and Rubin
at the Lexington meeting.  They have not checked whether their codes
are in agreement with the Van Blerkom and Hummer paper.
<p>
<br>Checks:
<br>-	Neutral fraction at illuminated face 5.8*10-4.
<br>-	Location of ionization front at 7.8*1016 cm.
<br>-	34TOTL 486134 and 34CA B 486134 agree;  both slightly lower than 34Q(H) 486134.
<br>-	Answers with OTS agree with 1967 results.
<p>
test hydrogen ground state rec effic against vb+h exact results
this is their case e) - "zero condition"
their answer for H0/Htot at the illuminated edge is approx 5.8E-4,
and a Stromgren radius of approximately 7.7E16 cm
</p><hr><h2><kbd>limit_veryveryfast.in  </kbd><I>very fast simulation for Purify/valgrind
</I></h2><kbd><br>title very fast simulation for Purify/valgrind
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>ionization parameter -2
<br>c
<br>no file opacity
<br>set dr 0 
<br>c
<br>c commands for density & abundances =========
<br>hden 9
<br>init file "hheonly.ini"
<br>element oxygen on  
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>no level 2
<br>constant temperature 4
<br>atom h-like levels very small
<br>atom he-like levels very small
<br>c
<br>c commands controlling output    =========
<br>punch dr last "limit_veryveryfast.dr"
<br>c
<br>c 
<br>c limit_veryveryfast
<br>c class limit   
<br>c ========================================
<br>c 
</kbd><p>
This is meant to be a very fast calculation to 
use when running extensive debug-enabled runtimes.
<p>
<p>
</p><hr><h2><kbd>nlr_lex00.in  </kbd><I>NLR model for Lexington 2000 Meeting
</I></h2><kbd><br>title NLR model for Lexington 2000 Meeting
<br>c
<br>c commands controlling continuum =========
<br>phi(h) 12.47712
<br>c shape of continuum is interpolated table 
<br>interpolate (0 -10) (0.08 -10) (0.1 1) (3676 -4.935) (4700 -11)
<br>continue (4750 -20) (7.4e6 -30)
<br>c
<br>c commands controlling geometry  =========
<br>stop column 22
<br>c
<br>c commands for density & abundances =========
<br>hden 4
<br>init file="c84.ini"
<br>abundances -1 c-3.52 n-4 o-3.097 ne-4 na-9
<br>continue mg-4.523 al-8 si-4.523 s-4.824 a-9 ca-8 fe-8 ni-9
<br>c
<br>c other commands for details     =========
<br>iterate
<br>c
<br>c commands controlling output    =========
<br>* normalize to "totl" 4861 of 0.923
<br>print line faint .01
<br>print diffuse continuum
<br>c add sum of these lines to printout for Stoy ratio 
<br>print line sum
<br>TOTL 1216
<br>He 1 5876
<br>TOTL 1909
<br>TOTL 1549
<br>N  2 6584
<br>N  2 6548
<br>N  3  57.21m
<br>totl 1750
<br>totl 1486
<br>o  1 6300
<br>o  1 63.17m
<br>TOTL 3727
<br>totl  1665
<br>O  3  51.80m
<br>O  3 5007
<br>O  3 4959
<br>totl 1402
<br>Ne 3  15.55m
<br>Ne 3 3869
<br>Ne 3 3968
<br>Ne 4 2424
<br>Ne 5 3426
<br>Ne 5 3346
<br>totl 2798
<br>si 2 34.81m
<br>s  2 6720
<br>S  3  18.67m
<br>S  3 9532
<br>S  3 9069
<br>S  4  10.51m
<br>end of lines
<br>c 
<br>punch overview last "nlr_lex00.ovr"
<br>punch dr last "nlr_lex00.dr"
<br>punch results last "nlr_lex00.rlt"
<br>c
<br>table lines "LineList_NLR.dat" 
<br>c nlr_lex00.in
<br>c class nlr 
<br>c ========================================
</kbd><p>
This is one of the test cases from the Lexington (1993) Meeting suite of nebulae. 
It is a grain-free NLR model.
</p><hr><h2><kbd>nlr_liner.in  </kbd><I>NLR liner model
</I></h2><kbd><br>title NLR liner model
<br>c a constant pressure (gas+radiation) model of a nlr_liner cloud
<br>c in the spirit of Ferland and Netzer 1983
<br>c
<br>c commands controlling continuum =========
<br>table agn
<br>ionization parameter -3
<br>c
<br>c commands for density & abundances =========
<br>hden 6
<br>init file "ism.ini"
<br>abundances old solar 84 
<br>metals 0.3
<br>c
<br>c commands controlling geometry  =========
<br>stop thickness 16.3
<br>stop column density 23
<br>constant pressure
<br>c
<br>c other commands for details     =========
<br>iterate to convergence ;must iterate to get radiation pressure correctly
<br>c
<br>c commands controlling output    =========
<br>punch overview last "nlr_liner.ovr"
<br>punch element nitrogen last "nlr_liner.nit"
<br>punch dr last "nlr_liner.dr"
<br>punch results last "nlr_liner.rlt"
<br>c
<br>c nlr_liner.in
<br>c class nlr 
<br>c ========================================
</kbd><p>
This is a model somewhat like the Liner parameters proposed by
Ferland and Netzer (1983).  A second iteration is performed to
allow the calculation of the line radiation pressure.
<p>
>>refer	nlr_liner	model	Ferland, G. J., & Netzer, H. 1983, ApJ, 264, 105
<p>
</p><hr><h2><kbd>nlr_liner_grains.in  </kbd><I>liner model with grains
</I></h2><kbd><br>title liner model with grains
<br>c 
<br>c a constant pressure (gas+radiation) model of a liner cloud
<br>c in the spirit of Ferland and Netzer 1983
<br>c
<br>c commands controlling continuum =========
<br>ionization parameter -3
<br>table agn
<br>c
<br>c commands for density & abundances =========
<br>hden 6
<br>c this turns on both grains and depleted abundances
<br>abundances ism no grains 
<br>grains ism no qheat single
<br>init file "ism.ini"
<br>c
<br>c commands controlling geometry  =========
<br>stop column density 23
<br>c
<br>c other commands for details     =========
<br>constant pressure
<br>iterate to convergence ;must iterate to get radiation pressure correctly
<br>c
<br>c commands controlling output    =========
<br>punch overview last "nlr_liner_grains.ovr"
<br>punch dr last "nlr_liner_grains.dr"
<br>punch continuum last "nlr_liner_grains.con" units microns 
<br>punch results last "nlr_liner_grains.rlt"
<br>c
<br>c nlr_liner_grains.in
<br>c class nlr 
<br>c ========================================
<br>c 
</kbd><p>
This is a model somewhat like the Liner parameters proposed by
Ferland and Netzer (1983).  A second iteration is performed to
allow the calculation of the line radiation pressure.
It includes grains and is so more realistic.
<p>
>>refer	liner	model	Ferland, G. J., & Netzer, H. 1983, ApJ, 264, 105
<p>
</p><hr><h2><kbd>nlr_paris.in  </kbd><I>Paris meeting NLR model
</I></h2><kbd><br>title Paris meeting NLR model
<br>c
<br>c commands controlling continuum =========
<br>interpolate (0 -10) (0.073 -10) (0.074 1) (7352 -4)
<br>continue (7400 -15) (7.353e6 -20)
<br>ionization parameter -2
<br>c
<br>c commands controlling geometry  =========
<br>stop lyman continuum optical depth 4
<br>c
<br>c commands for density & abundances =========
<br>hden 3
<br>init file="c84.ini"
<br>abund -1 C-3.5229 N-4. O-3.22185 ne-3.82391 na=-8 mg-4.5229 al=-8
<br>continue si-4.5229 s-4.82391 ar-8 ca=-8 fe-7 ni-8
<br>c
<br>c other commands for details     =========
<br>c this large group of lines are turned off so that the model runs
<br>c 30 percent faster - lines are mainly fuv and x-ray, which we will
<br>c not track in this model
<br>no level2
<br>iterate
<br>atom h-like element helium levels resolved 10
<br>c
<br>c commands controlling output    =========
<br>punch overview last "nlr_paris.ovr"
<br>punch dr last "nlr_paris.dr"
<br>punch results last "nlr_paris.rlt"
<br>c
<br>c nlr_paris.in
<br>c class nlr 
<br>c ========================================
</kbd><p>
<p>
This is the NLR model presented in the Meudon meeting on model nebulae. 
The init file is entered to make the code behave more like version 84.
<p>
<br>Checks:
<br>-	init file works
<p>
</p><hr><h2><kbd>nova_dqher.in  </kbd><I>cold nova shell
</I></h2><kbd><br>title cold nova shell
<br>c Ferland et al. 1984 DQ Her
<br>c model of room temperature ionized cloud arund old nova DQ Her
<br>c roughly that of 
<br>c tests behaviour of code at very low temperatures
<br>c
<br>c commands controlling continuum =========
<br>c flat continuum, followed by nu^-2 power law
<br>interpolate (0 0) (0.3 0) (8.e6 -14.8)
<br>luminosity total 34
<br>c
<br>c commands for density & abundances =========
<br>hden = 2.
<br>abundances nova
<br>grains no qheat single
<br>c
<br>c commands controlling geometry  =========
<br>filling factor 0.667
<br>covering factor 0.667
<br>radius 16.5682 , thickness = 16.14613
<br>c need this since gas is so cool 
<br>stop temp = 100
<br>c
<br>c other commands for details     =========
<br># >>chng 06 aug 02, add cosmic rays, should always have been included
<br>cosmic rays background 
<br>iterate
<br>turbulence 300
<br>age 70 years %it exploded in the 1930's
<br>atom h-like element hydrogen levels resolved 15
<br>atom h-like element helium levels resolved 15
<br>c
<br>c commands controlling output    =========
<br>normalize to 4861 label="CaBo" intensity 1.169
<br>print line all
<br>punch overview last "nova_dqher.ovr"
<br>punch results last "nova_dqher.rlt"
<br>punch dr last "nova_dqher.dr"
<br>punch transmitted continuum "nova_dqher.trn" last
<br>c
<br>c nova_dqher.in
<br>c class nova 
<br>c ========================================
<br>c 
</kbd><p>
This tests the code39s behavior in the limit posed by the
metal rich low density nebula surrounding DQ Her (Ferland et al. 1984).
<br>Checks:
<br>-	Thickness exact 
<br>-	Thermal stability
	High-Z gas
	ionization at low temperature
</p><hr><h2><kbd>nova_photos.in  </kbd><I>dense nova photosphere
</I></h2><kbd><br>title dense nova photosphere
<br>c
<br>c commands controlling continuum =========
<br>c this is the result of this command
<br>c table star kurucz 35000; use old atlas atmosphere
<br>c and makes it possible to run sims without
<br>c installing the stellar atmosphere files 
<br>c set SED of central star
<br>table read "star_kurucz_35000.dat" 
<br>c set luminosity of central star
<br>absolute bolometric magnitude -8.1 
<br>c
<br>c commands for density & abundances =========
<br>hden 10  ;log of total hydrogen density (cm-3) at illuminated face
<br>abundances old solar 84 ; use old solar abundances for record keeping
<br>c
<br>c commands controlling geometry  =========
<br>sphere   ; model is a full sphere covering the central star
<br>radius 12 to 14; log of inner and outer radii (cm)
<br>c
<br>c other commands for details     =========
<br>iterate to convergence
<br>c
<br>c commands controlling output    =========
<br>print line faint -1
<br>punch overview "nova_photos.ovr" last
<br>punch results "nova_photos.rlt" last
<br>punch dr "nova_photos.dr" last
<br>punch heat "nova_photos.het" last
<br>punch cool "nova_photos.col" last
<br>c
<br>c nova_photos.in
<br>c class nova 
<br>c ========================================
<br>c 
</kbd><p>
this model is intensely affected by continuum pumping of atoms.  The
hydrogen ionizaiton is by lyman line pumping, followed by photoionization
from excited states.
</p><hr><h2><kbd>optimize_phymir.in  </kbd><I>test phymir optimizers
</I></h2><kbd><br>title test phymir optimizers
<br>c spectrum computed with hden 5, temp 4
<br>c subplex, phymir, powell
<br>c
<br>c commands controlling continuum =========
<br>black 40000 K
<br>ionization par -3
<br>c
<br>c commands for density & abundances =========
<br>hden 4 vary
<br>init file "hheonly.ini"
<br>element oxygen on 
<br>c
<br>c commands controlling geometry  =========
<br>Case B 
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>optimize tolerance 0.03
<br>constant temper 4.3 vary
<br>optimize phymir 
<br>optimize iteration 100
<br>c the following spectrum was derived by running this sim at hden 5 and t=4
<br>c resulting eden was 5.039 and T=4, which we shall assert that we find
<br>c >>chng 06 apr 03, backdate to old [OII] As and rederive spectrum
<br>optimize lines
<br>o ii 3729 0.1432
<br>o ii 3726 0.4055
<br>o ii 7323 0.5281
<br>o ii 7332 0.4257
<br>o  3 5007 3.6189
<br>totl 4363 0.0342
<br>end of lines
<br>c
<br>c commands controlling output    =========
<br>print line faint -2
<br>c
<br>c
<br>c optimize_phymir.in 
<br>c class optimizer 
<br>c ========================================
<br>c 
</kbd><p>
This checks whether the optimizer can recover a known solution.  The line
spectrum was calculated at T = 1e4 K and and n_H=1e5 cm^-3, 
and resulted in the given electron 
density.  The model optimize_subplex.in is a copy of this file.
<p>
</p><hr><h2><kbd>optimize_subplex.in  </kbd><I>test subplex optimizer
</I></h2><kbd><br>title test subplex optimizer
<br>c spectrum computed with hden 5, temp 4
<br>c subplex, phymir, amoeba, powell
<br>c
<br>c commands controlling continuum =========
<br>black 40000 K
<br>ionization par -3
<br>c
<br>c commands for density & abundances =========
<br>hden 4 vary
<br>init file "hheonly.ini"
<br>element oxygen on 
<br>c
<br>c commands controlling geometry  =========
<br>Case B
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>constant temper 4.3 vary
<br>optimize subplex
<br>optimize iteration 100
<br>optimize tolerance 0.01
<br>c the following spectrum was derived by running this sim at hden 5 and t=4
<br>c resulting eden was 5.039 and T=4, which we shall assert that we find
<br>c >>chng 06 apr 03, backdate to old [OII] As and rederive spectrum
<br>optimize lines
<br>o ii 3729 0.1432
<br>o ii 3726 0.4055
<br>o ii 7323 0.5281
<br>o ii 7332 0.4257
<br>o  3 5007 3.6189
<br>totl 4363 0.0342
<br>end of lines
<br>c
<br>c commands controlling output    =========
<br>print line faint -2
<br>c
<br>c
<br>c optimize_subplex.in
<br>c class optimizer 
<br>c ========================================
<br>c 
</kbd><p>
This checks whether the optimizer can recover a known solution.  The line
spectrum was calculated at T = 1e4 K and and n_H=1e5 cm^-3, 
and resulted in the given electron 
density.  The model optimize_phymir.in is a copy of this file.
<p>
</p><hr><h2><kbd>orion_hii_open.in  </kbd><I>conditions similar to Orion nebula blister
</I></h2><kbd><br>title conditions similar to Orion nebula blister
<br>c orion hii region with open geometry
<br>c
<br>c commands controlling continuum =========
<br>c SED of central star
<br>table read "star_kurucz_39600.dat" 
<br>c its flux of H-ionizing photons
<br>phi(h) 13.0
<br>c
<br>c this is to include velocity field in radiative transfer
<br>turbulence 8 km/sec no pressure 
<br>c
<br>c commands for density & abundances =========
<br>hden 4
<br>abundances hii region no grains
<br>grains orion
<br>c
<br>c commands controlling geometry  =========
<br>cosmic rays, background
<br>constant pressure
<br>c this is the account for continued matter beyond i front 
<br>double optical depths
<br>c
<br>c other commands for details     =========
<br>iterate 2
<br>c
<br>c commands controlling output    =========
<br>print line faint -5
<br>c print lines as surface brightness
<br>print lines surface brightness arcsec 
<br>print line optical depths
<br>print diffuse continuum 
<br>c want to print line intensities are surface brightness, per arcsec^2
<br>print lines surface brightness arcsec
<br>print diffuse continuum 
<br>punch overview last "orion_hii_open.ovr"
<br>punch dr last "orion_hii_open.dr"
<br>punch continuum last "orion_hii_open.con" units microns
<br>punch transmitted continuum last "orion_hii_open.trn" 
<br>punch overview last "orion_hii_open.ovr"
<br>punch fine opacity last "orion_hii_open.opc" range 0.7 0.9 ryd
<br>punch element nitrogen last no hash "orion_hii_open.nit"
<br>punch line emissivity "orion_hii_open.ems" last no hash emergent
<br>totl 5199
<br>o  1 6300 
<br>end of lines
<br>punch linelist "orion_hii_open.lin" "LineList_HII.dat" last no hash emergent absolute
<br>c
<br>c orion_hii_open.in
<br>c class hii 
<br>c ========================================
</kbd><p>
This is a model similar in spirit to the blister geometry HII region
model computed by Baldwin et al. (1991). 
Size-resolved Orion grains are included.
The constant pressure command does a
hydrostatic equilibrium structure.  The predicted emission-line spectrum is
affected by the reddening of the internal grains.  The resulting t2
analysis produces artificial results as a result.
This has an open geometry, the original BFM paper was a closed geometry.
(This makes little difference).  Background cosmic rays are also included
although these should have little effect on warm ionized gas.  The emission
line spectrum is given in surface brightness units, as in the BFM paper.
<p>
</p><hr><h2><kbd>orion_hii_pdr.in  </kbd><I>constant pressure H+ region/pdr
</I></h2><kbd><br>title constant pressure H+ region/pdr
<br>c
<br>c commands controlling continuum =========
<br>c the incident continuum is two parts
<br>c star and flux of photons striking it
<br>c this is the photosphere of the OVI star, its temperature and Q(H)
<br>c this is the result of this command
<br>c table star kurucz 39600 K
<br>c and makes it possible to run these orion sims without
<br>c installing the stellar atmosphere files 
<br>table read "star_kurucz_39600.dat" 
<br>Q(H) 49
<br>c this adds the observed hot brems, its temperature and the flux of 
<br>c photons striking the cloud
<br>brems 6
<br>phi(h) 10
<br>c add cosmic rays, which are important in the pdr
<br>cosmic rays, background
<br>c
<br>c commands controlling geometry  =========
<br>c this sets the separation from the star and the face of the cloud
<br>radius 17.4507
<br>c this turns off the stop temperature opption
<br>c the sim will not stop due to temperature
<br>stop temperature off
<br>c this is typical of a gmc, larson 1981
<br>stop total hydrogen column density 22
<br>c this sets the thickness of the HII region & PDR
<br>stop thickness 0.5 linear parsec 
<br>c assume constant pressure
<br>c constant gas pressure 
<br>constant pressure 
<br>c this will result in a milli gauss B-field in molecular region
<br>magnetic field -5 gauss
<br>c the orion environment full covers the star, so turn on sphere
<br>sphere 
<br>c we have a spherical geometry but want to simulate observing
<br>c through a spectrometer's slit.  use the aperture
<br>c command for this
<br>aperture beam 
<br>c
<br>c other commands for details     =========
<br>c mimic existence of unmodeled molecular gas
<br>double 
<br>c iterate since lines optically thick
<br>iterate
<br>c the observed microturbulence, partially a flow, so not included in pressure
<br>turbulence 8 km/sec no pressure
<br>c set the line width so lines appear on the punch continuum
<br>set punchLwidth 10 km/s
<br>c there should be no failures at all
<br>failures 3
<br>c
<br>c this model goes quite deep, needs lots of zones
<br>set nend 2200
<br>c
<br>c commands for density & abundances =========
<br>c this is the log of the initial H density, cm-3
<br>hden 4
<br>c this will speed up the calculation a bit
<br>init file="ism.ini"
<br>c this uses HII region abundances, but no grains
<br>abundances hii region no grains
<br>c this turns on orion grains, but leaves quantum heating off to save time
<br>grains orion no qheat
<br>c turn on PAHs, with an abundance that depends on H0 fraction,
<br>c as suggested by long-slit observations of Orion bar,
<br>c with an abundance 3x larger than default built into the code
<br>grains pah function 3 no qheat 
<br>c 
<br>c commands controlling output    =========
<br>normalize to "O  1" 63.17m
<br>c print lots of faint CO lines
<br>print line faint -4
<br>punch overview last "orion_hii_pdr.ovr"
<br>punch heating "orion_hii_pdr.het"
<br>punch cooling "orion_hii_pdr.col"
<br>punch dr last "orion_hii_pdr.dr"
<br>punch results last "orion_hii_pdr.rlt"
<br>punch continuum last "orion_hii_pdr.con" units microns
<br>punch hydrogen 21 cm last "orion_hii_pdr.21cm"
<br>punch hydrogen lya last "orion_hii_pdr.lya" 
<br>punch element silicon last "orion_hii_pdr.sil" 
<br>punch grain extinction last  "orion_hii_pdr.grnext"
<br>punch grain charge last "orion_hii_pdr.grnchr" 
<br>punch grain potential last "orion_hii_pdr.grnpot" 
<br>punch grain temperature last "orion_hii_pdr.grntem" 
<br>c
<br>c
<br>c orion_hii_pdr.in
<br>c class hii pdr  
<br>c ========================================
</kbd><p>
This extends BFM from the H+ region into the PDR as in Abel et al 2005.
This is the correct way to do a PDR calcualtion.
<p>
>>refer	Orion	model	Baldwin, J., Ferland, G. J., 
>>refercon	Martin, P. G., Corbin, M., Cota, S., Peterson, 
>>refercon	B. M., & Slettebak, A. 1991, ApJ, 374, 580
<p>
>>refer	physics	HII/PDR	Abel, N.P., Ferland, G.J., Shaw, G. & 
>>refercon	van Hoof, P.A.M. 2005, ApJS, 161, 65
</p><hr><h2><kbd>orion_hii_pdr_fast.in  </kbd><I>constant gas pressure H+ region/PDR
</I></h2><kbd><br>title constant gas pressure H+ region/PDR
<br>c much faster due to physics disabled by fast.ini
<br>c
<br>c commands controlling continuum =========
<br>c the incident continuum is two parts
<br>c star and flux of photons striking it
<br>c this is the result of this command
<br>c table star kurucz 39600 K
<br>c and makes it possible to run these orion sims without
<br>c installing the stellar atmosphere files 
<br>table read "star_kurucz_39600.dat" 
<br>Q(H) 49
<br>c add cosmic rays, which are important at depth
<br>cosmic rays, background
<br>c plus hot brems 
<br>brems 6
<br>phi(h) 10
<br>c 
<br>c commands for density & abundances =========
<br>hden 4
<br>init file="fast.ini"
<br>abundances hii region no grains
<br>c single sized grain with no quantum heating 
<br>grains orion no qheat single 
<br>c
<br>c commands controlling geometry  =========
<br>radius 17.4507
<br>sphere 
<br>c let it go into the molecular cloud
<br>stop temperature 10 linear
<br>c this is roughly the thickness of OMC1
<br>stop thickness 1 linear parsec 
<br>c mimic existence of unmodeled molecular gas with double command
<br>double 
<br>c
<br>c other commands for details     =========
<br>failures 3
<br>iterate
<br>c make constant gas pressure since fast turned off line radiation pressure
<br>constant gas pressure 
<br>c the observed microturbulence 
<br>turbulence 8 km/sec
<br>c we have a spherical geometry but want to simulate observing
<br>c through a spectrometer's slit.  use the aperture
<br>c command for this
<br>aperture beam 
<br>c
<br>c commands controlling output    =========
<br>normalize to "CaBo" 4861
<br>print line faint -4
<br>punch overview last "orion_hii_pdr_fast.ovr"
<br>punch heating "orion_hii_pdr_fast.het"
<br>punch cooling "orion_hii_pdr_fast.col"
<br>punch dr last "orion_hii_pdr_fast.dr"
<br>punch results last "orion_hii_pdr_fast.rlt"
<br>punch continuum last "orion_hii_pdr_fast.con" units microns
<br>punch ionizing continuum last "orion_hii_pdr_fast.ion"
<br>punch hydrogen 21 cm last "orion_hii_pdr_fast.21cm"
<br>punch hydrogen lya last "orion_hii_pdr_fast.lya" 
<br>punch element silicon last "orion_hii_pdr_fast.sil" 
<br>punch element sulphur last "orion_hii_pdr_fast.sul" 
<br>c
<br>c
<br>c orion_hii_pdr_fast.in
<br>c class hii pdr 
<br>c ========================================
<br>c 
</kbd><p>
Orion HII region and PDR, simialr to orion_hii_pdr but
much faster because of fast.ini
<p>
</p><hr><h2><kbd>orion_hii_pdr_pp.in  </kbd><I>the Orion HII Region / PDR / Molecular cloud with an open geometry
</I></h2><kbd><br>title the Orion HII Region / PDR / Molecular cloud with an open geometry
<br>c
<br>c commands controlling continuum =========
<br>c the incident continuum has two parts
<br>c kurucz continuum with flux of photons striking cloud
<br>c this is the the OVI star, its temperature and phi(H)
<br>c this is the result of this command
<br>c table star kurucz 39600 K
<br>c and makes it possible to run these orion sims without
<br>c installing the stellar atmosphere files 
<br>table read "star_kurucz_39600.dat" 
<br>phi(H) 13
<br>c
<br>c this adds the observed hot brems
<br>c its temperature (as log of T) and the flux of 
<br>c photons striking the cloud
<br>brems 6
<br>phi(h) 10
<br>c
<br>c cosmic rays are important for pdr chemistry
<br>cosmic rays, background
<br>c
<br>c commands controlling geometry  =========
<br>c this turns off the stop temperature option
<br>c so the sim will not stop due to temperature
<br>stop temperature off
<br>c this sets the thickness of the HII region & PDR
<br>stop thickness 0.5 linear parsec 
<br>c this is typical of a gmc, larson 1981
<br>stop total hydrogen column density 22
<br>c this will result in a milli gauss B-field in molecular region
<br>magnetic field -5 gauss
<br>c assume constant pressure
<br>constant pressure 
<br>set nend 2000 
<br>c
<br>c other commands for details     =========
<br>failures 3
<br>c mimic existence of unmodeled molecular gas
<br>double 
<br>c iterate since lines optically thick
<br>iterate
<br>c set microturbulence in equipartition with B field
<br>turbulence equipartition
<br>c set the line width so lines appear on the punch continuum
<br>set punchLwidth 10 km/s
<br>c
<br>c commands for density & abundances =========
<br>c this is the log of the initial H density, cm-3
<br>hden 4
<br>c this will speed up the calculation a bit
<br>init file="ism.ini"
<br>c this uses HII region abundances, but no grains
<br>abundances hii region no grains
<br>c this uses orion grains
<br>grains orion
<br>c turn on PAHs, with an abundance that depends on H0 fraction,
<br>c as suggested by long-slit observations of Orion bar,
<br>c with an abundance 3x larger than default built into the code
<br>grains pah function 3 
<br>c 
<br>c commands controlling output    =========
<br>c print lots of faint CO lines
<br>print line faint -6
<br>c normalize to Ha
<br>normalize to "H  1" 6563
<br>punch overview last "orion_hii_pdr_pp.ovr"
<br>punch temperature last "orion_hii_pdr_pp.tem"
<br>punch overview "orion_hii_pdr_pp.ovr1"
<br>punch molecules last "orion_hii_pdr_pp.mol"
<br>punch molecules "orion_hii_pdr_pp.mol1"
<br>punch heating "orion_hii_pdr_pp.het"
<br>punch cooling "orion_hii_pdr_pp.col"
<br>punch dr last "orion_hii_pdr_pp.dr"
<br>punch results last "orion_hii_pdr_pp.rlt"
<br>punch continuum last "orion_hii_pdr_pp.con" units microns
<br>punch hydrogen 21 cm last "orion_hii_pdr_pp.21cm"
<br>punch hydrogen lya last "orion_hii_pdr_pp.lya" 
<br>punch element silicon last "orion_hii_pdr_pp.sil" 
<br>punch pressure last "orion_hii_pdr_pp.pre" 
<br>punch pressure "orion_hii_pdr_pp.pre1" 
<br>punch grain extinction last  "orion_hii_pdr_pp.grnext"
<br>punch grain charge last "orion_hii_pdr_pp.grnchr" 
<br>punch grain potential last "orion_hii_pdr_pp.grnpot" 
<br>punch grain temperature last "orion_hii_pdr_pp.grntem" 
<br>punch grain temperature "orion_hii_pdr_pp.grntem1" 
<br>c
<br>c
<br>c orion_hii_pdr_pp.in
<br>c class hii pdr  
<br>c ========================================
</kbd><p>
similar to orion_hii_pdr except for plane parallel geometry
</p><hr><h2><kbd>pdr_co_fully.in  </kbd><I>H2 and CO in fully molecular limit 
</I></h2><kbd><br>title H2 and CO in fully molecular limit 
<br>c this is a pair with pdr_co_fully_noneq - that tests non equilibrium chem
<br>c
<br>c commands controlling continuum =========
<br>blackbody 5000
<br>luminosity total solar linear 2
<br>brems 6
<br>luminosity total solar log -2.7
<br>c 
<br>c commands for density & abundances =========
<br>c set the density and composition, ism with grains
<br>hden 10
<br>abundances ism no qheat
<br>c
<br>c other commands for details     =========
<br>c this is an important ionization source
<br>cosmic ray background 
<br>c code will stop at 4000 K by default, lower this temp so we
<br>c can do fully molecular gas 
<br>stop temperature 10K linear
<br>c
<br>c commands controlling geometry  =========
<br>c the radius and thickness
<br>radius 15.8 
<br>stop thickness 6
<br>turbulence 3 km / s
<br>c
<br>c commands controlling output    =========
<br>punch overview "pdr_co_fully.ovr"
<br>punch molecules "pdr_co_fully.mol"
<br>punch dr "pdr_co_fully.dr"
<br>punch heating "pdr_co_fully.het"
<br>punch cooling "pdr_co_fully.col"
<br>punch grain charge "pdr_co_fully.grnchr"
<br>punch grain drift "pdr_co_fully.grndft"
<br>punch grain temperature "pdr_co_fully.grntem"
<br>c
<br>c 
<br>c gas has more he++ than He+ due to fast charge transfer with co
<br>c neutralizing he+ 
<br>c pdr_co_fully.in
<br>c class pdr 
<br>c ========================================
</kbd><p>
test code in fully molecular limit
this is a pair with pdr_co_fully_noneq - that tests non equilibrium chem
<p>
</p><hr><h2><kbd>pdr_co_fully_noneq.in  </kbd><I>H2 and CO are fully molecular, non-equilibrium case
</I></h2><kbd><br>title H2 and CO are fully molecular, non-equilibrium case
<br>c this is a pair with pdr_co_fully.in, which does not include non-equil chem
<br>c
<br>c commands controlling continuum =========
<br>blackbody 5000
<br>luminosity total solar linear 2
<br>brems 6
<br>luminosity total solar log -2.7
<br>c 
<br>c commands for density & abundances =========
<br>c set the density and composition, ism with grains
<br>hden 10
<br>abundances ism no qheat
<br>c
<br>c other commands for details     =========
<br>c this is an important ionization source
<br>cosmic ray background 
<br>c code will stop at 4000 K by default, lower this temp so we
<br>c can do fully molecular gas 
<br>stop temperature 10K linear
<br>c
<br>c commands controlling geometry  =========
<br>c the radius and thickness
<br>radius 15.8 
<br>stop thickness 6
<br>turbulence 3 km / s
<br>c this turns on non-equilibrium chemistry as suggested by Federman et al. 1996
<br>set chemistry non equilibrium 
<br>c
<br>c commands controlling output    =========
<br>punch overview "pdr_co_fully_noneq.ovr"
<br>punch molecules "pdr_co_fully_noneq.mol"
<br>punch dr "pdr_co_fully_noneq.dr"
<br>punch heating "pdr_co_fully_noneq.het"
<br>punch cooling "pdr_co_fully_noneq.col"
<br>punch grain charge "pdr_co_fully_noneq.grnchr"
<br>punch grain drift "pdr_co_fully_noneq.grndft"
<br>punch grain temperature "pdr_co_fully_noneq.grntem"
<br>c
<br>c 
<br>c gas has more he++ than He+ due to fast charge transfer with co
<br>c neutralizing he+ 
<br>c pdr_co_fully_noneq.in
<br>c class pdr 
<br>c ========================================
</kbd><p>
test code in fully molecular limit with Federman non-equilibrium chem
this is a pair with pdr_co_fully.in, which does not include non-equil chem
<p>
</p><hr><h2><kbd>pdr_coolbb.in  </kbd><I>illumination by cool STE blackbody
</I></h2><kbd><br>title illumination by cool STE blackbody
<br>c gasis fully molecular, grains should be in STE
<br>c
<br>c commands controlling continuum =========
<br>c illuminate with 120 blackbody in thermodynamic equilibrium
<br>blackbody 120 STE
<br>CMB  
<br>c 
<br>c commands for density & abundances =========
<br>c density
<br>hden 7
<br>c ism dust and grains
<br>abundances ISM no grains
<br>c dust to gas ratio is 10x standard
<br>grains 1.0
<br>c lowers metals and grains to 1/10 standard, so metals are
<br>c 1/10 solar while dust to gas ratio is galactic
<br>metals and grains 0.1
<br>c
<br>c other commands for details     =========
<br>c set background cosmic rays to allow chemistry 
<br>cosmic ray background 
<br>iterate
<br>c
<br>c commands controlling geometry  =========
<br>radius 17.5
<br>sphere
<br>stop temperature 20K linear 
<br>stop column density 25.5
<br>c
<br>c commands controlling output    =========
<br>punch overview "pdr_coolbb.ovr"
<br>punch molecules "pdr_coolbb.mol"
<br>punch heating "pdr_coolbb.het"
<br>punch cooling "pdr_coolbb.col"
<br>punch grain temperature "pdr_coolbb.grntem"
<br>c
<br>c
<br>c pdr_coolbb.in
<br>c class pdr 
<br>c ========================================
</kbd><p>
This is a dense ISM exposed to a cool blackbody.  This tests the
ability to converge onto a VERY molecular environment.  Nearly all
C and H are in CO and H2.  Cosmic rays are the main source of
heat and ionization.
<p>
</p><hr><h2><kbd>pdr_dense_persei.in  </kbd><I>dense phase zeta persei cloud
</I></h2><kbd><br>title dense phase zeta persei cloud
<br>c
<br>c density and abundances ==========
<br>c density of dense phase from Table 2 of Le Petit paper ========
<br>hden 4.3
<br>c 
<br>c abundandces from Table 1 of Le Petit paper ==========
<br>element carbon abundance 0.000132 linear
<br>element helium abundance 0.10 linear
<br>element oxygen abundance 0.00032 linear
<br>element nitrogen abundance 0.000075 linear
<br>element sulphur abundance 0.0000186 linear
<br>element silicon abundance 0.000029 linear
<br>c set abundance of all other elements to zero ====================
<br>element copper off
<br>element magnesium off
<br>element manganese off
<br>element sodium off
<br>element chlorine off
<br>element vanadium off
<br>element potassium off
<br>element phosphorous off
<br>element calcium off
<br>element iron off
<br>element zinc off
<br>element neon off
<br>element argon off
<br>element fluorine off
<br>element aluminum off
<br>element boron off
<br>element lithium off
<br>element beryllium off
<br>element scandium off
<br>element nickel off
<br>element titanium off
<br>element chromium off
<br>element cobalt off
<br>c do not use Federman rates for this model ==============
<br>set federman chemistry off
<br>c use standard ism grain size distribution ============
<br>grains ism 
<br>c 
<br>c command controlling the continuum, for this model is Draine 1978 field ====
<br>table draine 0.5 linear
<br>c make sure no H-ioinizing radiation strikes the cloud
<br>extinguish 24 
<br>c 
<br>c fix the temperature to 20 K =============
<br>constant temperature 20
<br>c stop at a radius of 4.3e-4 parsecs ============ 
<br>stop thickness 0.00043 parsecs linear
<br>c Le Petit model does not consider ices, so turn this off ============
<br>no grain molecules
<br>c turn on cosmic rays =========
<br>cosmic rays background
<br>c Set cosmic ray ionization rate to Table 2 of Le Petit paper ========
<br>set csupra -15.6
<br>c Allow calculation to go extend into cold environment ============
<br>stop temperature linear 3
<br>c 
<br>c commands controlling output ============
<br>punch overview "pdr_dense_persei.ovr"
<br>punch dr "pdr_dense_persei.dr"
<br>punch molecules "pdr_dense_persei.mol"
<br>punch heating "pdr_dense_persei.het"
<br>punch cooling "pdr_dense_persei.col"
<br>c 
<br>c pdr_dense_persei.in
<br>c class pdr
<br>c ====================================
</kbd><p>
This is the dense phase model presented by LePetit, Roueff, and Herbst 
in order to reproduce C2 and C3 column densities observed along the line
of sight to zera persei.  This is our attempt at reproducing their calculation.
This is the dense molecular phase, not the phase that produces H3+ 
<p>
// >>refer	model	pdr	Le Petit, F., Roueff, E., & Herbst, E. 2004,
// >>refercon	A&A, 417, 993
<p>
If you do a thermal equilibrium calculation by removing the constant temperature
command the kinetic temperature will be about three times larger than
assumed in their paper.
</p><hr><h2><kbd>pdr_HTT91.in  </kbd><I>low-density PDR from HTT91
</I></h2><kbd><br>title low-density PDR from HTT91
<br>c >>refer	test	model Hollenbach, D., Takahashi, T., &
<br>c >>refcon	Tielens, A.G.G.M., 1991, ApJ,377, 192-209
<br>c
<br>c commands controlling continuum =========
<br>c first continuum is FIR hot grain continuum produced in 
<br>c unmodeled HII Region
<br>c this is hot star continuum
<br>black 30000
<br>intensity  0.2 range  0.4412 to 1 Ryd
<br>c this will remove all ionizing radiation
<br>extinguish 24 0
<br>cosmic rays, background
<br>c
<br>c commands for density & abundances =========
<br>hden 3
<br>init file="ism.ini"
<br>abundances he -1.01 c -3.52 n-8 o-3.30 ne-8 mg-5.89
<br>continue si -6.10 s -5.10 cl-7 ar-8 fe -6.60
<br>grains orion, abundance log 0.16 no qheat 
<br>c
<br>c commands controlling geometry  =========
<br>sphere
<br>c stop when gas is fully neutral
<br>stop efrac -10
<br>c this is to stop at an intended place, since results would be
<br>c very dependent on details if we stop on temperature
<br>stop thickness 18.954
<br>c stop when gas is cold
<br>stop temperature 10 linear
<br>c add this to mimic unmodelled neutral gas
<br>double optical depths
<br>c
<br>c other commands for details     =========
<br>iterate  2
<br>case b
<br>turbulence 1.5 km/sec
<br>c 
<br>c commands controlling output    =========
<br>normalize to 157.6m "C  2" 
<br>c uv lines are strongly pumped by stellar continuum, break out contribution
<br>print line pump
<br>print line optical depths
<br>print ages
<br>punch overview last "pdr_HTT91.ovr"
<br>punch dr "pdr_HTT91.dr"
<br>punch molecules last "pdr_HTT91.mol"
<br>punch results last "pdr_HTT91.rlt"
<br>punch continuum units microns last "pdr_HTT91.con"
<br>punch heating last "pdr_HTT91.het"
<br>punch cooling last "pdr_HTT91.col"
<br>c
<br>c pdr_HTT91.in
<br>c class pdr 
<br>c ========================================
<br>c 
</kbd><p>
This is the Hollenbach et al 1991 Low-density PDR
The case b command appears because the Lyman lines are
vastly optically thick in this environment. 
If the command is removed the Lyman lines will be optically thin,
which will result in fast fluorescent excitation of the
(nearly totally neutral) hydrogen atom.  
<p>
there is very little CO in this model since it is not thick enough
for the UV pumping lines to become optically thick
</p><hr><h2><kbd>pdr_leiden_f1.in  </kbd><I>Leiden meeting model 1
</I></h2><kbd><br>title Leiden meeting model 1
<br>c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>c
<br>c commands controlling continuum =========
<br>c Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br>c the requested value, so the actual value
<br>c they want for the model is actually twice the value below
<br>table draine 5
<br>extinguish 24
<br>c
<br>c commands for density & abundances =========
<br>c  hydrogen density 
<br>hden 3.
<br>grains ism 1.16 no qheat
<br>c
<br>c commands controlling geometry  =========
<br>c
<br>c other commands for details     =========
<br>failures 3
<br>c use leiden initialization file
<br>init file="pdr_leiden.ini"
<br>c This command defines the grain temperature to be a constant 20 Kelvin
<br>constant grain temperature 20 
<br>c This sets the temperature to a constant 50 Kelvin
<br>constant temperature 50 linear
<br>c
<br>c commands controlling output    =========
<br>print line optical depths 
<br>punch overview "pdr_leiden_f1.ovr"
<br>punch continuum "pdr_leiden_f1.con"
<br>punch leiden lines "pdr_leiden_f1.lin"
<br>punch leiden "pdr_leiden_f1.lei"
<br>punch dr "pdr_leiden_f1.dr" 
<br>punch molecules "pdr_leiden_f1.mol"
<br>punch grain physical conditions "pdr_leiden_f1.grn"
<br>punch chemistry rates CO "pdr_leiden_f1.rat"
<br>punch H2 destruction "pdr_leiden_f1.H2d"
<br>punch H2 creation "pdr_leiden_f1.H2c"
<br>punch secondaries "pdr_leiden_f1.sec"
<br>c
<br>c
<br>c pdr_leiden_f1.in
<br>c class pdr  
<br>c ========================================
<br>c 
</kbd><p>
<p>
This sim has some interesting properties.  The grain temp is so low that
O freezes onto grains as H2O.  This is so efficient that CO does not become
well formed - the CO/C ratio only reaches 0.3.
This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
</p><hr><h2><kbd>pdr_leiden_f2.in  </kbd><I>Leiden meeting model 2
</I></h2><kbd><br>title Leiden meeting model 2
<br>c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>c
<br>c commands controlling continuum =========
<br>c Use the Draine 1978 field, for a semi-infinite slab we have to use
<br>c half the requested value, so the actual value
<br>c they want for the model is actually twice the value below
<br>table draine 50000
<br>extinguish 24
<br>c
<br>c commands for density & abundances =========
<br>grains ism 1.16 no qheat
<br>c  hydrogen density 
<br>hden 3.
<br>c
<br>c commands controlling geometry  =========
<br>c
<br>c other commands for details     =========
<br>failures 3
<br>c  use leiden initialization file
<br>init file="pdr_leiden.ini"
<br>c  This command defines the grain temperature to be a constant 20 Kelvin
<br>constant grain temperature 20 
<br>c  This sets the temperature to a constant 50 Kelvin
<br>constant temperature 50 linear
<br>c
<br>c commands controlling output    =========
<br>punch overview "pdr_leiden_f2.ovr"
<br>punch continuum "pdr_leiden_f2.con"
<br>punch molecules "pdr_leiden_f2.mol"
<br>punch leiden lines "pdr_leiden_f2.lin"
<br>punch leiden "pdr_leiden_f2.lei"
<br>punch dr "pdr_leiden_f2.dr" 
<br>punch grain physical conditions "pdr_leiden_f2.grn"
<br>c
<br>c 
<br>c pdr_leiden_f2.in
<br>c class pdr 
<br>c ========================================
<br>c 
</kbd><p>
c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
</p><hr><h2><kbd>pdr_leiden_f3.in  </kbd><I>Leiden meeting model 3
</I></h2><kbd><br>title Leiden meeting model 3
<br>c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>c
<br>c commands controlling continuum =========
<br>c Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br>c the requested value, so the actual value
<br>c they want for the model is actually twice the value below
<br>table draine 5
<br>extinguish 24
<br>c
<br>c commands for density & abundances =========
<br>grains ism 1.16 no qheat
<br>c  hydrogen density 
<br>hden 5.5
<br>c
<br>c commands controlling geometry  =========
<br>c
<br>c other commands for details     =========
<br>failures 3
<br>c  use leiden initialization file
<br>init file="pdr_leiden.ini"
<br>c  This command defines the grain temperature to be a constant 20 Kelvin
<br>constant grain temperature 20 
<br>c  This sets the temperature to a constant 50 Kelvin
<br>constant temperature 50 linear
<br>c
<br>c commands controlling output    =========
<br>punch overview "pdr_leiden_f3.ovr"
<br>punch continuum "pdr_leiden_f3.con"
<br>punch leiden lines "pdr_leiden_f3.lin"
<br>punch leiden "pdr_leiden_f3.lei"
<br>punch dr "pdr_leiden_f3.dr" 
<br>punch grain physical conditions "pdr_leiden_f3.grn"
<br>c
<br>c 
<br>c pdr_leiden_f3.in
<br>c class pdr 
<br>c ========================================
<br>c 
</kbd><p>
c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
</p><hr><h2><kbd>pdr_leiden_f4.in  </kbd><I>Leiden meeting model 4
</I></h2><kbd><br>title Leiden meeting model 4
<br>c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>c
<br>c commands controlling continuum =========
<br>c
<br>c commands for density & abundances =========
<br>grains ism 1.16 no qheat
<br>c
<br>c commands controlling geometry  =========
<br>c Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br>c the requested value, so the actual value
<br>c they want for the model is actually twice the value below
<br>table draine 50000
<br>extinguish 24
<br>c
<br>c other commands for details     =========
<br>failures 3
<br>c  use leiden initialization file
<br>init file="pdr_leiden.ini"
<br>c  This command defines the grain temperature to be a constant 20 Kelvin
<br>constant grain temperature 20 
<br>c  This sets the temperature to a constant 50 Kelvin
<br>constant temperature 50 linear
<br>c  hydrogen density 
<br>hden 5.5
<br>c
<br>c commands controlling output    =========
<br>punch overview "pdr_leiden_f4.ovr"
<br>punch continuum "pdr_leiden_f4.con"
<br>punch leiden lines "pdr_leiden_f4.lin"
<br>punch leiden "pdr_leiden_f4.lei"
<br>punch dr "pdr_leiden_f4.dr" 
<br>punch grain physical conditions "pdr_leiden_f4.grn"
<br>c
<br>c 
<br>c pdr_leiden_f4.in
<br>c class pdr 
<br>c ========================================
<br>c 
</kbd><p>
c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
</p><hr><h2><kbd>pdr_leiden_hack_f1.in  </kbd><I>Leiden meeting model 1 with hacks
</I></h2><kbd><br>title Leiden meeting model 1 with hacks
<br>c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>c
<br>c commands controlling continuum =========
<br>c Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br>c the requested value, so the actual value
<br>c they want for the model is actually twice the value below
<br>table draine 5
<br>extinguish 24
<br>c
<br>c commands for density & abundances =========
<br>c  hydrogen density 
<br>hden 3.
<br>grains ism 1.16 no qheat
<br>c
<br>c commands controlling geometry  =========
<br>c
<br>c other commands for details     =========
<br>failures 3
<br>c use leiden initialization file
<br>init file="pdr_leiden_hack.ini"
<br>c This command defines the grain temperature to be a constant 20 Kelvin
<br>constant grain temperature 20 
<br>c This sets the temperature to a constant 50 Kelvin
<br>constant temperature 50 linear
<br>c
<br>c commands controlling output    =========
<br>punch leiden lines "pdr_leiden_hack_f1.lin"
<br>punch leiden "pdr_leiden_hack_f1.lei"
<br>punch dr "pdr_leiden_hack_f1.dr" 
<br>punch grain physical conditions "pdr_leiden_hack_f1.grn"
<br>punch overview "pdr_leiden_hack_f1.ovr"
<br>c
<br>c
<br>c
<br>c
<br>c pdr_leiden_f1_hack.in
<br>c class pdr  
<br>c ========================================
<br>c 
</kbd><p>
c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
this includes hacks to get "standard answer" 
</p><hr><h2><kbd>pdr_leiden_hack_f2.in  </kbd><I>Leiden meeting model 2 with hacks
</I></h2><kbd><br>title Leiden meeting model 2 with hacks
<br>c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>c
<br>c commands controlling continuum =========
<br>c Use the Draine 1978 field, for a semi-infinite slab we have to use
<br>c half the requested value, so the actual value
<br>c they want for the model is actually twice the value below
<br>table draine 50000
<br>extinguish 24
<br>c
<br>c commands for density & abundances =========
<br>grains ism 1.16 no qheat
<br>c  hydrogen density 
<br>hden 3.
<br>c
<br>c commands controlling geometry  =========
<br>c
<br>c other commands for details     =========
<br>failures 3
<br>c  use leiden initialization file
<br>init file="pdr_leiden_hack.ini"
<br>c  This command defines the grain temperature to be a constant 20 Kelvin
<br>constant grain temperature 20 
<br>c  This sets the temperature to a constant 50 Kelvin
<br>constant temperature 50 linear
<br>c
<br>c commands controlling output    =========
<br>punch leiden lines "pdr_leiden_hack_f2.lin"
<br>punch leiden "pdr_leiden_hack_f2.lei"
<br>punch dr "pdr_leiden_hack_f2.dr" 
<br>punch grain physical conditions "pdr_leiden_hack_f2.grn"
<br>punch overview "pdr_leiden_hack_f2.ovr"
<br>c
<br>c 
<br>c pdr_leiden_hack_f2.in
<br>c class pdr 
<br>c ========================================
<br>c 
</kbd><p>
c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
includes hacks to get standard answer.
</p><hr><h2><kbd>pdr_leiden_hack_f3.in  </kbd><I>Leiden meeting model 3 with hacks
</I></h2><kbd><br>title Leiden meeting model 3 with hacks
<br>c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>c
<br>c commands controlling continuum =========
<br>c Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br>c the requested value, so the actual value
<br>c they want for the model is actually twice the value below
<br>table draine 5
<br>extinguish 24
<br>c
<br>c commands for density & abundances =========
<br>grains ism 1.16 no qheat
<br>c  hydrogen density 
<br>hden 5.5
<br>c
<br>c commands controlling geometry  =========
<br>c
<br>c other commands for details     =========
<br>failures 3
<br>c  use leiden initialization file
<br>init file="pdr_leiden_hack.ini"
<br>c  This command defines the grain temperature to be a constant 20 Kelvin
<br>constant grain temperature 20 
<br>c  This sets the temperature to a constant 50 Kelvin
<br>constant temperature 50 linear
<br>c
<br>c commands controlling output    =========
<br>punch leiden lines "pdr_leiden_hack_f3.lin"
<br>punch leiden overview "pdr_leiden_hack_f3.ovr"
<br>punch leiden "pdr_leiden_hack_f3.lei"
<br>punch dr "pdr_leiden_hack_f3.dr" 
<br>punch grain physical conditions "pdr_leiden_hack_f3.grn"
<br>c
<br>c 
<br>c pdr_leiden_hack_f3.in
<br>c class pdr 
<br>c ========================================
<br>c 
</kbd><p>
c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
include hacks to get standard answer.
</p><hr><h2><kbd>pdr_leiden_hack_f4.in  </kbd><I>Leiden meeting model 4 with hacks
</I></h2><kbd><br>title Leiden meeting model 4 with hacks
<br>c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>c
<br>c commands controlling continuum =========
<br>c
<br>c commands for density & abundances =========
<br>grains ism 1.16 no qheat
<br>c
<br>c commands controlling geometry  =========
<br>c Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br>c the requested value, so the actual value
<br>c they want for the model is actually twice the value below
<br>table draine 50000
<br>extinguish 24
<br>c
<br>c other commands for details     =========
<br>failures 3
<br>c  use leiden initialization file
<br>init file="pdr_leiden_hack.ini"
<br>c  This command defines the grain temperature to be a constant 20 Kelvin
<br>constant grain temperature 20 
<br>c  This sets the temperature to a constant 50 Kelvin
<br>constant temperature 50 linear
<br>c  hydrogen density 
<br>hden 5.5
<br>c
<br>c commands controlling output    =========
<br>punch leiden lines "pdr_leiden_hack_f4.lin"
<br>punch leiden "pdr_leiden_hack_f4.lei"
<br>punch dr "pdr_leiden_hack_f4.dr" 
<br>punch grain physical conditions "pdr_leiden_hack_f4.grn"
<br>punch overview "pdr_leiden_hack_f4.ovr"
<br>c
<br>c 
<br>c pdr_leiden_hack_f4.in
<br>c class pdr 
<br>c ========================================
<br>c 
</kbd><p>
This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
includes hacks needed to get standard answer.
</p><hr><h2><kbd>pdr_leiden_hack_v1.in  </kbd><I>Leiden meeting model 5 with hacks
</I></h2><kbd><br>title Leiden meeting model 5 with hacks
<br>c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>c
<br>c commands controlling continuum =========
<br>c Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br>c the requested value, so the actual value
<br>c is half the requested value
<br>c they want for the model is actually twice the value below
<br>table draine 5
<br>extinguish 24
<br>c
<br>c commands for density & abundances =========
<br>c  hydrogen density 
<br>hden 3.
<br>grains ism 1.16 no qheat
<br>c
<br>c commands controlling geometry  =========
<br>c
<br>c other commands for details     =========
<br>failures 3
<br>c  use leiden initialization file
<br>init file="pdr_leiden_hack.ini"
<br>* element nitrogen on
<br>* element nitrogen scale -1
<br>* element silicon on
<br>* element silicon scale -1
<br>* element sulphur on
<br>* element sulphur scale -1
<br>* element chlorine on
<br>* element chlorine scale -1
<br>c  Define the abundance of PAHs so we can reproduce the same photoelectric
<br>c heating curve as BT94 
<br>c  We have also scaled the grain abundance to achieve the desired AV/NH ratio 
<br>* grains PAH no qheat 8
<br>c
<br>c commands controlling output    =========
<br>punch leiden lines "pdr_leiden_hack_v1.lin"
<br>punch leiden "pdr_leiden_hack_v1.lei"
<br>punch dr "pdr_leiden_hack_v1.dr" 
<br>punch grain temperature "pdr_leiden_hack_v1.grn"
<br>punch overview "pdr_leiden_hack_v1.ovr"
<br>c
<br>c
<br>c pdr_leiden_hack_v1.in
<br>c class pdr 
<br>c ========================================
<br>c 
</kbd><p>
This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
includes hacks to get standard answer.
</p><hr><h2><kbd>pdr_leiden_hack_v2.in  </kbd><I>Leiden meeting model 6 with hacks
</I></h2><kbd><br>title Leiden meeting model 6 with hacks
<br>c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>c
<br>c commands controlling continuum =========
<br>c Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br>c the requested value, so the actual value
<br>c they want for the model is actually twice the value below
<br>table draine 50000
<br>extinguish 24
<br>c
<br>c commands for density & abundances =========
<br>c  Define the abundance of PAHs so we can reproduce the same photoelectric
<br>c heating curve as BT94 
<br>c  We have also scaled the grain abundance to achieve the desired AV/NH ratio 
<br>* grains PAH no qheat 40
<br>grains ism 1.16 no qheat
<br>c  hydrogen density 
<br>hden 3.
<br>c
<br>c commands controlling geometry  =========
<br>c
<br>c other commands for details     =========
<br>failures 3
<br>c  use leiden initialization file
<br>init file="pdr_leiden_hack.ini"
<br>c
<br>c commands controlling output    =========
<br>punch leiden lines "pdr_leiden_hack_v2.lin"
<br>punch leiden "pdr_leiden_hack_v2.lei"
<br>punch dr "pdr_leiden_hack_v2.dr" 
<br>punch grain temperature "pdr_leiden_hack_v2.grn"
<br>punch overview "pdr_leiden_hack_v2.ovr"
<br>punch heating "pdr_leiden_hack_v2.het"
<br>punch cooling "pdr_leiden_hack_v2.col"
<br>punch h2 rates "pdr_leiden_hack_v2.h2rat"
<br>c
<br>c
<br>c pdr_leiden_hack_v2.in
<br>c class pdr  
<br>c ========================================
<br>c 
</kbd><p>
This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
includes hacks to get standard answer.
</p><hr><h2><kbd>pdr_leiden_hack_v3.in  </kbd><I>Leiden meeting model 7 with hacks
</I></h2><kbd><br>title Leiden meeting model 7 with hacks
<br>c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>c
<br>c commands controlling continuum =========
<br>c Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br>c the requested value, so the actual value
<br>c they want for the model is actually twice the value below
<br>table draine 5
<br>extinguish 24
<br>c
<br>c commands for density & abundances =========
<br>c  Define the abundance of PAHs so we can reproduce the same photoelectric
<br>c heating curve as BT94 
<br>c  We have also scaled the grain abundance to achieve the desired AV/NH ratio 
<br>* grains PAH no qheat 5.7
<br>grains ism 1.16 no qheat
<br>c  hydrogen density 
<br>hden 5.5
<br>c
<br>c commands controlling geometry  =========
<br>c
<br>c other commands for details     =========
<br>c this sim has more than one thermal solution - force into lowest one,
<br>c the one found by the rest of the group - without this we will find a
<br>c soln at 1400 K
<br>force temperature to 60K
<br>failures 3
<br>c  use leiden initialization file
<br>init file="pdr_leiden_hack.ini"
<br>c
<br>c commands controlling output    =========
<br>punch leiden lines "pdr_leiden_hack_v3.lin"
<br>punch leiden "pdr_leiden_hack_v3.lei"
<br>punch dr "pdr_leiden_hack_v3.dr" 
<br>punch grain temperature "pdr_leiden_hack_v3.grn"
<br>punch overview "pdr_leiden_hack_v3.ovr"
<br>punch heating "pdr_leiden_hack_v3.het"
<br>punch cooling "pdr_leiden_hack_v3.col"
<br>c
<br>c 
<br>c pdr_leiden_hack_v3.in
<br>c class pdr 
<br>c ========================================
<br>c 
</kbd><p>
This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
includes hacks to get standard answer
</p><hr><h2><kbd>pdr_leiden_hack_v4.in  </kbd><I>Leiden meeting model 8 with hacks
</I></h2><kbd><br>title Leiden meeting model 8 with hacks
<br>c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>c
<br>c commands controlling continuum =========
<br>c Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br>c the requested value, so the actual value
<br>c they want for the model is actually twice the value below
<br>table draine 50000
<br>extinguish 24 
<br>c
<br>c commands for density & abundances =========
<br>c  Define the abundance of PAHs so we can reproduce the same photoelectric
<br>c heating curve as BT94 
<br>c  We have also scaled the grain abundance to achieve the desired AV/NH ratio 
<br>* grains PAH no qheat 40
<br>* grains ism 0.936 no qheat
<br>grains ism 1.16 no qheat
<br>set PAH Bakes 
<br>c  hydrogen density 
<br>hden 5.5
<br>c
<br>c commands controlling geometry  =========
<br>c
<br>c other commands for details     =========
<br>* failures 3
<br>c  use leiden initialization file
<br>init file="pdr_leiden_hack.ini"
<br>c
<br>c commands controlling output    =========
<br>punch leiden lines "pdr_leiden_hack_v4.lin"
<br>punch leiden "pdr_leiden_hack_v4.lei"
<br>punch dr "pdr_leiden_hack_v4.dr" 
<br>punch grain temperature  "pdr_leiden_hack_v4.grn"
<br>punch overview "pdr_leiden_hack_v4.ovr"
<br>punch heating "pdr_leiden_hack_v4.het"
<br>punch cooling "pdr_leiden_hack_v4.col"
<br>punch transmitted continuum "pdr_leiden_hack_v4.con"
<br>c
<br>c
<br>c pdr_leiden_hack_v4.in
<br>c class pdr 
<br>c ========================================
<br>c 
</kbd><p>
This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
includes hacks to get standard answer. 
</p><hr><h2><kbd>pdr_leiden_v1.in  </kbd><I>Leiden meeting model 5
</I></h2><kbd><br>title Leiden meeting model 5
<br>c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>c
<br>c commands controlling continuum =========
<br>c Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br>c the requested value, so the actual value
<br>c is half the requested value
<br>c they want for the model is actually twice the value below
<br>table draine 5
<br>extinguish 24
<br>c
<br>c commands for density & abundances =========
<br>c  hydrogen density 
<br>hden 3.
<br>grains ism 1.16 no qheat
<br>c  add PAHs 
<br>grains PAH no qheat 3 function
<br>c
<br>c commands controlling geometry  =========
<br>c
<br>c other commands for details     =========
<br>failures 3
<br>c  use leiden initialization file
<br>init file="pdr_leiden.ini"
<br>c
<br>c commands controlling output    =========
<br>punch overview "pdr_leiden_v1.ovr"
<br>punch leiden lines "pdr_leiden_v1.lin"
<br>punch leiden "pdr_leiden_v1.lei"
<br>punch dr "pdr_leiden_v1.dr" 
<br>punch grain temperature "pdr_leiden_v1.grn"
<br>c
<br>c 
<br>c
<br>c pdr_leiden_v1.in
<br>c class pdr 
<br>c ========================================
<br>c 
</kbd><p>
This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
</p><hr><h2><kbd>pdr_leiden_v2.in  </kbd><I>Leiden meeting model 6
</I></h2><kbd><br>title Leiden meeting model 6
<br>c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>c
<br>c commands controlling continuum =========
<br>c Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br>c the requested value, so the actual value
<br>c they want for the model is actually twice the value below
<br>table draine 50000
<br>extinguish 24
<br>c
<br>c commands for density & abundances =========
<br>c add PAHs and grains
<br>grains PAH no qheat 3 function
<br>grains ism 1.16 no qheat
<br>c  hydrogen density 
<br>hden 3.
<br>c
<br>c commands controlling geometry  =========
<br>c
<br>c other commands for details     =========
<br>failures 3
<br>c  use leiden initialization file
<br>init file="pdr_leiden.ini"
<br>c
<br>c commands controlling output    =========
<br>punch overview "pdr_leiden_v2.ovr"
<br>punch leiden lines "pdr_leiden_v2.lin"
<br>punch leiden "pdr_leiden_v2.lei"
<br>punch dr "pdr_leiden_v2.dr" 
<br>punch grain temperature "pdr_leiden_v2.grn"
<br>c
<br>c
<br>c pdr_leiden_v2.in
<br>c class pdr  
<br>c ========================================
<br>c 
</kbd><p>
c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
</p><hr><h2><kbd>pdr_leiden_v3.in  </kbd><I>Leiden meeting model 7
</I></h2><kbd><br>title Leiden meeting model 7
<br>c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>c
<br>c commands controlling continuum =========
<br>c Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br>c the requested value, so the actual value
<br>c they want for the model is actually twice the value below
<br>table draine 5
<br>extinguish 24
<br>c
<br>c commands for density & abundances =========
<br>c add PAHs and grains
<br>grains PAH no qheat 3 function
<br>grains ism 1.16 no qheat
<br>c  hydrogen density 
<br>hden 5.5
<br>c
<br>c commands controlling geometry  =========
<br>c
<br>c other commands for details     =========
<br>failures 3
<br>c  use leiden initialization file
<br>init file="pdr_leiden.ini"
<br>c
<br>c commands controlling output    =========
<br>punch overview "pdr_leiden_v3.ovr"
<br>punch leiden lines "pdr_leiden_v3.lin"
<br>punch leiden "pdr_leiden_v3.lei"
<br>punch dr "pdr_leiden_v3.dr" 
<br>punch grain temperature "pdr_leiden_v3.grn"
<br>punch heating "pdr_leiden_v3.het"
<br>punch cooling "pdr_leiden_v3.col"
<br>c
<br>c 
<br>c pdr_leiden_v3.in
<br>c class pdr 
<br>c ========================================
<br>c 
</kbd><p>
</p><hr><h2><kbd>pdr_leiden_v4.in  </kbd><I>Leiden meeting model 8
</I></h2><kbd><br>title Leiden meeting model 8
<br>c This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>c
<br>c commands controlling continuum =========
<br>c Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br>c the requested value, so the actual value
<br>c they want for the model is actually twice the value below
<br>table draine 50000
<br>extinguish 24
<br>c
<br>c commands for density & abundances =========
<br>grains PAH no qheat 3 function
<br>grains ism 1.16 no qheat
<br>c  hydrogen density 
<br>hden 5.5
<br>c
<br>c commands controlling geometry  =========
<br>c
<br>c other commands for details     =========
<br>failures 3
<br>c  use leiden initialization file
<br>init file="pdr_leiden.ini"
<br>c
<br>c commands controlling output    =========
<br>punch overview "pdr_leiden_v4.ovr"
<br>punch leiden lines "pdr_leiden_v4.lin"
<br>punch leiden "pdr_leiden_v4.lei"
<br>punch dr "pdr_leiden_v4.dr" 
<br>punch grain temperature  "pdr_leiden_v4.grn"
<br>punch transmitted continuum "pdr_leiden_v4.con"
<br>c
<br>c
<br>c pdr_leiden_v4.in
<br>c class pdr 
<br>c ========================================
<br>c 
</kbd><p>
</p><hr><h2><kbd>pdr_orion_veil.in  </kbd><I>Orion's veil
</I></h2><kbd><br>title Orion's veil
<br>c
<br>c commands controlling continuum =========
<br>q(h) 50.000000 
<br>table star rubin  
<br>c AGN & CMB background
<br>background z=0   
<br>cosmic rays background 
<br>c as a test this was tried - atomic temperature raised fm 100 to 140
<br>c but nothing really wrong
<br>* cosmic rays equipartition 
<br>c the observed magnetic field, roughly 100 micro Gauss
<br>magnetic field -4 
<br>c
<br>c commands for density & abundances =========
<br>hden 3.1
<br>init "ism.ini"
<br>abundances orion no grains  
<br>grains orion no qheat 
<br>c
<br>c commands controlling geometry  =========
<br>stop neutral hydrogen column density 21.6  
<br>radius 19.1
<br>stop temperature linear 5  
<br>c this will not be hit, but put it in to insure that we stop if
<br>c gas becomes totally molecular
<br>stop av 10 
<br>c
<br>c other commands for details     =========
<br>failures 3
<br>* uncomment to include large H2 molecule - results will CHANGE!
<br>* atom h2 
<br>turbulence 0.5 km/sec 
<br>sphere  
<br>c c this simulates Lyman lines in the stellar continuum
<br>c atom h-like lyman pumping off 
<br>c
<br>c commands controlling output    =========
<br>print line optical depths
<br>punch PDR "pdr_orion_veil.pdr"
<br>punch feii column densities "pdr_orion_veil.fe2col"
<br>punch hydrogen 21 cm "pdr_orion_veil.21cm"
<br>punch molecules "pdr_orion_veil.mol"
<br>punch overveiw "pdr_orion_veil.ovr"
<br>punch column densities "pdr_orion_veil.col"   
<br>punch heating "pdr_orion_veil.het"
<br>punch cooling "pdr_orion_veil.col"
<br>punch dr "pdr_orion_veil.dr"
<br>punch H2 rates "pdr_orion_veil.h2rat"
<br>punch pressure "pdr_orion_veil.pre"
<br>punch wind "pdr_orion_veil.wnd"
<br>print line optical depths
<br>punch continuum units microns "pdr_orion_veil.con" last 
<br>c
<br>c pdr_orion_veil.in
<br>c class pdr 
<br>c ========================================
<br>c 
</kbd><p>
This is Abel et al 2004 model of Orion's veil, the layer of gas in front
of the Orion Nebula.  
>>refer	Orion	Veil	Abel, N. P., Brogan, C. L.,  Ferland, G. J., 
>>refercon	O'Dell, C. R., Shaw, G., & Troland, T. H. 2004
<p>
</p><hr><h2><kbd>pdr_th85ism.in  </kbd><I>TH85 PDR with ISM grains
</I></h2><kbd><br>title TH85 PDR with ISM grains
<br>c
<br>c commands controlling continuum =========
<br>c cosmic radiation background
<br>background z=0
<br>c cosmic ray background ionization and heating 
<br>cosmic rays, background
<br>c first continuum is FIR hot grain continuum produced in 
<br>c unmodeled HII Region
<br>blackbody, t = 75 K
<br>intensity 2.7 (total)
<br>c this is the attenuated hot stellar continuum
<br>black 30000
<br>intensity  2.204 range  0.4412 to 1 Ryd
<br>c this will remove all ionizing radiation
<br>extinguish 24 0
<br>c
<br>c commands controlling geometry  =========
<br>c simulate effects of gas we do not model
<br>double
<br>c their turbulence
<br>turbulence 2.7 km/sec
<br>c stopping criteria
<br>c this should be the one actually used
<br>stop AV 33.2 extended 
<br>c stop when gas is fully neutral
<br>stop efrac -10
<br>c stop when gas is cold
<br>stop temperature 10 linear
<br>c stop at thickness of 16.5 so that mole limit does not
<br>c stop this calculation - that would make results very
<br>c detail dependent
<br>stop thickness 19
<br>c
<br>c commands for density & abundances =========
<br>hden 5.362
<br>c this turns off some elements, and processes we don't need
<br>c so needs to come before the elements 
<br>init file="ism.ini"
<br>abundances he -1.01 c -3.52 n-8 o-3.30 ne-8 mg-5.89
<br>continue si -6.10 s -5.10 cl-7 ar-8 fe -6.60
<br>c use ism abundances but turn of quantum heating 
<br>grains ism, abundance log 0.16 no qheat 
<br>c
<br>c other commands for details     =========
<br>c must iterate since many FIR MIR lines are optically thick
<br>iterate 
<br>c this is a closed geometry, in Orion, veil covers 2pi sr
<br>sphere
<br>c make Lyman lines very optically thick, which stops pumping by
<br>c Balmer continuum
<br>case b
<br>c this should run cleanly - turn down number of allow conv fails
<br>failures 3 
<br>c
<br>c commands controlling output    =========
<br>normalize to "C  2" 157.6m 
<br>c want the spectrum to be relative to this [C II] line
<br>c uv lines are strongly pumped by stellar continuum, break out contribution
<br>print line pump
<br>print line optical depths
<br>print ages
<br>punch overview last "pdr_th85ism.ovr"
<br>punch pdr last "pdr_th85ism.pdr"
<br>punch molecules last "pdr_th85ism.mol"
<br>punch dr last "pdr_th85ism.dr"
<br>punch hydrogen physical conditions last "pdr_th85ism.hyd" 
<br>punch results last "pdr_th85ism.rlt"
<br>punch continuum units microns last "pdr_th85ism.con"
<br>punch heating last "pdr_th85ism.het"
<br>punch cooling last "pdr_th85ism.col"
<br>punch hydrogen 21 cm last "pdr_th85ism.21cm"
<br>punch element magnesium last "pdr_th85ism.mag"
<br>punch grain extinction last  "pdr_th85ism.grnext"
<br>punch grain potential last   "pdr_th85ism.grnpot"
<br>punch grain temperature last "pdr_th85ism.grntem"
<br>punch grain charge last "pdr_th85ism.grnchr"
<br>c
<br>table lines "LineList_PDR.dat"
<br>c pdr_th85ism.in
<br>c class pdr 
<br>c ========================================
<br>c 
</kbd><p>
This is the Tielens and Hollenbach (1985a, b) standard model of
the Orion photodissociation region (PDR).  Specifically,
this is my attempt at their Table 2 of paper 2, ApJ 291,  p749.
The case b command appears because the Lyman lines are
vastly optically thick in this environment. 
If the command is removed the Lyman lines will be optically thin,
which will result in fast fluorescent excitation of the
(nearly totally neutral) hydrogen atom.
<p>
// >>refer	model	pdr	Tielens, A. G. G. M., & Hollenbach, D. 1985a, ApJ, 291, 722
// >>refer	model	pdr	Tielens, A. G. G. M., & Hollenbach, D. 1985b, ApJ, 291, 746
  
</p><hr><h2><kbd>pdr_th85ism_cgto.in  </kbd><I>TH85 pdr with ISM grains and C > O
</I></h2><kbd><br>title TH85 pdr with ISM grains and C > O
<br>c
<br>c commands controlling continuum =========
<br>c cosmic radiation background
<br>background z=0
<br>c cosmic ray background ionization and heating 
<br>cosmic rays, background
<br>c first continuum is FIR hot grain continuum produced in 
<br>c unmodeled HII Region
<br>blackbody, t = 75 K
<br>intensity 2.7 (total)
<br>c this is the attenuated hot stellar continuum
<br>black 30000
<br>intensity  2.204 range  0.4412 to 1 Ryd
<br>c this will remove all ionizing radiation
<br>extinguish 24 0
<br>c
<br>c commands controlling geometry  =========
<br>c simulate effects of gas we do not model
<br>double
<br>c their turbulence
<br>turbulence 2.7 km/sec
<br>c stopping criteria
<br>c this should be the one actually used
<br>stop AV 33.2 extended 
<br>c stop when gas is fully neutral
<br>stop efrac -10
<br>c stop when gas is cold
<br>stop temperature 10 linear
<br>c stop at thickness of 16.5 so that mole limit does not
<br>c stop this calculation - that would make results very
<br>c detail dependent
<br>stop thickness 19
<br>c
<br>c commands for density & abundances =========
<br>hden 5.362
<br>c this turns off some elements, and processes we don't need
<br>c so needs to come before the elements 
<br>init file="ism.ini"
<br>c this is the TH85 mix except C is raised by 0.2 dex,
<br>c and O lowered byt his amount, so that C/O > 1
<br>abundances he -1.01 c -3.4 n-8 o-3.50 ne-8 mg-5.89
<br>continue si -6.10 s -5.10 cl-7 ar-8 fe -6.60
<br>c use ism abundances but turn of quantum heating 
<br>grains ism, abundance log 0.16 no qheat 
<br>c
<br>c other commands for details     =========
<br>c must iterate since many FIR MIR lines are optically thick
<br>iterate 
<br>c this is a closed geometry, in Orion, veil covers 2pi sr
<br>sphere
<br>c make Lyman lines very optically thick, which stops pumping by
<br>c Balmer continuum
<br>case b
<br>c this should run cleanly - turn down number of allow conv fails
<br>failures 3 
<br>c
<br>c commands controlling output    =========
<br>normalize to "C  2" 157.6m 
<br>c want the spectrum to be relative to this [C II] line
<br>c uv lines are strongly pumped by stellar continuum, break out contribution
<br>print line pump
<br>print line optical depths
<br>print ages
<br>punch overview last "pdr_th85ism_cgto.ovr"
<br>punch pdr last "pdr_th85ism_cgto.pdr"
<br>punch molecules last "pdr_th85ism_cgto.mol"
<br>punch dr last "pdr_th85ism_cgto.dr"
<br>punch hydrogen physical conditions last "pdr_th85ism_cgto.hyd" 
<br>punch results last "pdr_th85ism_cgto.rlt"
<br>punch continuum units microns last "pdr_th85ism_cgto.con"
<br>punch heating last "pdr_th85ism_cgto.het"
<br>punch cooling last "pdr_th85ism_cgto.col"
<br>punch hydrogen 21 cm last "pdr_th85ism_cgto.21cm"
<br>punch element magnesium last "pdr_th85ism_cgto.mag"
<br>punch grain extinction last  "pdr_th85ism_cgto.grnext"
<br>punch grain potential last   "pdr_th85ism_cgto.grnpot"
<br>punch grain temperature last "pdr_th85ism_cgto.grntem"
<br>punch grain charge last "pdr_th85ism_cgto.grnchr"
<br>c
<br>c pdr_th85ism_cgto.in
<br>c class pdr 
<br>c ========================================
<br>c 
</kbd><p>
This is the Tielens and Hollenbach (1985a, b) standard model of
the Orion photodissociation region (PDR) but with the C abundance
increased by 0.2 dex, and O lowered by this amount, so that C/O>1.
Specifically, this is their Table 2 of paper 2, ApJ 291,  p749.
The case b command appears because the Lyman lines are
vastly optically thick in this environment. 
If the command is removed the Lyman lines will be optically thin,
which will result in fast fluorescent excitation of the
(nearly totally neutral) hydrogen atom.
<p>
// >>refer	model	pdr	Tielens, A. G. G. M., & Hollenbach, D. 1985a, ApJ, 291, 722
// >>refer	model	pdr	Tielens, A. G. G. M., & Hollenbach, D. 1985b, ApJ, 291, 746
  
</p><hr><h2><kbd>pdr_th85orion.in  </kbd><I>TH85 PDR with Orion grains
</I></h2><kbd><br>title TH85 PDR with Orion grains
<br>c
<br>c commands controlling continuum =========
<br>c cosmic background
<br>background
<br>c galactic cosmic ray background 
<br>cosmic rays, background
<br>c first continuum is FIR hot grain continuum produced in 
<br>c unmodeled HII Region
<br>blackbody, t = 75 K
<br>intensity 2.7 (total)
<br>c this is the attenuated hot stellar continuum
<br>black 30000
<br>intensity  2.204 range  0.4412 to 1 Ryd
<br>c this will remove all ionizing radiation
<br>extinguish 24 0
<br>c
<br>c commands for density & abundances =========
<br>hden 5.362
<br>init file="ism.ini"
<br>grains orion, abundance log 0.16 no qheat 
<br>abundances he -1.01 c -3.52 n-8 o-3.30 ne-8 mg-5.89
<br>continue si -6.10 s -5.10 cl-7 ar-8 fe -6.60
<br>c
<br>c commands controlling geometry  =========
<br>c simulate effects of gas we do not model 
<br>double
<br>sphere
<br>c stopping criteria
<br>c this should be the one actually used
<br>c >>chn 04 mar 13, from 10 to 36.3, bug in AV had stopped at this depth,
<br>c so change it to this to keep model the same
<br>stop AV 36.3 extended 
<br>c stop when gas is fully neutral
<br>stop efrac -10
<br>c stop when gas is cold
<br>stop temperature 10 linear
<br>c stop at thickness so that would make results very
<br>c detail dependent
<br>stop thickness 19
<br>c
<br>c other commands for details     =========
<br>turbulence 2.7 km/sec
<br>iterate
<br>failures 3 
<br>c 
<br>c this is done to not allow pumping and subsequent photoionization
<br>c of H by Balmer continuum in keeping with std pdr assumptions 
<br>case b
<br>c
<br>c commands controlling output    =========
<br>normalize to "C  2" 157.6m 
<br>c uv lines are strongly pumped by stellar continuum, break out contribution
<br>print line pump
<br>print line optical depths
<br>print ages
<br>c
<br>punch overview "pdr_th85orion.ovr" no hash 
<br>punch pdr last "pdr_th85orion.pdr"
<br>c this only outputs major molecules 
<br>punch molecules last "pdr_th85orion.mol"
<br>punch dr "pdr_th85orion.dr"
<br>c this is to get all of H molecules 
<br>punch hydrogen physical conditions last "pdr_th85orion.hyd" 
<br>punch results last "pdr_th85orion.rlt"
<br>punch continuum units microns last "pdr_th85orion.con"
<br>punch ionizing continuum last "pdr_th85orion.ion"
<br>punch heating last "pdr_th85orion.het"
<br>punch cooling last "pdr_th85orion.col"
<br>punch hydrogen 21 cm last "pdr_th85orion.21cm"
<br>c these are for the grains
<br>punch grain extinction last  "pdr_th85orion.grnext"
<br>punch grain potential last   "pdr_th85orion.grnpot"
<br>punch grain temperature last "pdr_th85orion.grntem"
<br>punch grain charge last "pdr_th85orion.grnchr"
<br>c
<br>c
<br>c pdr_th85orion.in
<br>c class pdr  
<br>c ========================================
</kbd><p>
This is the Tielens and Hollenbach (1985a, b) standard model of
the Orion photodissociation region (PDR).  Specifically,
this is my attempt at their Table 2 of paper 2, ApJ 291,  p749.
The case b command appears because the Lyman lines are
vastly optically thick in this environment. 
If the command is removed the Lyman lines will be optically thin,
which will result in fast fluorescent excitation of the
(nearly totally neutral) hydrogen atom.
<p>
// >>refer	model	pdr	Tielens, A. G. G. M., & Hollenbach, D. 1985a, ApJ, 291, 722
// >>refer	model	pdr	Tielens, A. G. G. M., & Hollenbach, D. 1985b, ApJ, 291, 746
  
</p><hr><h2><kbd>pn_fluc.in  </kbd><I>Paris PN with density fluctuations
</I></h2><kbd><br>title Paris PN with density fluctuations
<br>c
<br>c commands for density & abundances =========
<br>fluctuations 16.5 4 3
<br>c this sets up the code like version c84, with fewer chemical elements
<br>init file="c84.ini"
<br>c this sets the abundances of the elements that we will use 
<br>abund -1 C-3.523 N-4. O-3.222 ne-3.824 na=-10 mg-4.523 al=-10
<br>continue si-4.523 s-4.824 ar-10 ca=-10 fe-10 ni=-10
<br>c
<br>c commands controlling continuum =========
<br>black body, T = 150000 K, radius = 10
<br>black 5
<br>luminosity total 38
<br>c
<br>c commands controlling geometry  =========
<br>sphere
<br>radius 17
<br>c
<br>c other commands for details     =========
<br>c
<br>c commands controlling output    =========
<br>punch overview last "pn_fluc.ovr"
<br>punch element nitrogen last "pn_fluc.nit"
<br>punch dr last "pn_fluc.dr"
<br>punch results last "pn_fluc.rlt"
<br>c
<br>c pn_fluc.in
<br>c class pn function
<br>c ========================================
</kbd><p>
The boundary conditions are similar to those for the Paris meeting PN,
a homogeneous grain-free PN.  This model has density fluctuations,
with values chosen so that the mean ne np V are the same
for the nebulae with and without fluctuations.  
<p>
<br>Checks:
<br>-	Check that the fluctuations command works.
<br>-	How do results compare with homogeneous Paris pn?
<p>
</p><hr><h2><kbd>pn_ots.in  </kbd><I>Paris PN with ots
</I></h2><kbd><br>title Paris PN with ots
<br>c recompute "standard" PN model of the Pequignot Meudon Conferance
<br>c
<br>c commands controlling continuum =========
<br>black body, T = 150000 K, radius = 10
<br>c
<br>c commands for density & abundances =========
<br>hden = 3.4771213
<br>init file="c84.ini"
<br>abund -1 C-3.523 N-4. O-3.222 ne-3.824 na=-10 mg-4.523 al=-10
<br>continue si-4.523 s-4.824 ar-10 ca=-10 fe-10 ni=-10
<br>c
<br>c commands controlling geometry  =========
<br>radius = 17
<br>sphere
<br>c
<br>c other commands for details     =========
<br>diffuse ots
<br>no level2
<br>iterate
<br>atom h-like element hydrogen levels resolved 10
<br>atom h-like element helium levels resolved 15
<br>c
<br>c commands controlling output    =========
<br>punch overview last "pn_ots.ovr"
<br>punch element nitrogen last "pn_ots.nit"
<br>punch results last "pn_ots.rlt"
<br>punch dr last "pn_ots.dr"
<br>c
<br>c pn_ots.in
<br>c class pn 
<br>c ========================================
<br>c 
</kbd><p>
This is the on-the-spot version of the Paris Planetary Nebula.
<br>Checks:
<br>-	Q(H) total 4861 luminosity is close to expected value
<br>-	Line spectrum similar to that predicted by default conditions.
<p>
</p><hr><h2><kbd>pn_paris.in  </kbd><I>Paris meeting PN
</I></h2><kbd><br>title Paris meeting PN
<br>c standard" PN model of the Pequignot Meudon Conferance
<br>c
<br>c commands controlling continuum =========
<br>black body, T = 150000 K, radius = 10
<br>c
<br>c commands for density & abundances =========
<br>hden = 3.4771213
<br>init file="ism.ini"
<br>abund he -1 C-3.523 N-4. O-3.222 ne-3.824 mg-4.523 
<br>continue si-4.523 s-4.824 cl-7 ar-10 fe-10
<br>c
<br>c commands controlling geometry  =========
<br>radius = 17
<br>sphere
<br>c
<br>c other commands for details     =========
<br>age 10000 years
<br>c
<br>c commands controlling output    =========
<br>normalize to "Ca b" 4861 
<br>print line optical depths 
<br>print ages 
<br>print column densities 
<br>punch overview "pn_paris.ovr"
<br>punch transmitted continuum "pn_paris.trn"
<br>punch continuum units microns "pn_paris.con"
<br>punch element carbon  "pn_paris.car"
<br>punch physical conditions "pn_paris.phy"
<br>punch element nitrogen "pn_paris.nit" 
<br>punch dr "pn_paris.dr"
<br>punch temperature "pn_paris.tem"
<br>punch lines emissivity "pn_paris.ems"
<br>h  1 6563
<br>s  2 6720
<br>end of lines
<br>punch averages "pn_paris.avr" last
<br>temperature hydrogen 1 
<br>end of averagers
<br>c
<br>c pn_paris.in 
<br>c class pn 
<br>c ========================================
<br>c 
</kbd><p>
<p>
This is one of the "standard" models computed at the Paris meeting on
photoionization and shock calculations.  A table in Hazy compares the
predictions of the current version of CLOUDY with predictions of a
few of the other codes.
<p>
The model is meant to represent a planetary nebula ionized by a very
hot central object.  As a result there is a great deal of He++ and
the associated line and continuum emission is very important.
<p>
An age of 10000 years was set.  This tests logic in the age command.
<p>
</p><hr><h2><kbd>pn_paris_fast.in  </kbd><I>Paris PN, fast version
</I></h2><kbd><br>title Paris PN, fast version
<br>c standard" PN model of the Pequignot Meudon Conferance
<br>c
<br>c commands controlling continuum =========
<br>black body, T = 150000 K, radius = 10
<br>c
<br>c commands for density & abundances =========
<br>hden = 3.4771213
<br>init file="fast.ini"
<br>abund he -1 C-3.523 N-4. O-3.222 ne-3.824 mg-4.523 
<br>continue si-4.523 s-4.824 ar-10
<br>c
<br>c commands controlling geometry  =========
<br>sphere
<br>radius = 17
<br>c
<br>c other commands for details     =========
<br>c
<br>c commands controlling output    =========
<br>normalize to "Ca b" 4861
<br>punch overview "pn_paris_fast.ovr"
<br>punch physical conditions "pn_paris_fast.phy"
<br>punch element nitrogen "pn_paris_fast.nit" 
<br>punch dr "pn_paris_fast.dr"
<br>c
<br>c pn_paris_fast.in 
<br>c class pn 
<br>c ========================================
<br>c 
</kbd><p>
<p>
This is one of the "standard" models computed at the Paris meeting on
photoionization and shock calculations.  A table in Hazy compares the
predictions of the current version of CLOUDY with predictions of a
few of the other codes.
<p>
The model is meant to represent a planetary nebula ionized by a very
hot central object.  As a result there is a great deal of He++ and
the associated line and continuum emission is very important.
<p>
</p><hr><h2><kbd>pn_sqrden.in  </kbd><I>PN with density propt R^-2 and filling factor
</I></h2><kbd><br>title PN with density propt R^-2 and filling factor
<br>c this is an optically thin model, which will have a broad range
<br>c of density but the same ionization parameter across the model.  
<br>c the physical condtions should not vary by much across the structure
<br>c
<br>c commands controlling continuum =========
<br>c continuum is hot blackbody at ~Ledd for solar mass
<br>blackbody, t=5 luminosity=38
<br>c
<br>c commands for density & abundances =========
<br>c the density will fall off as the inverse square of the radius, hence the name
<br>hden 5 -2
<br>init file "ism.ini"
<br>c use default PN abundances but turn off quantum heating since
<br>c we are not going to save the predicted near IR continuum
<br>abundances planetary no qheat 
<br>c
<br>c commands controlling geometry  =========
<br>c small filling factor so that region will be optically thin
<br>filling factor -2
<br>c set inner and outer radius 
<br>radius 16 18
<br>sphere
<br>c
<br>c other commands for details     =========
<br>iterate
<br>c 
<br>c commands controlling output    =========
<br>print line faint 1 
<br>punch overview "pn_sqrden.ovr" last
<br>punch dr "pn_sqrden.dr" last
<br>c
<br>c pn_sqrden.in
<br>c class pn 
<br>c ========================================
</kbd><p>
<br>Checks:
<br>-	Zone thickness budgeting handled OK.
<br>-       physical conditions nearly constant across computed structure
<p>
</p><hr><h2><kbd>stars_atlas.in  </kbd><I>Atlas stellar atmosphere
</I></h2><kbd><br>title Atlas stellar atmosphere
<br>c
<br>c commands controlling continuum =========
<br>c Approximate model of a hot star ionizing its surroundings.
<br>c Assume H density of 1e+6 per cc.  This run tests the new Kurucz model option.
<br>c I choose the T_eff and log(g) values arbitrarily.  It implies a star
<br>c with luminosity 32300 L_sun, radius 6.4745 R_sun, and mass 3.745 M_sun.
<br>table star atlas 30400.0 4.2
<br>luminosity 4.509202522 solar
<br>c
<br>c commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>c
<br>c commands controlling geometry  =========
<br>radius -3.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>print continuum
<br>c
<br>punch overview last "stars_atlas.ovr"
<br>punch results last "stars_atlas.rlt"
<br>punch transmitted continuum last "stars_atlas.trn" no header
<br>punch continuum last "stars_atlas.con" units microns
<br>c
<br>c stars_atlas.in
<br>c class stars 
<br>c ========================================
</kbd><p>
This is a test that the code can correctly access the
large block of Atlas model atmosphere continua described by Kurucz (1991). 
Kevin Volk provided it as part of his original coding of these
stellar atmosphere files.
Constant temperature is assumed since this tests shape of stellar continuum
rather than thermal physics.
<p>
<br>Checks:
table star atlas command works.
<p>
</p><hr><h2><kbd>stars_atlas_3d.in  </kbd><I>Atlas stellar atmosphere, 3D interpolation
</I></h2><kbd><br>title Atlas stellar atmosphere, 3D interpolation
<br>c
<br>c commands controlling continuum =========
<br>c Approximate model of a hot star ionizing its surroundings.
<br>c Assume H density of 1e+6 per cc. This run tests the atlas 3dim model option.
<br>c I choose the T_eff and log(g) values arbitrarily.
<br>table star atlas 3-dim 38400.0 4.82 -1.42
<br>luminosity 4.509202522 solar
<br>table star atlas odfnew 3-dim 38400.0 4.82 0.42
<br>luminosity 4.509202522 solar
<br>c
<br>c commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>c
<br>c commands controlling geometry  =========
<br>radius -3.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>c
<br>punch overview last "stars_atlas_3d.ovr"
<br>punch results last "stars_atlas_3d.rlt"
<br>punch transmitted continuum last "stars_atlas_3d.trn" no header
<br>punch continuum last "stars_atlas_3d.con" units microns
<br>c
<br>c stars_atlas_3d.in
<br>c class stars 
<br>c ========================================
</kbd><p>
This is a test that the code can correctly access the
large 3-dim block of Atlas model atmosphere continua. 
<p>
<br>Checks:
table star atlas 3dim command works.
<p>
</p><hr><h2><kbd>stars_atlas_all.in  </kbd><I>interpolate on Atlas grids
</I></h2><kbd><br>title interpolate on Atlas grids
<br>c
<br>c commands controlling continuum =========
<br>c Include stars with a wide range of metallicities to test access to these grids.
<br>table star atlas Z+1.0 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z+0.5 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z+0.3 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z+0.2 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z+0.1 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z+0.0 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-0.1 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-0.2 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-0.3 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-0.5 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-1.0 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-1.5 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-2.0 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-2.5 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-3.0 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-3.5 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-4.0 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-4.5 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-5.0 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>c
<br>c commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>c
<br>c commands controlling geometry  =========
<br>radius -2.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>c
<br>punch overview last "stars_atlas_all.ovr"
<br>punch results last "stars_atlas_all.rlt"
<br>punch transmitted continuum last "stars_atlas_all.trn" no header
<br>punch continuum last "stars_atlas_all.con" units microns
<br>c
<br>c stars_atlas_all.in
<br>c class stars 
<br>c ========================================
</kbd><p>
This is a test that the code can correctly access the
2D grids of various metallicity of Atlas model atmosphere continua. 
<p>
<br>Checks:
access to the various atlas grids
<p>
</p><hr><h2><kbd>stars_atlas_odfnew_all.in  </kbd><I>access various Atlas ODFNEW grids
</I></h2><kbd><br>title access various Atlas ODFNEW grids
<br>c
<br>c commands controlling continuum =========
<br>c Include stars with a wide range of metallicities to test access to these grids.
<br>table star atlas odfnew Z+0.5 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas odfnew Z+0.2 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas odfnew Z+0.0 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas odfnew Z-0.5 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas odfnew Z-1.0 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas odfnew Z-1.5 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas odfnew Z-2.0 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas odfnew Z-2.5 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>c
<br>c commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>c
<br>c commands controlling geometry  =========
<br>radius -2.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>c
<br>punch overview last "stars_atlas_odfnew_all.ovr"
<br>punch results last "stars_atlas_odfnew_all.rlt"
<br>punch transmitted continuum last "stars_atlas_odfnew_all.trn" no header
<br>punch continuum last "stars_atlas_odfnew_all.con" units microns
<br>c
<br>c stars_atlas_odfnew_all.in
<br>c class stars 
<br>c ========================================
</kbd><p>
This is a test that the code can correctly access the
Atlas ODFNEW model atmosphere continua. 
<p>
<br>Checks:
access to the various atlas odfnew grids
</p><hr><h2><kbd>stars_bstar2006.in  </kbd><I>tlusty bstar grid
</I></h2><kbd><br>title tlusty bstar grid
<br>c
<br>c commands controlling continuum =========
<br>c Approximate model of a B star ionizing its surroundings.
<br>c Assume H density of 1e+6 per cc.  This run tests the new Tlusty model option.
<br>c I choose the T_eff and log(g) values arbitrarily.
<br>table star tlusty bstar 20400.0 4.2
<br>luminosity 4.509202522 solar
<br>c
<br>c commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>c
<br>c commands controlling geometry  =========
<br>radius -3.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>c
<br>c in this model the Lyman lines are pumped significantly by the stellar continuum;
<br>c disable this process to avoid critical dependence on the precise shape of the continuum.
<br>no induced processes
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>c
<br>punch overview last "stars_bstar2006.ovr"
<br>punch results last "stars_bstar2006.rlt"
<br>punch transmitted continuum last "stars_bstar2006.trn" no header
<br>c
<br>c stars_bstar2006.in
<br>c class stars 
<br>c ========================================
</kbd><p>
This is a test that the code can correctly access the
large block of Tlusty B-star model atmosphere continua. 
<p>
<br>Checks:
table star tlusty bstar command works.
<p>
</p><hr><h2><kbd>stars_bstar2006_3d.in  </kbd><I>tlusty bstar grid
</I></h2><kbd><br>title tlusty bstar grid
<br>c
<br>c commands controlling continuum =========
<br>c Approximate model of a B star ionizing its surroundings.
<br>c Assume H density of 1e+6 per cc. This run tests the new Tlusty model option.
<br>c I choose the T_eff, log(g) and log(Z) values arbitrarily.
<br>table star tlusty bstar 3-dim 20400.0 4.2 -0.573
<br>luminosity 4.509202522 solar
<br>c
<br>c commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>c
<br>c commands controlling geometry  =========
<br>radius -3.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>c
<br>c in this model the Lyman lines are pumped significantly by the stellar continuum;
<br>c disable this process to avoid critical dependence on the precise shape of the continuum.
<br>no induced processes
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>c
<br>punch overview last "stars_bstar2006_3d.ovr"
<br>punch results last "stars_bstar2006_3d.rlt"
<br>punch transmitted continuum last "stars_bstar2006_3d.trn" no header
<br>c
<br>c stars_bstar2006_3d.in
<br>c class stars 
<br>c ========================================
</kbd><p>
This is a test that the code can correctly access the
large 3-dim block of Tlusty B-star model atmosphere continua. 
<p>
<br>Checks:
table star tlusty bstar 3-dim command works.
<p>
</p><hr><h2><kbd>stars_bstar2006_all.in  </kbd><I>tlusty bstar grid
</I></h2><kbd><br>title tlusty bstar grid
<br>c
<br>c commands controlling continuum =========
<br>c Approximate model of 6 B stars ionizing their surroundings.
<br>c Assume H density of 1e+6 per cc.  This run tests all the various
<br>c metallicities contained in the BSTAR 2006 grids. I choose the T_eff
<br>c and log(g) values arbitrarily.
<br>table star tlusty bstar Z+0.3 20000.0 4.5
<br>luminosity 4.509202522 solar
<br>table star tlusty bstar Z+0.0 21400.0 4.5
<br>luminosity 4.509202522 solar
<br>table star tlusty bstar Z-0.3 15000.0 4.2
<br>luminosity 4.509202522 solar
<br>table star tlusty bstar Z-0.7 20400.0 4.2
<br>luminosity 4.509202522 solar
<br>table star tlusty bstar Z-1.0 27500.0 3.0
<br>luminosity 4.509202522 solar
<br>table star tlusty bstar Z-INF 18000.0 4.75
<br>luminosity 4.509202522 solar
<br>c
<br>c commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>c
<br>c commands controlling geometry  =========
<br>radius -2.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>c
<br>c in this model the Lyman lines are pumped significantly by the stellar continuum;
<br>c disable this process to avoid critical dependence on the precise shape of the continuum.
<br>no induced processes
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>c
<br>punch overview last "stars_bstar2006_all.ovr"
<br>punch results last "stars_bstar2006_all.rlt"
<br>punch transmitted continuum last "stars_bstar2006_all.trn" no header
<br>c
<br>c stars_bstar2006_all.in
<br>c class stars 
<br>c ========================================
</kbd><p>
This is a test that the code can correctly access the
large block of Tlusty B-star model atmosphere continua. 
<p>
<br>Checks:
table star tlusty bstar metallicity option works.
<p>
</p><hr><h2><kbd>stars_costar1.in  </kbd><I>costar interpolation mode 1
</I></h2><kbd><br>title costar interpolation mode 1
<br>c
<br>c commands controlling continuum =========
<br>table star costar, 40000 K
<br>ionization parameter -2
<br>table star costar, 31000 K, index 4
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>hden 2
<br>grains orion single no qheat 
<br>abundances ism no grains
<br>c
<br>c commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>* >>chng 06 jul 01, add this to stars set since want to test shape
<br>* of continuum and resulting ion dist, not thermal equilibrium of nebula
<br>constant temperature 6000K
<br>c
<br>c commands controlling output    =========
<br>punch continuum "stars_costar1.con" units microns last 
<br>c
<br>c stars_costar1.in
<br>c class stars 
<br>c ========================================
<br>c 
</kbd><p>
This is a test of whether the code can read the CoStar stellar atmospheres.
It checks the resulting ionization to confirm that the continuum 
shape was ok.
Constant temperature is assumed since this tests shape of stellar continuum
rather than thermal physics.
<p>
<p>
</p><hr><h2><kbd>stars_costar2.in  </kbd><I>costar interpolation mode 2
</I></h2><kbd><br>title costar interpolation mode 2
<br>c
<br>c commands controlling continuum =========
<br>table star costar 35575.4 4.2367
<br>ionization parameter -2
<br>table star costar 34468.5 3.86765
<br>ionization parameter -2
<br>table star costar 41741.2 4.02
<br>ionization parameter -2
<br>table star costar 45000 4.1593
<br>ionization parameter -2
<br>table star costar 27500 3.3
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>hden 2
<br>grains orion single no qheat 
<br>abundances ism no grains
<br>c
<br>c commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>c
<br>c commands controlling output    =========
<br>punch continuum "stars_costar2.con" units microns last 
<br>c
<br>c stars_costar2.in
<br>c class stars 
<br>c ========================================
<br>c 
</kbd><p>
This is a test of whether the code can read the CoStar stellar atmospheres.
It checks the resulting ionization to confirm that the continuum 
shape was ok.
<p>
</p><hr><h2><kbd>stars_costar3.in  </kbd><I>costar interpolation mode 3
</I></h2><kbd><br>title costar interpolation mode 3
<br>c
<br>c commands controlling continuum =========
<br>table star costar zams 40.0 Msol 2.85e6
<br>ionization parameter -2
<br>table star costar zams 40.0 Msol 4e6
<br>ionization parameter -2
<br>table star costar zams 50.9 Msol 2.85e6
<br>ionization parameter -2
<br>table star costar zams 42.9 Msol 1.6e6
<br>ionization parameter -2
<br>table star costar zams 70.5 Msol 2.1e6
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>hden 2
<br>grains orion single no qheat 
<br>abundances ism no grains
<br>c
<br>c commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>c
<br>c commands controlling output    =========
<br>punch continuum "stars_costar3.con" units microns last 
<br>c
<br>c stars_costar3.in
<br>c class stars 
<br>c ========================================
<br>c 
</kbd><p>
This is a test of whether the code can read the CoStar stellar atmospheres.
It checks the resulting ionization to confirm that the continuum 
shape was ok.
<p>
</p><hr><h2><kbd>stars_costar4.in  </kbd><I>costar interpolation mode 4
</I></h2><kbd><br>title costar interpolation mode 4
<br>c
<br>c commands controlling continuum =========
<br>table star costar age 2.85e6 40.0
<br>ionization parameter -2
<br>table star costar age 4e6 40.0
<br>ionization parameter -2
<br>table star costar age 2.85e6 50.9
<br>ionization parameter -2
<br>table star costar age 1.6e6 42.9
<br>ionization parameter -2
<br>table star costar age 2.1e6 70.5
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>hden 2
<br>grains orion single no qheat 
<br>abundances ism no grains
<br>c
<br>c commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>c
<br>c commands controlling output    =========
<br>punch continuum "stars_costar4.con" units microns last 
<br>c
<br>c stars_costar4.in
<br>c class stars 
<br>c ========================================
<br>c 
</kbd><p>
This is a test of whether the code can read the CoStar stellar atmospheres.
It checks the resulting ionization to confirm that the continuum 
shape was ok.
<p>
<p>
</p><hr><h2><kbd>stars_costarhalo.in  </kbd><I>costar halo abundances
</I></h2><kbd><br>title costar halo abundances
<br>c
<br>c commands controlling continuum =========
<br>table star costar, halo abundances, 40000 K
<br>ionization parameter -2
<br>c
<br>c commands for density & abundances =========
<br>hden 2
<br>abundances ism 
<br>c
<br>c commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>* >>chng 06 jul 01, add this to stars set since want to test shape
<br>* of continuum and resulting ion dist, not thermal equilibrium of nebula
<br>constant temperature 6900K
<br>c
<br>c commands controlling output    =========
<br>punch continuum last "stars_costarhalo.con" units microns
<br>c
<br>c 
<br>c stars_costarhalo.in
<br>c class stars 
<br>c ========================================
<br>c 
</kbd><p>
This test checks that the code can read the CoStar
stellar atmospheres.  It checks the resulting
ionization to make sure that the continuum shape is ok.
Constant temperature is assumed since this tests shape of stellar continuum
rather than thermal physics.
<p>
</p><hr><h2><kbd>stars_kurucz79.in  </kbd><I>Kurucz 1979 SED
</I></h2><kbd><br>title Kurucz 1979 SED
<br>c
<br>c commands controlling continuum =========
<br>c Approximate model of a hot star ionizing its surroundings.
<br>c Assume H density of 1e+6 per cc.  This run tests the Kurucz model option.
<br>c I choose the T_eff and log(g) values arbitrarily.  It implies a star
<br>c with luminosity 32300 L_sun, radius 6.4745 R_sun, and mass 3.745 M_sun.
<br>table star kurucz 30400.0
<br>luminosity 4.509202522 solar
<br>c
<br>c commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>c
<br>c commands controlling geometry  =========
<br>radius -3.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>c
<br>punch overview last "stars_kurucz79.ovr"
<br>punch results last "stars_kurucz79.rlt"
<br>punch transmitted continuum last "stars_kurucz79.trn" no header
<br>punch continuum last "stars_kurucz79.con" units microns
<br>c
<br>c stars_kurucz79.in
<br>c class stars 
<br>c ========================================
</kbd><p>
This is a test that the code can correctly access the
Kurucz model atmosphere continua described by Kurucz (1979). 
Kevin Volk provided it as part of his original coding of these
stellar atmosphere files.
Constant temperature is assumed since this tests shape of stellar continuum
rather than thermal physics.
<p>
<br>Checks:
table star kurucz command works.
<p>
</p><hr><h2><kbd>stars_mihalas.in  </kbd><I>Mihalas SED
</I></h2><kbd><br>title Mihalas SED
<br>c
<br>c commands controlling continuum =========
<br>c Approximate model of a hot star ionizing its surroundings.
<br>c Assume H density of 1e+6 per cc.  This run tests the new Kurucz model option.
<br>c I choose the T_eff and log(g) values arbitrarily.  It implies a star
<br>c with luminosity 32300 L_sun, radius 6.4745 R_sun, and mass 3.745 M_sun.
<br>table star mihalas 30400.0
<br>luminosity 4.509202522 solar
<br>c
<br>c commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>c
<br>c commands controlling geometry  =========
<br>radius -3.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>c
<br>punch overview last "stars_mihalas.ovr"
<br>punch results last "stars_mihalas.rlt"
<br>punch transmitted continuum last "stars_mihalas.trn" no header
<br>punch continuum last "stars_mihalas.con" units microns
<br>c
<br>c stars_mihalas.in
<br>c class stars 
<br>c ========================================
</kbd><p>
This is a test that the code can correctly access the
small Mihalas grid of NLTE model atmospeheres
Constant temperature is assumed since this tests shape of continuum
not thermal physics.
<p>
<br>Checks:
table star mihalas command works.
<p>
</p><hr><h2><kbd>stars_optimize1.in  </kbd><I>optimizer on stellar grids
</I></h2><kbd><br>title optimizer on stellar grids
<br>c
<br>c commands controlling continuum =========
<br>table star tlusty ostar 3-dim 31200 3.6 -1.12 vary
<br>ionization par -3
<br>c
<br>c commands for density & abundances =========
<br>hden 4 vary
<br>init file "hheonly.ini"
<br>element oxygen on  
<br>c
<br>c commands controlling geometry  =========
<br>case B
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>optimize tolerance 0.03
<br>constant temper 4.3 vary
<br>optimize phymir sequential
<br>optimize iteration 500
<br>c the following spectrum was derived by running this sim at hden 5, t=4,
<br>c and T_star=51200
<br>c resulting eden was 5.040 and T=4, which we shall assert that we find
<br>optimize lines
<br>o ii  3729   0.0416
<br>o ii  3726   0.1179
<br>o ii  7323   0.1535
<br>o ii  7332   0.1237
<br>o  3  5007   9.5265
<br>totl  4363   0.0900
<br>end of lines
<br>c
<br>c commands controlling output    =========
<br>print line faint -2
<br>c
<br>c
<br>c optimize_phymir.in
<br>c class optimizer
<br>c ========================================
<br>c
</kbd><p>
This checks whether the optimizer sets corrects limits for Teff.  The line
spectrum was calculated at T = 1e4 K, n_H=1e5 cm^-3, T_star = 51200 K.
<p>
</p><hr><h2><kbd>stars_optimize2.in  </kbd><I>optimizer on stellar grids
</I></h2><kbd><br>title optimizer on stellar grids
<br>c
<br>c commands controlling continuum =========
<br>table star costar 36200 vary
<br>ionization par -3
<br>c
<br>c commands for density & abundances =========
<br>hden 4 vary
<br>init file "hheonly.ini"
<br>element oxygen on  
<br>c
<br>c commands controlling geometry  =========
<br>Case B
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>optimize tolerance 0.03
<br>constant temper 4.3 vary
<br>optimize phymir sequential
<br>optimize iteration 500
<br>c the following spectrum was derived by running this sim at hden 5, t=4,
<br>c and T_star=51200
<br>c resulting eden was 5.041 and T=4, which we shall assert that we find
<br>optimize lines
<br>o ii  3729   0.0335
<br>o ii  3726   0.0950
<br>o ii  7323   0.1238
<br>o ii  7332   0.0998
<br>o  3  5007   9.9714
<br>totl  4363   0.0943
<br>end of lines
<br>c
<br>c commands controlling output    =========
<br>print line faint -2
<br>c
<br>c
<br>c optimize_phymir.in
<br>c class optimizer
<br>c ========================================
<br>c
</kbd><p>
This checks whether the optimizer sets corrects limits for Teff.  The line
spectrum was calculated at T = 1e4 K, n_H=1e5 cm^-3, T_star = 51200 K.
<p>
</p><hr><h2><kbd>stars_optimize3.in  </kbd><I>optimizer on stellar grids
</I></h2><kbd><br>title optimizer on stellar grids
<br>c
<br>c commands controlling continuum =========
<br>table star costar age 5.8 log 36 msol vary
<br>ionization par -3
<br>c
<br>c commands for density & abundances =========
<br>hden 4 vary
<br>init file "hheonly.ini"
<br>element oxygen on  
<br>c
<br>c commands controlling geometry  =========
<br>Case B
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>optimize tolerance 0.03
<br>constant temper 4.3 vary
<br>optimize phymir sequential
<br>optimize iteration 500
<br>c the following spectrum was derived by running this sim at hden 5, t=4,
<br>c and log(age)=6.3
<br>c resulting eden was 5.040 and T=4, which we shall assert that we find
<br>optimize lines
<br>o ii  3729  0.0623
<br>o ii  3726  0.1765
<br>o ii  7323  0.2300
<br>o ii  7332  0.1854
<br>o  3  5007  8.2979
<br>totl  4363  0.0784
<br>end of lines
<br>c
<br>c commands controlling output    =========
<br>print line faint -2
<br>c
<br>c
<br>c optimize_phymir.in
<br>c class optimizer
<br>c ========================================
<br>c
</kbd><p>
This checks whether the optimizer sets corrects limits for log(age).  The line
spectrum was calculated at T = 1e4 K, n_H=1e5 cm^-3, log(age/yr) = 6.3.
</p><hr><h2><kbd>stars_ostar2002.in  </kbd><I>tlusty O star grid
</I></h2><kbd><br>title tlusty O star grid
<br>c
<br>c commands controlling continuum =========
<br>c Approximate model of a hot star ionizing its surroundings.
<br>c Assume H density of 1e+6 per cc.  This run tests the new Tlusty model option.
<br>c I choose the T_eff and log(g) values arbitrarily.  It implies a star
<br>c with luminosity 32300 L_sun, radius 6.4745 R_sun, and mass 3.745 M_sun.
<br>table star tlusty ostar 30400.0 4.2
<br>luminosity 4.509202522 solar
<br>c
<br>c commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>c
<br>c commands controlling geometry  =========
<br>radius -3.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>c
<br>c in this model the Lyman lines are pumped significantly by the stellar continuum;
<br>c disable this process to avoid critical dependence on the precise shape of the continuum.
<br>no induced processes
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>c
<br>punch overview last "stars_ostar2002.ovr"
<br>punch results last "stars_ostar2002.rlt"
<br>punch transmitted continuum last "stars_ostar2002.trn" no header
<br>c
<br>c stars_ostar2002.in
<br>c class stars 
<br>c ========================================
</kbd><p>
This is a test that the code can correctly access the
large block of Tlusty O-star model atmosphere continua. 
<p>
<br>Checks:
table star tlusty ostar command works.
<p>
</p><hr><h2><kbd>stars_ostar2002_3d.in  </kbd><I>tlusty Ostar grid
</I></h2><kbd><br>title tlusty Ostar grid
<br>c
<br>c commands controlling continuum =========
<br>c Approximate model of a hot star ionizing its surroundings.
<br>c Assume H density of 1e+6 per cc. This run tests the new Tlusty model option.
<br>c I choose the T_eff, log(g) and log(Z) values arbitrarily.
<br>table star tlusty ostar 3-dim 30400.0 4.2 -1.573
<br>luminosity 4.509202522 solar
<br>c
<br>c commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>c
<br>c commands controlling geometry  =========
<br>radius -3.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>c
<br>c in this model the Lyman lines are pumped significantly by the stellar continuum;
<br>c disable this process to avoid critical dependence on the precise shape of the continuum.
<br>no induced processes
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>c
<br>punch overview last "stars_ostar2002_3d.ovr"
<br>punch results last "stars_ostar2002_3d.rlt"
<br>punch transmitted continuum last "stars_ostar2002_3d.trn" no header
<br>c
<br>c stars_ostar2002_3d.in
<br>c class stars 
<br>c ========================================
</kbd><p>
This is a test that the code can correctly access the
large block of Tlusty O-star model atmosphere continua. 
<p>
<br>Checks:
table star tlusty ostar 3-dim command works.
<p>
</p><hr><h2><kbd>stars_ostar2002_all.in  </kbd><I>tlusty Ostar grid
</I></h2><kbd><br>title tlusty Ostar grid
<br>c
<br>c commands controlling continuum =========
<br>c Approximate model of 10 hot stars ionizing their surroundings.
<br>c Assume H density of 1e+6 per cc.  This run tests all the various
<br>c metallicities contained in the OSTAR 2002 grids. I choose the T_eff
<br>c and log(g) values such that the selection algorithm gets a good workout.
<br>table star tlusty ostar Z+0.3 30000.0 4.5
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z+0.0 31400.0 4.5
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z-0.3 45000.0 4.2
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z-0.7 30400.0 4.2
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z-1.0 27500.0 3.0
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z-1.5 55000.0 4.75
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z-1.7 27500.0 4.75
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z-2.0 55000.0 3.00
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z-3.0 44400.0 3.2
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z-INF 53000.0 4.75
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z+0.0 48400.0 3.87
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z-0.7 48400.0 3.55
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z+0.3 43400.0 3.65
<br>luminosity 4.509202522 solar
<br>c
<br>c commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>c
<br>c commands controlling geometry  =========
<br>radius -2.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>c
<br>c in this model the Lyman lines are pumped significantly by the stellar continuum;
<br>c disable this process to avoid critical dependence on the precise shape of the continuum.
<br>no induced processes
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>c
<br>punch overview last "stars_ostar2002_all.ovr"
<br>punch results last "stars_ostar2002_all.rlt"
<br>punch transmitted continuum last "stars_ostar2002_all.trn" no header
<br>c
<br>c stars_ostar2002_all.in
<br>c class stars 
<br>c ========================================
</kbd><p>
This is a test that the code can correctly access the
large block of Tlusty O-star model atmosphere continua. 
<p>
<br>Checks:
table star tlusty ostar metallicity option works, also test selection algorithm.
<p>
</p><hr><h2><kbd>stars_rauch_3d.in  </kbd><I>Rauch 3-dimensional grid
</I></h2><kbd><br>title Rauch 3-dimensional grid
<br>c
<br>c commands controlling continuum =========
<br>table star rauch 3-dim T = 150000 K, g = 6.5 , log(Z) = -0.6
<br>luminosity 4.5 solar
<br>table star rauch old 3-dim T = 233000 K, g = 7.5 , log(Z) = -0.32
<br>luminosity 4.5 solar
<br>c
<br>c commands controlling geometry  =========
<br>sphere
<br>radius 18
<br>stop zone 1
<br>set dr 0
<br>c
<br>c commands for density & abundances =========
<br>abundances planetary 
<br>hden 3.0
<br>c
<br>c other commands for details     =========
<br>no level2
<br>c
<br>c commands controlling output    =========
<br>plot continuum range .1
<br>punch overview last "stars_rauch_3d.ovr"
<br>punch results last "stars_rauch_3d.rlt"
<br>punch continuum last "stars_rauch_3d.con" units microns
<br>c
<br>c stars_rauch_3d.in
<br>c class stars 
<br>c ========================================
</kbd><p>
This model checks that the code is able to access the 3-dim versions
of the Rauch grids of stellar atmosphere models.
Constant temperature is set since this test is intended to test
shape of ionizing continuum, not thermal physics.
<p>
</p><hr><h2><kbd>stars_rauch_h+he.in  </kbd><I>Rauch PN central star
</I></h2><kbd><br>title Rauch PN central star
<br>c
<br>c commands controlling continuum =========
<br>c this tests the various interpolation modes of the 3d grid
<br>table star rauch h+he T = 150000 K, g = 6.5 , f(He) = 0.2
<br>luminosity 4.5 solar
<br>table star rauch h+he T = 155000 K, g = 6.5 , f(He) = 0.2
<br>luminosity 4.5 solar
<br>table star rauch h+he T = 150000 K, g = 6.25 , f(He) = 0.2
<br>luminosity 4.5 solar
<br>table star rauch h+he T = 150000 K, g = 6.5 , f(He) = 0.25
<br>luminosity 4.5 solar
<br>table star rauch h+he T = 155000 K, g = 6.25 , f(He) = 0.2
<br>luminosity 4.5 solar
<br>table star rauch h+he T = 155000 K, g = 6.5 , f(He) = 0.25
<br>luminosity 4.5 solar
<br>table star rauch h+he T = 150000 K, g = 6.25 , f(He) = 0.25
<br>luminosity 4.5 solar
<br>table star rauch h+he T = 155000 K, g = 6.25 , f(He) = 0.25
<br>luminosity 4.5 solar
<br>c
<br>c commands controlling geometry  =========
<br>sphere
<br>radius 18
<br>stop zone 1
<br>set dr 0
<br>c
<br>c commands for density & abundances =========
<br>abundances planetary 
<br>hden 3.0
<br>c
<br>c other commands for details     =========
<br>no level2
<br>c
<br>c commands controlling output    =========
<br>plot continuum range .1
<br>punch overview last "stars_rauch_h+he.ovr"
<br>punch results last "stars_rauch_h+he.rlt"
<br>punch continuum last "stars_rauch_h+he.con" units microns
<br>c
<br>c stars_rauch_h+he.in
<br>c class stars 
<br>c ========================================
</kbd><p>
This is a model of a very hot planetary nebula, and checks that the code
is able to access the H+He version of the Rauch grid of stellar
atmosphere models.
<p>
</p><hr><h2><kbd>stars_rauch_h-ca.in  </kbd><I>Rauch central star hot PN
</I></h2><kbd><br>title Rauch central star hot PN
<br>c NB
<br>c this uses the H-Ca rauch atmospheres
<br>c
<br>c commands controlling continuum =========
<br>table star old rauch T = 250000 K, g = 7.5
<br>luminosity 4.5 solar
<br>c
<br>c commands controlling geometry  =========
<br>sphere
<br>radius 18
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>no level2
<br>c
<br>c commands for density & abundances =========
<br>hden 3.0
<br>abundances planetary 
<br>c
<br>c commands controlling output    =========
<br>plot continuum range .1
<br>punch overview last "stars_rauch_h-ca.ovr"
<br>punch results last "stars_rauch_h-ca.rlt"
<br>punch continuum last "stars_rauch_h-ca.con" units microns
<br>c
<br>c stars_rauch_h-ca.in
<br>c class stars 
<br>c ========================================
</kbd><p>
This is a model of a very hot planetary nebula, and checks that the code
is able to access the H-Ca Rauch grid of stellar atmosphere models.
</p><hr><h2><kbd>stars_rauch_h-ni.in  </kbd><I>Rauch hot PN star
</I></h2><kbd><br>title Rauch hot PN star
<br>c
<br>c commands controlling continuum =========
<br>table star rauch T = 150000 K, g = 6.5
<br>luminosity 4.5 solar
<br>c
<br>c commands controlling geometry  =========
<br>sphere
<br>radius 18
<br>stop zone 1
<br>set dr 0
<br>c
<br>c commands for density & abundances =========
<br>abundances planetary 
<br>hden 3.0
<br>c
<br>c other commands for details     =========
<br>no level2
<br>c
<br>c commands controlling output    =========
<br>plot continuum range .1
<br>punch overview last "stars_rauch_h-ni.ovr"
<br>punch results last "stars_rauch_h-ni.rlt"
<br>punch continuum last "stars_rauch_h-ni.con" units microns
<br>c
<br>c stars_rauch_h-ni.in
<br>c class stars 
<br>c ========================================
</kbd><p>
This is a model of a very hot planetary nebula, and checks that the code
is able to access the H-Ni version of the Rauch grid of stellar
atmosphere models.
Constant temperature is set since this test is intended to test
shape of ionizing continuum, not thermal physics.
<p>
<p>
</p><hr><h2><kbd>stars_rauch_helium.in  </kbd><I>Rauch hot PN star
</I></h2><kbd><br>title Rauch hot PN star
<br>c
<br>c commands controlling continuum =========
<br>table star rauch helium T = 240000 K, g = 8.5
<br>luminosity 4.5 solar
<br>c
<br>c commands controlling geometry  =========
<br>sphere
<br>radius 18
<br>stop zone 1
<br>set dr 0
<br>c
<br>c commands for density & abundances =========
<br>abundances planetary 
<br>hden 3.0
<br>c
<br>c other commands for details     =========
<br>no level2
<br>c
<br>c commands controlling output    =========
<br>plot continuum range .1
<br>punch overview last "stars_rauch_helium.ovr"
<br>punch results last "stars_rauch_helium.rlt"
<br>c
<br>c stars_rauch_helium.in
<br>c class stars 
<br>c ========================================
</kbd><p>
This is a model of a very hot planetary nebula, and checks that the code
is able to access the pure helium version of the Rauch grid of stellar
atmosphere models.
<p>
</p><hr><h2><kbd>stars_rauch_hydr.in  </kbd><I>Rauch hot PN star
</I></h2><kbd><br>title Rauch hot PN star
<br>c
<br>c commands controlling continuum =========
<br>table star rauch hydr T = 240000 K, g = 8.5
<br>luminosity 4.5 solar
<br>c
<br>c commands controlling geometry  =========
<br>sphere
<br>radius 18
<br>stop zone 1
<br>set dr 0
<br>c
<br>c commands for density & abundances =========
<br>abundances planetary 
<br>hden 3.0
<br>c
<br>c other commands for details     =========
<br>no level2
<br>c
<br>c commands controlling output    =========
<br>plot continuum range .1
<br>punch overview last "stars_rauch_hydr.ovr"
<br>punch results last "stars_rauch_hydr.rlt"
<br>c
<br>c stars_rauch_hydr.in
<br>c class stars 
<br>c ========================================
</kbd><p>
This is a model of a very hot planetary nebula, and checks that the code
is able to access the pure hydrogen version of the Rauch grid of stellar
atmosphere models.
<p>
</p><hr><h2><kbd>stars_rauch_pg1159.in  </kbd><I>Rauch hot [WR] PN
</I></h2><kbd><br>title Rauch hot [WR] PN
<br>c
<br>c commands controlling continuum =========
<br>table star rauch pg1159 T=150000K g=6.5
<br>luminosity 4.5 solar
<br>c
<br>c commands controlling geometry  =========
<br>sphere
<br>radius 18
<br>stop zone 1
<br>set dr 0
<br>c
<br>c commands for density & abundances =========
<br>abundances planetary 
<br>hden 3.0
<br>c
<br>c other commands for details     =========
<br>no level2
<br>c
<br>c commands controlling output    =========
<br>plot continuum range .1
<br>punch overview last "stars_rauch_pg1159.ovr"
<br>punch results last "stars_rauch_pg1159.rlt"
<br>c
<br>c stars_rauch.in
<br>c class stars 
<br>c ========================================
</kbd><p>
This is a model of a very hot planetary nebula, and checks that the code
is able to access the PG1159 version of the Rauch grid of stellar
atmosphere models.
<p>
</p><hr><h2><kbd>stars_starburst99.in  </kbd><I>Starburst 99 SED
</I></h2><kbd><br>title Starburst 99 SED
<br>c
<br>c commands controlling continuum =========
<br>c read the table starburst and interploate to an age of 1e8 years
<br>table star log age=8 "starburst99.mod"
<br>luminosity 43
<br>c add background continuum - starburs 99 does not extend
<br>c into fir so code would complain about zero continuum
<br>c adding the cosmic background stops this complaint
<br>background
<br>c
<br>c commands for density & abundances =========
<br>hden 5
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>radius 20
<br>c
<br>c other commands for details     =========
<br>constant temper 4
<br>c
<br>c commands controlling output    =========
<br>punch continuum "stars_starburst99.con" last
<br>punch continuum last "stars_starburst99.con" units microns
<br>c
<br>c
<br>c stars_starburst99.in
<br>c class stars 
<br>c ========================================
<br>c 
</kbd><p>
this is a demonstration of the use of a Starburst 99 spectrum.  It was
provided to me by anand Srianand, and we used it in Srianand et al. 2003.
A constant temperature is set since this is to test shape of continuum
not thermal physics. It also tests access to user-supplied grids as the
mechanism is the same.
<p>
<p>
<p>
<p>
</p><hr><h2><kbd>stars_starburst99_2d.in  </kbd><I>Starburst 99 2D SED
</I></h2><kbd><br>title Starburst 99 2D SED
<br>c
<br>c commands controlling continuum =========
<br>c read the table starburst and interpolate to an age of 2.09e6 years
<br>c and a metallicity of 12.
<br>table star log age=6.32 Z=12. "starburst99_2d.mod"
<br>luminosity 43
<br>c add background continuum - starburs 99 does not extend
<br>c into fir so code would complain about zero continuum
<br>c adding the cosmic background stops this complaint
<br>background
<br>c
<br>c commands for density & abundances =========
<br>hden 5
<br>c
<br>c commands controlling geometry  =========
<br>stop zone 1
<br>radius 20
<br>c
<br>c other commands for details     =========
<br>constant temper 4
<br>c
<br>c commands controlling output    =========
<br>punch continuum "stars_starburst99_2d.con" last
<br>punch continuum last "stars_starburst99_2d.con" units microns
<br>c
<br>c
<br>c stars_starburst99_2d.in
<br>c class stars 
<br>c ========================================
<br>c 
</kbd><p>
this is a demonstration of the use of a manually crafted Starburst 99 2D
grid, allowing for interpolation in both age and metallicity.  It was
provided by Christophe Morisset.
A constant temperature is set since this is to test shape of continuum
not thermal physics. It also tests access to user-supplied grids as the
mechanism is the same.
<p>
<p>
<p>
<p>
</p><hr><h2><kbd>stars_werner.in  </kbd><I>Werner stars grid
</I></h2><kbd><br>title Werner stars grid
<br>c
<br>c commands controlling continuum =========
<br>table star werner 190000 g=7.5
<br>luminosity total 38
<br>c
<br>c commands for density & abundances =========
<br>hden 4
<br>abundances planetary no grains
<br>grains agm no qheat single 
<br>c
<br>c commands controlling geometry  =========
<br>radius 17
<br>sphere
<br>set dr 0
<br>stop zone 1
<br>c
<br>c other commands for details     =========
<br>* >>chng 06 jul 01, add this to stars set since want to test shape
<br>* of continuum and resulting ion dist, not thermal equilibrium of nebula
<br>constant temperature 4.373
<br>c
<br>c commands controlling output    =========
<br>c
<br>punch overview last "stars_werner.ovr"
<br>punch results last "stars_werner.rlt"
<br>punch transmitted continuumlast "stars_werner.trn"
<br>c
<br>c stars_werner.in
<br>c class stars 
<br>c ========================================
<br>c 
</kbd><p>
This checks that the code can access Kevin Volk39s Werner atmospheres. 
<p>
<br>Checks:
<br>-	table star Werner atmosphere works.
constant temperature is set to that this tests shape of stellar continuum
</p><hr><h2><kbd>stars_wmbasic.in  </kbd><I>wmbasic stellar SED
</I></h2><kbd><br>title wmbasic stellar SED
<br>c
<br>c commands controlling continuum =========
<br>c Approximate model of a hot star ionizing its surroundings.
<br>c Assume H density of 1e+6 per cc. This run tests the WMBASIC model option.
<br>c I choose the T_eff, log(g), and log(Z) values arbitrarily.
<br>table star wmbasic 30000.0 4.0 -0.3
<br>luminosity 4.509202522 solar
<br>table star wmbasic 32000.0 4.0 0.0
<br>luminosity 4.509202522 solar
<br>table star wmbasic 40000.0 3.6 -0.3
<br>luminosity 4.509202522 solar
<br>table star wmbasic 35000.0 4.0 -0.15
<br>luminosity 4.509202522 solar
<br>table star wmbasic 57000.0 4.0 0.0
<br>luminosity 4.509202522 solar
<br>table star wmbasic 37000.0 3.4 -0.3
<br>luminosity 4.509202522 solar
<br>table star wmbasic 32000.0 4.0 -0.1
<br>luminosity 4.509202522 solar
<br>table star wmbasic 36000.0 3.5 -0.12
<br>luminosity 4.509202522 solar
<br>c
<br>c commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>c
<br>c commands controlling geometry  =========
<br>radius -2.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>c
<br>c other commands for details     =========
<br>c
<br>c in this model the Lyman lines are pumped significantly
<br>c by the stellar continuum; disable this process to avoid critical
<br>c dependence on the precise shape of the continuum.
<br>no induced processes
<br>constant temperature 4
<br>c
<br>c commands controlling output    =========
<br>c
<br>punch overview last "stars_wmbasic.ovr"
<br>punch results last "stars_wmbasic.rlt"
<br>punch transmitted continuum last "stars_wmbasic.trn" no header
<br>c
<br>c stars_wmbasic.in
<br>c class stars 
<br>c ========================================
</kbd><p>
This is a test that the code can correctly access the
WMBASIC O-star model atmosphere continua. 
<p>
<br>Checks:
table star wmbasic command works.
<p>
 
</p><hr>

</body>

</html>
