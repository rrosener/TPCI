<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>PLUTO: /home/Andrea/PLUTO/Src/MHD/CT/ct.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUTO
   &#160;<span id="projectnumber">4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_413f4e031a85da0d68269c6fd2f76e1c.html">Src</a></li><li class="navelem"><a class="el" href="dir_393faf7c97aebfe9abb0723b81bbf748.html">MHD</a></li><li class="navelem"><a class="el" href="dir_99ba33ef0d58bfc77b7b2a7843ab7327.html">CT</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ct.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file for Constrained-Transport (CT) module.  
<a href="#details">More...</a></p>

<p><a href="ct_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_e_m_f.html">EMF</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a96eb0a9cfec6b481f225504aacd470be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ct_8h.html#a96eb0a9cfec6b481f225504aacd470be">CT_EMF_ArithmeticAverage</a> (const <a class="el" href="struct_e_m_f.html">EMF</a> *, const double)</td></tr>
<tr class="memdesc:a96eb0a9cfec6b481f225504aacd470be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute arithmetic average of <a class="el" href="struct_e_m_f.html">EMF</a> at cell edges.  <a href="#a96eb0a9cfec6b481f225504aacd470be"></a><br/></td></tr>
<tr class="separator:a96eb0a9cfec6b481f225504aacd470be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ae0d95dc11b52e79cfac0f64decf4b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ct_8h.html#a9ae0d95dc11b52e79cfac0f64decf4b1">CT_EMF_IntegrateToCorner</a> (const <a class="el" href="struct_data.html">Data</a> *, const <a class="el" href="struct_e_m_f.html">EMF</a> *, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a9ae0d95dc11b52e79cfac0f64decf4b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42eb76c6af94cf8f2f7a01664ad6b0ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ct_8h.html#a42eb76c6af94cf8f2f7a01664ad6b0ae">CT_AverageNormalMagField</a> (const <a class="el" href="struct_data.html">Data</a> *, int, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="memdesc:a42eb76c6af94cf8f2f7a01664ad6b0ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the normal component of the volume-average magnetic field from the staggered components in the ghost zones.  <a href="#a42eb76c6af94cf8f2f7a01664ad6b0ae"></a><br/></td></tr>
<tr class="separator:a42eb76c6af94cf8f2f7a01664ad6b0ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa17c678ea10a56815b0197a72b4b9793"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ct_8h.html#aa17c678ea10a56815b0197a72b4b9793">CT_Update</a> (const <a class="el" href="struct_data.html">Data</a> *, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:aa17c678ea10a56815b0197a72b4b9793"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3e18578d03f535d889a6870891f139e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ct_8h.html#ab3e18578d03f535d889a6870891f139e">CT_CheckDivB</a> (double ***b[], <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:ab3e18578d03f535d889a6870891f139e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa47d386274fdc91365495cd18dd71808"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ct_8h.html#aa47d386274fdc91365495cd18dd71808">CT_StoreEMF</a> (const <a class="el" href="struct_state__1_d.html">State_1D</a> *, int, int, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:aa47d386274fdc91365495cd18dd71808"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcb071a4639ea7176a502cc024bf1e6e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ct_8h.html#afcb071a4639ea7176a502cc024bf1e6e">CT_StoreResistiveEMF</a> (double **, int, int, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:afcb071a4639ea7176a502cc024bf1e6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae016eb6974150b761130771d4b21689b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_e_m_f.html">EMF</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ct_8h.html#ae016eb6974150b761130771d4b21689b">CT_GetEMF</a> (const <a class="el" href="struct_data.html">Data</a> *, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:ae016eb6974150b761130771d4b21689b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8460c8e1aa53f2634c7291b9b2d68e88"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ct_8h.html#a8460c8e1aa53f2634c7291b9b2d68e88">FillMagneticField</a> (const <a class="el" href="struct_data.html">Data</a> *, int, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="memdesc:a8460c8e1aa53f2634c7291b9b2d68e88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign the normal component of the staggered magnetic field in the ghost zone-faces.  <a href="#a8460c8e1aa53f2634c7291b9b2d68e88"></a><br/></td></tr>
<tr class="separator:a8460c8e1aa53f2634c7291b9b2d68e88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a131fdb57f99fc975e20c41d2cf74dee1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ct_8h.html#a131fdb57f99fc975e20c41d2cf74dee1">CT_GetStagSlopes</a> (const Data_Arr, <a class="el" href="struct_e_m_f.html">EMF</a> *, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a131fdb57f99fc975e20c41d2cf74dee1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9496fce48023e0ea7eede042ba0fffdf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ct_8h.html#a9496fce48023e0ea7eede042ba0fffdf">CT_EMF_HLL_Solver</a> (const <a class="el" href="struct_data.html">Data</a> *, const <a class="el" href="struct_e_m_f.html">EMF</a> *, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="memdesc:a9496fce48023e0ea7eede042ba0fffdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve 2D Riemann problem for induction equation.  <a href="#a9496fce48023e0ea7eede042ba0fffdf"></a><br/></td></tr>
<tr class="separator:a9496fce48023e0ea7eede042ba0fffdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd381c686577eaebb90195865cfd2809"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ct_8h.html#abd381c686577eaebb90195865cfd2809">CT_EMF_CMUSCL_Average</a> (const <a class="el" href="struct_data.html">Data</a> *, const <a class="el" href="struct_e_m_f.html">EMF</a> *, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="memdesc:abd381c686577eaebb90195865cfd2809"><td class="mdescLeft">&#160;</td><td class="mdescRight">&ndash;  <a href="#abd381c686577eaebb90195865cfd2809"></a><br/></td></tr>
<tr class="separator:abd381c686577eaebb90195865cfd2809"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Provides macros, function prototypes and structure definitions for the constrained transport (CT) MHD module to control the divergence-free condition.</p>
<dl class="section author"><dt>Author</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@p<span style="display: none;">.nosp@m.</span>h.uni<span style="display: none;">.nosp@m.</span>to.i<span style="display: none;">.nosp@m.</span>t</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Oct 3, 2012 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a42eb76c6af94cf8f2f7a01664ad6b0ae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CT_AverageNormalMagField </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>side</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For a given "side" of the boundary, average the staggered magnetic field components normal to that boundary into a cell-centered field. For instance, at X3_BEG we only average Bz. Transverse components should be averaged using a slightly different stencil. This function is automatically called from <a class="el" href="boundary_8c.html#a737d3862f4cf347b9f2216b6310edde7">Boundary()</a> for consistency between staggered and zone-centered fields.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d</td><td>pointer to PLUTO <a class="el" href="struct_data.html">Data</a> structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">side</td><td>the side </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to PLUTO <a class="el" href="struct_grid.html">Grid</a> structure</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000008">Todo:</a></b></dt><dd>replace the loops with more compact macro, such as X1_BEG_LOOP()... </dd></dl>

</div>
</div>
<a class="anchor" id="ab3e18578d03f535d889a6870891f139e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CT_CheckDivB </td>
          <td>(</td>
          <td class="paramtype">double ***&#160;</td>
          <td class="paramname"><em>bf</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check the divergence-free condition of magnetic field in the constrained transport formalism. </p>

</div>
</div>
<a class="anchor" id="a96eb0a9cfec6b481f225504aacd470be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CT_EMF_ArithmeticAverage </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_e_m_f.html">EMF</a> *&#160;</td>
          <td class="paramname"><em>Z1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Combine the four electric field values computed at zone faces as upwind Godunov fluxes into an edge-centered value.<br/>
 The face-centered <a class="el" href="struct_e_m_f.html">EMF</a> should have been stored by previous calls to <a class="el" href="ct_8h.html#aa47d386274fdc91365495cd18dd71808">CT_StoreEMF()</a> during the one-dimensional sweeps.<br/>
 This function employs a simple arithmetic averaging of the face-centered electric field.</p>
<p><b>References:</b> </p>
<ul>
<li>"A Staggered Mesh Algorithm Using High Order Godunov Fluxes to Ensure Solenoidal Magnetic Fields in Magnetohydrodynamic Simulations"<br/>
 Balsara &amp; Spicer, JCP (1999) 149, 270.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Z1</td><td>pointer to <a class="el" href="struct_e_m_f.html">EMF</a> structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>weighting factor</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function has no return value.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@p<span style="display: none;">.nosp@m.</span>h.uni<span style="display: none;">.nosp@m.</span>to.i<span style="display: none;">.nosp@m.</span>t</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Aug 16, 31, 2012 </dd></dl>

</div>
</div>
<a class="anchor" id="abd381c686577eaebb90195865cfd2809"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CT_EMF_CMUSCL_Average </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_e_m_f.html">EMF</a> *&#160;</td>
          <td class="paramname"><em>emf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Used in the predictor scheme of CTU scheme in conjunction with UCT_HLL average. No riemann solver actually used, but only a simple pointwise average.</p>
<p><b>References:</b> </p>
<ul>
<li>"A High order Godunov scheme with constrained transport and 
     adaptie mesh refinement for astrophysical magnetohydrodynamics"<br/>
 Fromang, Hennebelle and Teyssier, A&amp;A (2006) 457, 371</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>This function has no return value. </dd></dl>
<dl class="section author"><dt>Author</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@p<span style="display: none;">.nosp@m.</span>h.uni<span style="display: none;">.nosp@m.</span>to.i<span style="display: none;">.nosp@m.</span>t</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Aug 16, 2012 </dd></dl>

</div>
</div>
<a class="anchor" id="a9496fce48023e0ea7eede042ba0fffdf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CT_EMF_HLL_Solver </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_e_m_f.html">EMF</a> *&#160;</td>
          <td class="paramname"><em>emf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve 2-D Riemann problem using the 2D HLL Riemann flux formula of Londrillo &amp; Del Zanna (2004), JCP, eq. 56. Here N, W, E, S refer to the following configuration: </p>
<pre class="fragment">*                    |
*                    N
*                 NW | NE
*                    | 
*               --W--+--E--
*                    | 
*                 SW | SE
*                    S
*                    |
* </pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>pointer to PLUTO <a class="el" href="struct_data.html">Data</a> structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to <a class="el" href="struct_grid.html">Grid</a> structure;</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function has no return value. </dd></dl>
<dl class="section author"><dt>Author</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@p<span style="display: none;">.nosp@m.</span>h.uni<span style="display: none;">.nosp@m.</span>to.i<span style="display: none;">.nosp@m.</span>t</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Aug 16, 2012 </dd></dl>

</div>
</div>
<a class="anchor" id="a9ae0d95dc11b52e79cfac0f64decf4b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CT_EMF_IntegrateToCorner </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_e_m_f.html">EMF</a> *&#160;</td>
          <td class="paramname"><em>emf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add derivatives to the 4-point arithmetic average of magnetic fields. Obtain the electric field at corners.</p>
<p><b>References:</b> </p>
<ul>
<li>"An unsplit Godunov method for ideal MHD via constrained transport"<br/>
 Gardiner &amp; Stone, JCP (2005) 205, 509. See Eq. (41), (45) and (50).</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>pointer to PLUTO <a class="el" href="struct_data.html">Data</a> structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">emf</td><td>pointer to <a class="el" href="struct_e_m_f.html">EMF</a> structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to <a class="el" href="struct_grid.html">Grid</a> structure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function has no return value.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@p<span style="display: none;">.nosp@m.</span>h.uni<span style="display: none;">.nosp@m.</span>to.i<span style="display: none;">.nosp@m.</span>t</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Aug 16, 31, 2012 </dd></dl>

</div>
</div>
<a class="anchor" id="ae016eb6974150b761130771d4b21689b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_e_m_f.html">EMF</a>* CT_GetEMF </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieve <a class="el" href="struct_e_m_f.html">EMF</a> by suitable average of 1D face-centered fluxes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a pointer to an edge-centered <a class="el" href="struct_e_m_f.html">EMF</a>. </dd></dl>

</div>
</div>
<a class="anchor" id="a131fdb57f99fc975e20c41d2cf74dee1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CT_GetStagSlopes </td>
          <td>(</td>
          <td class="paramtype">const Data_Arr&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_e_m_f.html">EMF</a> *&#160;</td>
          <td class="paramname"><em>emf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute slopes of staggered magnetic fields components Exclude normal derivatives (i.e. dbx_dx). </p>

</div>
</div>
<a class="anchor" id="aa47d386274fdc91365495cd18dd71808"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CT_StoreEMF </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_state__1_d.html">State_1D</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Store <a class="el" href="struct_e_m_f.html">EMF</a> components and related information available during 1D sweeps.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">state</td><td>pointer to <a class="el" href="struct_state__1_d.html">State_1D</a> structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>initial index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to <a class="el" href="struct_grid.html">Grid</a> structure;</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function has no return value. </dd></dl>

</div>
</div>
<a class="anchor" id="afcb071a4639ea7176a502cc024bf1e6e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CT_StoreResistiveEMF </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>res_flx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Store resistive part of <a class="el" href="struct_e_m_f.html">EMF</a>.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000007">Todo:</a></b></dt><dd>some memory could be saved here... </dd></dl>

</div>
</div>
<a class="anchor" id="aa17c678ea10a56815b0197a72b4b9793"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CT_Update </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Update staggered magnetic field using discrete version of Stoke's theorem.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d</td><td>pointer to PLUTO <a class="el" href="struct_data.html">Data</a> structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to an array of <a class="el" href="struct_grid.html">Grid</a> structures</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd>dt may be set separately in a more concise manner.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@p<span style="display: none;">.nosp@m.</span>h.uni<span style="display: none;">.nosp@m.</span>to.i<span style="display: none;">.nosp@m.</span>t</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Aug 16, 2012 </dd></dl>

</div>
</div>
<a class="anchor" id="a8460c8e1aa53f2634c7291b9b2d68e88"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FillMagneticField </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>side</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Using the div.B = 0 condition in staggered MHD, this function computes the staggered component of magnetic field lying on the zone-face parallel to the boundary specified by "side". This is preformed by solving the div.B = 0 condition for one variable only which in 2-D requires the knowledge of the other 3 components while in 3-D required the knowledge of the other 5 staggered components.<br/>
</p>
<p>Note that this operation is performed in the outermost ghost zones only since the face value at IBEG-1 or IEND is supposed to be part of the solution and is not changed during this function. Therefore, only nghost-1 faces are assigned:</p>
<pre class="fragment">*  +-----+-----+-----+-----+-----+--
*  |     |     |     |     |     |
*  |     X     X     |     |     |
*  |     |     |     |     |     |
*  +-----+-----+-----+-----+-----+--
*                    |
*  &lt;-----------------&gt; BEG
*   Physical boundary     
*
*   X = components assigned in this function.
* </pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d</td><td>pointer to PLUTO <a class="el" href="struct_data.html">Data</a> structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">side</td><td>the side </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to PLUTO <a class="el" href="struct_grid.html">Grid</a> structure</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000010">Todo:</a></b></dt><dd>replace the loops with more compact macro, such as X1_BEG_LOOP()... </dd></dl>
<dl class="section author"><dt>Author</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'ph'+'.un'+'it'+'o.i'+'t'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@p<span style="display: none;">.nosp@m.</span>h.uni<span style="display: none;">.nosp@m.</span>to.i<span style="display: none;">.nosp@m.</span>t</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Aug 16, 2012 </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Nov 9 2012 13:15:48 for PLUTO by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
